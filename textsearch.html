

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Full text search &mdash; APSW 3.50.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=bb2faaec" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/apsw.css?v=3c7e2631" />

  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=f1d38ea6"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="copyright" title="Copyright" href="copyright.html" />
    <link rel="next" title="Session Example/Tour" href="example-session.html" />
    <link rel="prev" title="Full Text Search Example/Tour" href="example-fts.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            APSW
              <img src="_static/apswlogo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="tips.html">Tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="example.html">Example/Tour</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation and customization</a></li>
<li class="toctree-l1"><a class="reference internal" href="extensions.html">Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="bestpractice.html">Best Practice</a></li>
<li class="toctree-l1"><a class="reference internal" href="apsw.html">APSW Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="connection.html">Connections to a database</a></li>
<li class="toctree-l1"><a class="reference internal" href="cursor.html">Cursors (executing SQL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="blob.html">Blob Input/Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="backup.html">Backup</a></li>
<li class="toctree-l1"><a class="reference internal" href="example-fts.html">Full Text Search Example/Tour</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Full text search</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#key-concepts">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tokenizer-order-and-parameters">Tokenizer order and parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#recommendations">Recommendations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#unicode-normalization">Unicode normalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tokenizer-order">Tokenizer order</a></li>
<li class="toctree-l3"><a class="reference internal" href="#external-content-tables">External content tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ranking-functions">Ranking functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#facets">Facets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#performance">Performance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#outgrowing-fts5">Outgrowing FTS5</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#available-tokenizers">Available tokenizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#third-party-libraries">Third party libraries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nltk-nltk">NLTK (nltk)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#snowball-stemmer-snowballstemmer">Snowball Stemmer (snowballstemmer)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#unidecode-unidecode">Unidecode (unidecode)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#available-auxiliary-functions">Available auxiliary functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#command-line-tools">Command line tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fts5-tokenization-viewer">FTS5 Tokenization viewer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#unicode">Unicode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-apsw.fts5">FTS5 module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.FTS5TableStructure"><code class="docutils literal notranslate"><span class="pre">FTS5TableStructure</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.FTS5TableStructure.columns"><code class="docutils literal notranslate"><span class="pre">FTS5TableStructure.columns</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.FTS5TableStructure.columnsize"><code class="docutils literal notranslate"><span class="pre">FTS5TableStructure.columnsize</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.FTS5TableStructure.content"><code class="docutils literal notranslate"><span class="pre">FTS5TableStructure.content</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.FTS5TableStructure.content_rowid"><code class="docutils literal notranslate"><span class="pre">FTS5TableStructure.content_rowid</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.FTS5TableStructure.contentless_delete"><code class="docutils literal notranslate"><span class="pre">FTS5TableStructure.contentless_delete</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.FTS5TableStructure.contentless_unindexed"><code class="docutils literal notranslate"><span class="pre">FTS5TableStructure.contentless_unindexed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.FTS5TableStructure.detail"><code class="docutils literal notranslate"><span class="pre">FTS5TableStructure.detail</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.FTS5TableStructure.locale"><code class="docutils literal notranslate"><span class="pre">FTS5TableStructure.locale</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.FTS5TableStructure.name"><code class="docutils literal notranslate"><span class="pre">FTS5TableStructure.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.FTS5TableStructure.prefix"><code class="docutils literal notranslate"><span class="pre">FTS5TableStructure.prefix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.FTS5TableStructure.tokendata"><code class="docutils literal notranslate"><span class="pre">FTS5TableStructure.tokendata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.FTS5TableStructure.tokenize"><code class="docutils literal notranslate"><span class="pre">FTS5TableStructure.tokenize</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.FTS5TableStructure.unindexed"><code class="docutils literal notranslate"><span class="pre">FTS5TableStructure.unindexed</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.HTMLTokenizer"><code class="docutils literal notranslate"><span class="pre">HTMLTokenizer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.JSONTokenizer"><code class="docutils literal notranslate"><span class="pre">JSONTokenizer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.MatchInfo"><code class="docutils literal notranslate"><span class="pre">MatchInfo</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.MatchInfo.column_size"><code class="docutils literal notranslate"><span class="pre">MatchInfo.column_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.MatchInfo.phrase_columns"><code class="docutils literal notranslate"><span class="pre">MatchInfo.phrase_columns</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.MatchInfo.query_info"><code class="docutils literal notranslate"><span class="pre">MatchInfo.query_info</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.MatchInfo.rowid"><code class="docutils literal notranslate"><span class="pre">MatchInfo.rowid</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.NGramTokenizer"><code class="docutils literal notranslate"><span class="pre">NGramTokenizer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.QueryInfo"><code class="docutils literal notranslate"><span class="pre">QueryInfo</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.QueryInfo.phrases"><code class="docutils literal notranslate"><span class="pre">QueryInfo.phrases</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.QueryTokensTokenizer"><code class="docutils literal notranslate"><span class="pre">QueryTokensTokenizer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.RegexPreTokenizer"><code class="docutils literal notranslate"><span class="pre">RegexPreTokenizer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.RegexTokenizer"><code class="docutils literal notranslate"><span class="pre">RegexTokenizer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.SimplifyTokenizer"><code class="docutils literal notranslate"><span class="pre">SimplifyTokenizer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.StopWordsTokenizer"><code class="docutils literal notranslate"><span class="pre">StopWordsTokenizer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.StringTokenizer"><code class="docutils literal notranslate"><span class="pre">StringTokenizer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.SynonymTokenizer"><code class="docutils literal notranslate"><span class="pre">SynonymTokenizer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.Table"><code class="docutils literal notranslate"><span class="pre">Table</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.change_cookie"><code class="docutils literal notranslate"><span class="pre">Table.change_cookie</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.closest_tokens"><code class="docutils literal notranslate"><span class="pre">Table.closest_tokens()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.column_named"><code class="docutils literal notranslate"><span class="pre">Table.column_named()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.columns"><code class="docutils literal notranslate"><span class="pre">Table.columns</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.columns_indexed"><code class="docutils literal notranslate"><span class="pre">Table.columns_indexed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.command_delete"><code class="docutils literal notranslate"><span class="pre">Table.command_delete()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.command_delete_all"><code class="docutils literal notranslate"><span class="pre">Table.command_delete_all()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.command_integrity_check"><code class="docutils literal notranslate"><span class="pre">Table.command_integrity_check()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.command_merge"><code class="docutils literal notranslate"><span class="pre">Table.command_merge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.command_optimize"><code class="docutils literal notranslate"><span class="pre">Table.command_optimize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.command_rebuild"><code class="docutils literal notranslate"><span class="pre">Table.command_rebuild()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.config"><code class="docutils literal notranslate"><span class="pre">Table.config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.config_automerge"><code class="docutils literal notranslate"><span class="pre">Table.config_automerge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.config_crisismerge"><code class="docutils literal notranslate"><span class="pre">Table.config_crisismerge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.config_deletemerge"><code class="docutils literal notranslate"><span class="pre">Table.config_deletemerge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.config_insttoken"><code class="docutils literal notranslate"><span class="pre">Table.config_insttoken()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.config_pgsz"><code class="docutils literal notranslate"><span class="pre">Table.config_pgsz()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.config_rank"><code class="docutils literal notranslate"><span class="pre">Table.config_rank()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.config_secure_delete"><code class="docutils literal notranslate"><span class="pre">Table.config_secure_delete()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.config_usermerge"><code class="docutils literal notranslate"><span class="pre">Table.config_usermerge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.create"><code class="docutils literal notranslate"><span class="pre">Table.create()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.delete"><code class="docutils literal notranslate"><span class="pre">Table.delete()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.fts5vocab_name"><code class="docutils literal notranslate"><span class="pre">Table.fts5vocab_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.is_token"><code class="docutils literal notranslate"><span class="pre">Table.is_token()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.key_tokens"><code class="docutils literal notranslate"><span class="pre">Table.key_tokens()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.more_like"><code class="docutils literal notranslate"><span class="pre">Table.more_like()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.query_suggest"><code class="docutils literal notranslate"><span class="pre">Table.query_suggest()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.quoted_table_name"><code class="docutils literal notranslate"><span class="pre">Table.quoted_table_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.row_by_id"><code class="docutils literal notranslate"><span class="pre">Table.row_by_id()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.row_count"><code class="docutils literal notranslate"><span class="pre">Table.row_count</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.search"><code class="docutils literal notranslate"><span class="pre">Table.search()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.structure"><code class="docutils literal notranslate"><span class="pre">Table.structure</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.supports_query_tokens"><code class="docutils literal notranslate"><span class="pre">Table.supports_query_tokens</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.text_for_token"><code class="docutils literal notranslate"><span class="pre">Table.text_for_token()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.token_count"><code class="docutils literal notranslate"><span class="pre">Table.token_count</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.token_doc_frequency"><code class="docutils literal notranslate"><span class="pre">Table.token_doc_frequency()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.token_frequency"><code class="docutils literal notranslate"><span class="pre">Table.token_frequency()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.tokenize"><code class="docutils literal notranslate"><span class="pre">Table.tokenize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.tokenizer"><code class="docutils literal notranslate"><span class="pre">Table.tokenizer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.tokens"><code class="docutils literal notranslate"><span class="pre">Table.tokens</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.tokens_per_column"><code class="docutils literal notranslate"><span class="pre">Table.tokens_per_column</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.Table.upsert"><code class="docutils literal notranslate"><span class="pre">Table.upsert()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.TokenizerArgument"><code class="docutils literal notranslate"><span class="pre">TokenizerArgument</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.TokenizerArgument.choices"><code class="docutils literal notranslate"><span class="pre">TokenizerArgument.choices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.TokenizerArgument.convert_default"><code class="docutils literal notranslate"><span class="pre">TokenizerArgument.convert_default</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.TokenizerArgument.convertor"><code class="docutils literal notranslate"><span class="pre">TokenizerArgument.convertor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5.TokenizerArgument.default"><code class="docutils literal notranslate"><span class="pre">TokenizerArgument.default</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.TransformTokenizer"><code class="docutils literal notranslate"><span class="pre">TransformTokenizer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.UnicodeWordsTokenizer"><code class="docutils literal notranslate"><span class="pre">UnicodeWordsTokenizer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.convert_boolean"><code class="docutils literal notranslate"><span class="pre">convert_boolean()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.convert_number_ranges"><code class="docutils literal notranslate"><span class="pre">convert_number_ranges()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.convert_string_to_python"><code class="docutils literal notranslate"><span class="pre">convert_string_to_python()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.convert_tokenize_reason"><code class="docutils literal notranslate"><span class="pre">convert_tokenize_reason()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.convert_unicode_categories"><code class="docutils literal notranslate"><span class="pre">convert_unicode_categories()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.map_functions"><code class="docutils literal notranslate"><span class="pre">map_functions</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.map_tokenizers"><code class="docutils literal notranslate"><span class="pre">map_tokenizers</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.parse_tokenizer_args"><code class="docutils literal notranslate"><span class="pre">parse_tokenizer_args()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.register_functions"><code class="docutils literal notranslate"><span class="pre">register_functions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.register_tokenizers"><code class="docutils literal notranslate"><span class="pre">register_tokenizers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.string_tokenize"><code class="docutils literal notranslate"><span class="pre">string_tokenize()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.tokenize_reasons"><code class="docutils literal notranslate"><span class="pre">tokenize_reasons</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.tokenizer_test_strings"><code class="docutils literal notranslate"><span class="pre">tokenizer_test_strings()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5.unicode_categories"><code class="docutils literal notranslate"><span class="pre">unicode_categories</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-apsw.fts5query">FTS5 Query module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5query.AND"><code class="docutils literal notranslate"><span class="pre">AND</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5query.AND.queries"><code class="docutils literal notranslate"><span class="pre">AND.queries</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER"><code class="docutils literal notranslate"><span class="pre">COLUMNFILTER</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER.columns"><code class="docutils literal notranslate"><span class="pre">COLUMNFILTER.columns</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER.filter"><code class="docutils literal notranslate"><span class="pre">COLUMNFILTER.filter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER.query"><code class="docutils literal notranslate"><span class="pre">COLUMNFILTER.query</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5query.NEAR"><code class="docutils literal notranslate"><span class="pre">NEAR</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5query.NEAR.distance"><code class="docutils literal notranslate"><span class="pre">NEAR.distance</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5query.NEAR.phrases"><code class="docutils literal notranslate"><span class="pre">NEAR.phrases</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5query.NOT"><code class="docutils literal notranslate"><span class="pre">NOT</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5query.NOT.match"><code class="docutils literal notranslate"><span class="pre">NOT.match</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5query.NOT.no_match"><code class="docutils literal notranslate"><span class="pre">NOT.no_match</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5query.OR"><code class="docutils literal notranslate"><span class="pre">OR</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5query.OR.queries"><code class="docutils literal notranslate"><span class="pre">OR.queries</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5query.PHRASE"><code class="docutils literal notranslate"><span class="pre">PHRASE</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5query.PHRASE.initial"><code class="docutils literal notranslate"><span class="pre">PHRASE.initial</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5query.PHRASE.phrase"><code class="docutils literal notranslate"><span class="pre">PHRASE.phrase</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5query.PHRASE.plus"><code class="docutils literal notranslate"><span class="pre">PHRASE.plus</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5query.PHRASE.prefix"><code class="docutils literal notranslate"><span class="pre">PHRASE.prefix</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5query.ParseError"><code class="docutils literal notranslate"><span class="pre">ParseError</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5query.ParseError.message"><code class="docutils literal notranslate"><span class="pre">ParseError.message</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5query.ParseError.position"><code class="docutils literal notranslate"><span class="pre">ParseError.position</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5query.ParseError.query"><code class="docutils literal notranslate"><span class="pre">ParseError.query</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5query.QUERY"><code class="docutils literal notranslate"><span class="pre">QUERY</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5query.QUERY_TOKENS_MARKER"><code class="docutils literal notranslate"><span class="pre">QUERY_TOKENS_MARKER</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5query.QueryTokens"><code class="docutils literal notranslate"><span class="pre">QueryTokens</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5query.QueryTokens.decode"><code class="docutils literal notranslate"><span class="pre">QueryTokens.decode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5query.QueryTokens.encode"><code class="docutils literal notranslate"><span class="pre">QueryTokens.encode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apsw.fts5query.QueryTokens.tokens"><code class="docutils literal notranslate"><span class="pre">QueryTokens.tokens</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5query.applicable_columns"><code class="docutils literal notranslate"><span class="pre">applicable_columns()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5query.extract_with_column_filters"><code class="docutils literal notranslate"><span class="pre">extract_with_column_filters()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5query.from_dict"><code class="docutils literal notranslate"><span class="pre">from_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5query.parse_query_string"><code class="docutils literal notranslate"><span class="pre">parse_query_string()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5query.quote"><code class="docutils literal notranslate"><span class="pre">quote()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5query.to_dict"><code class="docutils literal notranslate"><span class="pre">to_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5query.to_query_string"><code class="docutils literal notranslate"><span class="pre">to_query_string()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5query.walk"><code class="docutils literal notranslate"><span class="pre">walk()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-apsw.fts5aux">FTS5 Auxiliary functions module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5aux.bm25"><code class="docutils literal notranslate"><span class="pre">bm25()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5aux.inverse_document_frequency"><code class="docutils literal notranslate"><span class="pre">inverse_document_frequency()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5aux.position_rank"><code class="docutils literal notranslate"><span class="pre">position_rank()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.fts5aux.subsequence"><code class="docutils literal notranslate"><span class="pre">subsequence()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fts5tokenizer-class">FTS5Tokenizer class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#apsw.FTS5Tokenizer"><code class="docutils literal notranslate"><span class="pre">FTS5Tokenizer</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.FTS5Tokenizer.__call__"><code class="docutils literal notranslate"><span class="pre">FTS5Tokenizer.__call__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.FTS5Tokenizer.args"><code class="docutils literal notranslate"><span class="pre">FTS5Tokenizer.args</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.FTS5Tokenizer.connection"><code class="docutils literal notranslate"><span class="pre">FTS5Tokenizer.connection</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.FTS5Tokenizer.name"><code class="docutils literal notranslate"><span class="pre">FTS5Tokenizer.name</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fts5extensionapi-class">FTS5ExtensionApi class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#apsw.FTS5ExtensionApi"><code class="docutils literal notranslate"><span class="pre">FTS5ExtensionApi</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.FTS5ExtensionApi.aux_data"><code class="docutils literal notranslate"><span class="pre">FTS5ExtensionApi.aux_data</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.FTS5ExtensionApi.column_count"><code class="docutils literal notranslate"><span class="pre">FTS5ExtensionApi.column_count</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.FTS5ExtensionApi.column_locale"><code class="docutils literal notranslate"><span class="pre">FTS5ExtensionApi.column_locale()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.FTS5ExtensionApi.column_size"><code class="docutils literal notranslate"><span class="pre">FTS5ExtensionApi.column_size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.FTS5ExtensionApi.column_text"><code class="docutils literal notranslate"><span class="pre">FTS5ExtensionApi.column_text()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.FTS5ExtensionApi.column_total_size"><code class="docutils literal notranslate"><span class="pre">FTS5ExtensionApi.column_total_size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.FTS5ExtensionApi.inst_count"><code class="docutils literal notranslate"><span class="pre">FTS5ExtensionApi.inst_count</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.FTS5ExtensionApi.inst_tokens"><code class="docutils literal notranslate"><span class="pre">FTS5ExtensionApi.inst_tokens()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.FTS5ExtensionApi.phrase_column_offsets"><code class="docutils literal notranslate"><span class="pre">FTS5ExtensionApi.phrase_column_offsets()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.FTS5ExtensionApi.phrase_columns"><code class="docutils literal notranslate"><span class="pre">FTS5ExtensionApi.phrase_columns()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.FTS5ExtensionApi.phrase_count"><code class="docutils literal notranslate"><span class="pre">FTS5ExtensionApi.phrase_count</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.FTS5ExtensionApi.phrase_locations"><code class="docutils literal notranslate"><span class="pre">FTS5ExtensionApi.phrase_locations()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.FTS5ExtensionApi.phrases"><code class="docutils literal notranslate"><span class="pre">FTS5ExtensionApi.phrases</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.FTS5ExtensionApi.query_phrase"><code class="docutils literal notranslate"><span class="pre">FTS5ExtensionApi.query_phrase()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.FTS5ExtensionApi.row_count"><code class="docutils literal notranslate"><span class="pre">FTS5ExtensionApi.row_count</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.FTS5ExtensionApi.rowid"><code class="docutils literal notranslate"><span class="pre">FTS5ExtensionApi.rowid</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.FTS5ExtensionApi.tokenize"><code class="docutils literal notranslate"><span class="pre">FTS5ExtensionApi.tokenize()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-apsw.unicode">Unicode Text Handling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.unicode_version"><code class="docutils literal notranslate"><span class="pre">unicode_version</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.category"><code class="docutils literal notranslate"><span class="pre">category()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.is_extended_pictographic"><code class="docutils literal notranslate"><span class="pre">is_extended_pictographic()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.is_regional_indicator"><code class="docutils literal notranslate"><span class="pre">is_regional_indicator()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.casefold"><code class="docutils literal notranslate"><span class="pre">casefold()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.strip"><code class="docutils literal notranslate"><span class="pre">strip()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.split_lines"><code class="docutils literal notranslate"><span class="pre">split_lines()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.expand_tabs"><code class="docutils literal notranslate"><span class="pre">expand_tabs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.grapheme_length"><code class="docutils literal notranslate"><span class="pre">grapheme_length()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.grapheme_substr"><code class="docutils literal notranslate"><span class="pre">grapheme_substr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.grapheme_endswith"><code class="docutils literal notranslate"><span class="pre">grapheme_endswith()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.grapheme_startswith"><code class="docutils literal notranslate"><span class="pre">grapheme_startswith()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.grapheme_find"><code class="docutils literal notranslate"><span class="pre">grapheme_find()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.text_width"><code class="docutils literal notranslate"><span class="pre">text_width()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.text_width_substr"><code class="docutils literal notranslate"><span class="pre">text_width_substr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.guess_paragraphs"><code class="docutils literal notranslate"><span class="pre">guess_paragraphs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.text_wrap"><code class="docutils literal notranslate"><span class="pre">text_wrap()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.codepoint_name"><code class="docutils literal notranslate"><span class="pre">codepoint_name()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.version_added"><code class="docutils literal notranslate"><span class="pre">version_added()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.version_dates"><code class="docutils literal notranslate"><span class="pre">version_dates</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.grapheme_next_break"><code class="docutils literal notranslate"><span class="pre">grapheme_next_break()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.grapheme_next"><code class="docutils literal notranslate"><span class="pre">grapheme_next()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.grapheme_iter"><code class="docutils literal notranslate"><span class="pre">grapheme_iter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.grapheme_iter_with_offsets"><code class="docutils literal notranslate"><span class="pre">grapheme_iter_with_offsets()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.grapheme_iter_with_offsets_filtered"><code class="docutils literal notranslate"><span class="pre">grapheme_iter_with_offsets_filtered()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.word_next_break"><code class="docutils literal notranslate"><span class="pre">word_next_break()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.word_default_categories"><code class="docutils literal notranslate"><span class="pre">word_default_categories</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.word_next"><code class="docutils literal notranslate"><span class="pre">word_next()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.word_iter"><code class="docutils literal notranslate"><span class="pre">word_iter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.word_iter_with_offsets"><code class="docutils literal notranslate"><span class="pre">word_iter_with_offsets()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.sentence_next_break"><code class="docutils literal notranslate"><span class="pre">sentence_next_break()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.sentence_next"><code class="docutils literal notranslate"><span class="pre">sentence_next()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.sentence_iter"><code class="docutils literal notranslate"><span class="pre">sentence_iter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.sentence_iter_with_offsets"><code class="docutils literal notranslate"><span class="pre">sentence_iter_with_offsets()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.line_break_next_break"><code class="docutils literal notranslate"><span class="pre">line_break_next_break()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.line_break_next"><code class="docutils literal notranslate"><span class="pre">line_break_next()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.line_break_iter"><code class="docutils literal notranslate"><span class="pre">line_break_iter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#apsw.unicode.line_break_iter_with_offsets"><code class="docutils literal notranslate"><span class="pre">line_break_iter_with_offsets()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="example-session.html">Session Example/Tour</a></li>
<li class="toctree-l1"><a class="reference internal" href="session.html">Session extension</a></li>
<li class="toctree-l1"><a class="reference internal" href="vtable.html">Virtual Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="vfs.html">Virtual File System (VFS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="shell.html">Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="ext.html">Various interesting and useful bits of functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="exceptions.html">Exceptions and Errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="execution.html">Execution and tracing</a></li>
<li class="toctree-l1"><a class="reference internal" href="dbapi.html">DBAPI notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="pysqlite.html">sqlite3 module differences</a></li>
<li class="toctree-l1"><a class="reference internal" href="benchmarking.html">Benchmarking</a></li>
<li class="toctree-l1"><a class="reference internal" href="copyright.html">Copyright and License</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">Change History</a></li>
<li class="toctree-l1"><a class="reference internal" href="py-modindex.html">Module Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">APSW</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Full text search</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/textsearch.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="example-fts.html" class="btn btn-neutral float-left" title="Full Text Search Example/Tour" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="example-session.html" class="btn btn-neutral float-right" title="Session Example/Tour" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="full-text-search">
<h1>Full text search<a class="headerlink" href="#full-text-search" title="Link to this heading"></a></h1>
<p>APSW provides complete access to SQLite’s <a class="reference external" href="https://www.sqlite.org/fts5.html">full text search extension
5</a>, and extensive related
functionality.  The <a class="reference internal" href="example-fts.html"><span class="doc">tour</span></a> demonstrates some of
what is available.  Highlights include:</p>
<ul class="simple">
<li><p>Access to all the FTS5 C APIs to <a class="reference internal" href="connection.html#apsw.Connection.register_fts5_tokenizer" title="apsw.Connection.register_fts5_tokenizer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">register</span> <span class="pre">a</span> <span class="pre">tokenizer</span></code></a>, <a class="reference internal" href="connection.html#apsw.Connection.fts5_tokenizer" title="apsw.Connection.fts5_tokenizer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">retrieve</span> <span class="pre">a</span>
<span class="pre">tokenizer</span></code></a>, <a class="reference internal" href="#apsw.FTS5Tokenizer.__call__" title="apsw.FTS5Tokenizer.__call__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">call</span> <span class="pre">a</span> <span class="pre">tokenizer</span></code></a>, <a class="reference internal" href="connection.html#apsw.Connection.register_fts5_function" title="apsw.Connection.register_fts5_function"><code class="xref py py-meth docutils literal notranslate"><span class="pre">register</span> <span class="pre">an</span> <span class="pre">auxiliary</span>
<span class="pre">function</span></code></a>, and all of the
<a class="reference internal" href="#apsw.FTS5ExtensionApi" title="apsw.FTS5ExtensionApi"><code class="xref py py-class docutils literal notranslate"><span class="pre">extension</span> <span class="pre">API</span></code></a>.  This includes the
locale option added in <a class="reference external" href="https://sqlite.org/releaselog/3_47_0.html">SQLite 3.47</a>.</p></li>
<li><p>The <a class="reference internal" href="shell.html#shell-cmd-ftsq"><span class="std std-ref">ftsq</span></a> shell command to do a FTS5 query</p></li>
<li><p><a class="reference internal" href="#apsw.fts5.Table" title="apsw.fts5.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">apsw.fts5.Table</span></code></a> for a Pythonic interface to a FTS5 table,
including getting the <a class="reference internal" href="#apsw.fts5.Table.structure" title="apsw.fts5.Table.structure"><code class="xref py py-attr docutils literal notranslate"><span class="pre">structure</span></code></a></p></li>
<li><p>A <a class="reference internal" href="#apsw.fts5.Table.create" title="apsw.fts5.Table.create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create()</span></code></a> method to create the table that
handles the SQL quoting, triggers, and all FTS5 options.</p></li>
<li><p><a class="reference internal" href="#apsw.fts5.Table.upsert" title="apsw.fts5.Table.upsert"><code class="xref py py-meth docutils literal notranslate"><span class="pre">upsert()</span></code></a> to insert or update content, and
<a class="reference internal" href="#apsw.fts5.Table.delete" title="apsw.fts5.Table.delete"><code class="xref py py-meth docutils literal notranslate"><span class="pre">delete()</span></code></a> to delete, that both understand
<a class="reference external" href="https://www.sqlite.org/fts5.html#external_content_tables">external content tables</a></p></li>
<li><p><a class="reference internal" href="#apsw.fts5.Table.query_suggest" title="apsw.fts5.Table.query_suggest"><code class="xref py py-meth docutils literal notranslate"><span class="pre">query_suggest()</span></code></a> that improves a query by
correcting spelling, and suggesting more popular search terms</p></li>
<li><p><a class="reference internal" href="#apsw.fts5.Table.key_tokens" title="apsw.fts5.Table.key_tokens"><code class="xref py py-meth docutils literal notranslate"><span class="pre">key_tokens()</span></code></a> for statistically significant
content in a row</p></li>
<li><p><a class="reference internal" href="#apsw.fts5.Table.more_like" title="apsw.fts5.Table.more_like"><code class="xref py py-meth docutils literal notranslate"><span class="pre">more_like()</span></code></a> to provide statistically similar
rows</p></li>
<li><p><a class="reference internal" href="#apsw.fts5.UnicodeWordsTokenizer" title="apsw.fts5.UnicodeWordsTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">Unicode</span> <span class="pre">Word</span> <span class="pre">tokenizer</span></code></a>
that better determines word boundaries across all codepoints,
punctuation, and conventions.</p></li>
<li><p>Tokenizers that work with <a class="reference internal" href="#apsw.fts5.RegexTokenizer" title="apsw.fts5.RegexTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">regular</span> <span class="pre">expressions</span></code></a>, <a class="reference internal" href="#apsw.fts5.HTMLTokenizer" title="apsw.fts5.HTMLTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">HTML</span></code></a>,
and <a class="reference internal" href="#apsw.fts5.JSONTokenizer" title="apsw.fts5.JSONTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">JSON</span></code></a></p></li>
<li><p>Helpers for writing your own tokenizers including <a class="reference internal" href="#apsw.fts5.parse_tokenizer_args" title="apsw.fts5.parse_tokenizer_args"><code class="xref py py-func docutils literal notranslate"><span class="pre">argument</span>
<span class="pre">parsing</span></code></a>, and <a class="reference internal" href="#apsw.fts5.StringTokenizer" title="apsw.fts5.StringTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">handling</span>
<span class="pre">conversion</span></code></a> between the UTF8 offsets
used by FTS5 and <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> offsets used in Python.</p></li>
<li><p><a class="reference internal" href="#apsw.fts5.SimplifyTokenizer" title="apsw.fts5.SimplifyTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">SimplifyTokenizer()</span></code></a> can handle case folding and
accent removal on behalf of other tokenizers, using the latest
Unicode standard.</p></li>
<li><p><a class="reference internal" href="#module-apsw.fts5" title="apsw.fts5: Helpers for working with full text search"><code class="xref py py-mod docutils literal notranslate"><span class="pre">apsw.fts5</span></code></a> module for working with FTS5</p></li>
<li><p><a class="reference internal" href="#module-apsw.fts5query" title="apsw.fts5query: Helpers for working with `FTS5 queries &lt;https://www.sqlite.org/fts5.html#full_text_query_syntax&gt;`__"><code class="xref py py-mod docutils literal notranslate"><span class="pre">apsw.fts5query</span></code></a> module for generating, parsing, and modifying
FTS5 queries</p></li>
<li><p><a class="reference internal" href="#module-apsw.fts5aux" title="apsw.fts5aux: Auxiliary functions for ranking and match extraction"><code class="xref py py-mod docutils literal notranslate"><span class="pre">apsw.fts5aux</span></code></a> module with auxiliary functions and helpers</p></li>
<li><p><a class="reference internal" href="#module-apsw.unicode" title="apsw.unicode"><code class="xref py py-mod docutils literal notranslate"><span class="pre">apsw.unicode</span></code></a> module supporting the latest version of Unicode:</p>
<ul>
<li><p>Splitting text into user perceived characters (grapheme clusters),
words, sentences, and line breaks.</p></li>
<li><p>Methods to work on strings in grapheme cluster units rather than
Python’s individual codepoints</p></li>
<li><p>Case folding</p></li>
<li><p>Removing accents, combining marks, and using
compatibility codepoints</p></li>
<li><p>Codepoint names, regional indicator, extended pictographic</p></li>
<li><p>Helpers for outputting text to terminals that understand grapheme
cluster boundaries, how wide the text will be, and using line
breaking to choose the best location to split lines</p></li>
</ul>
</li>
</ul>
<nav class="contents local" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#key-concepts" id="id2">Key Concepts</a></p></li>
<li><p><a class="reference internal" href="#tokenizer-order-and-parameters" id="id3">Tokenizer order and parameters</a></p></li>
<li><p><a class="reference internal" href="#recommendations" id="id4">Recommendations</a></p>
<ul>
<li><p><a class="reference internal" href="#unicode-normalization" id="id5">Unicode normalization</a></p></li>
<li><p><a class="reference internal" href="#tokenizer-order" id="id6">Tokenizer order</a></p></li>
<li><p><a class="reference internal" href="#external-content-tables" id="id7">External content tables</a></p></li>
<li><p><a class="reference internal" href="#ranking-functions" id="id8">Ranking functions</a></p></li>
<li><p><a class="reference internal" href="#facets" id="id9">Facets</a></p></li>
<li><p><a class="reference internal" href="#performance" id="id10">Performance</a></p></li>
<li><p><a class="reference internal" href="#outgrowing-fts5" id="id11">Outgrowing FTS5</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#available-tokenizers" id="id12">Available tokenizers</a></p></li>
<li><p><a class="reference internal" href="#third-party-libraries" id="id13">Third party libraries</a></p>
<ul>
<li><p><a class="reference internal" href="#nltk-nltk" id="id14">NLTK (nltk)</a></p></li>
<li><p><a class="reference internal" href="#snowball-stemmer-snowballstemmer" id="id15">Snowball Stemmer (snowballstemmer)</a></p></li>
<li><p><a class="reference internal" href="#unidecode-unidecode" id="id16">Unidecode (unidecode)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#available-auxiliary-functions" id="id17">Available auxiliary functions</a></p></li>
<li><p><a class="reference internal" href="#command-line-tools" id="id18">Command line tools</a></p>
<ul>
<li><p><a class="reference internal" href="#fts5-tokenization-viewer" id="id19">FTS5 Tokenization viewer</a></p></li>
<li><p><a class="reference internal" href="#unicode" id="id20">Unicode</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#module-apsw.fts5" id="id21">FTS5 module</a></p></li>
<li><p><a class="reference internal" href="#module-apsw.fts5query" id="id22">FTS5 Query module</a></p></li>
<li><p><a class="reference internal" href="#module-apsw.fts5aux" id="id23">FTS5 Auxiliary functions module</a></p></li>
<li><p><a class="reference internal" href="#fts5tokenizer-class" id="id24">FTS5Tokenizer class</a></p></li>
<li><p><a class="reference internal" href="#fts5extensionapi-class" id="id25">FTS5ExtensionApi class</a></p></li>
<li><p><a class="reference internal" href="#module-apsw.unicode" id="id26">Unicode Text Handling</a></p></li>
</ul>
</nav>
<section id="key-concepts">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Key Concepts</a><a class="headerlink" href="#key-concepts" title="Link to this heading"></a></h2>
<p>How it works</p>
<blockquote>
<div><p>A series of tokens typically corresponding to words is produced for
each text value.  For each token, FTS5 indexes:</p>
<ul class="simple">
<li><p>The rowid the token occurred in</p></li>
<li><p>The column the token was in</p></li>
<li><p>Which token number it was</p></li>
</ul>
<p>A query is turned into tokens, and the FTS5 index consulted to find
the rows and columns those exact same query tokens occur in.
Phrases can be found by looking for consecutive token numbers.</p>
</div></blockquote>
<p>Ranking</p>
<blockquote>
<div><p>Once matches are found, you want the most relevant ones first.  A
ranking function is used to assign each match a numerical score
typically taking into account how rare the tokens are, and how
densely they appear in that row.  You can usually weight each column
so for example matches in a title column count for more.</p>
<p>You can change the ranking function on a <a class="reference external" href="https://www.sqlite.org/fts5.html#sorting_by_auxiliary_function_results">per query basis</a>
or via <a class="reference internal" href="#apsw.fts5.Table.config_rank" title="apsw.fts5.Table.config_rank"><code class="xref py py-meth docutils literal notranslate"><span class="pre">config_rank()</span></code></a> for all queries.</p>
</div></blockquote>
<p>Tokens</p>
<blockquote>
<div><p>While tokens typically correspond to words, there is no requirement
that they do so.  <strong>Tokens are not shown to the user.</strong>  Generating
appropriate tokens for your text is the key to making searches
effective.  FTS5 has a <a class="reference external" href="https://www.sqlite.org/fts5.html#the_tokendata_option">tokendata</a> to
store extra information with each token.  You should consider:</p>
<blockquote>
<div><ul class="simple">
<li><p>Extracting meaningful tokens first.  An <a class="reference internal" href="example-fts.html#example-fts-apsw-regexpre"><span class="std std-ref">example</span></a> shows extracting product ids and
then treating what remains as regular text.</p></li>
<li><p>Mapping equivalent text to the same token by using the
techniques described below (stemming, synonyms)</p></li>
<li><p>Consider alternate approaches.  For example the <a class="reference external" href="https://interglacial.com/tpj/22/">unidecode
algorithm</a> turns Unicode
text into ascii text that sounds approximately similar</p></li>
<li><p>Processing content to normalize it.  For example unifying
spelling so <code class="docutils literal notranslate"><span class="pre">colour</span></code> and <code class="docutils literal notranslate"><span class="pre">color</span></code> become the same token.  You
can use dictionaries to ensure content is consistent.</p></li>
</ul>
</div></blockquote>
</div></blockquote>
<p>Stemming</p>
<blockquote>
<div><p>Queries only work with exact matches on the tokens.  It is often
desirable to make related words produce the same token.  <a class="reference external" href="https://en.wikipedia.org/wiki/Stemming">Stemming</a> is doing this such as
removing singular vs plural so <code class="docutils literal notranslate"><span class="pre">dog</span></code> and <code class="docutils literal notranslate"><span class="pre">dogs</span></code> become the same
token, and determining the base of a word so <code class="docutils literal notranslate"><span class="pre">likes</span></code>, <code class="docutils literal notranslate"><span class="pre">liked</span></code>,
<code class="docutils literal notranslate"><span class="pre">likely</span></code>, and <code class="docutils literal notranslate"><span class="pre">liking</span></code> become the same token.
<a class="reference internal" href="#fts-third-party"><span class="std std-ref">Third party libraries</span></a> provide this for various languages.</p>
</div></blockquote>
<p>Synonyms</p>
<blockquote>
<div><p>Synonyms are words that mean the same thing.  FTS5 calls them
colocated tokens.  In a search you may want <code class="docutils literal notranslate"><span class="pre">first</span></code> to find that
as well as <code class="docutils literal notranslate"><span class="pre">1st</span></code>, or <code class="docutils literal notranslate"><span class="pre">dog</span></code> to also find <code class="docutils literal notranslate"><span class="pre">canine</span></code>, <code class="docutils literal notranslate"><span class="pre">k9</span></code>, and
<code class="docutils literal notranslate"><span class="pre">puppy</span></code>.  While you can provide additional tokens when content is
being tokenized for the index, a better place is when a query is
being tokenized.  The <a class="reference internal" href="#apsw.fts5.SynonymTokenizer" title="apsw.fts5.SynonymTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">SynonymTokenizer()</span></code></a> provides
an implementation.</p>
</div></blockquote>
<p>Stop words</p>
<blockquote>
<div><p>Search terms are only useful if they narrow down which rows are
potential matches.  Something occurring in almost every row
increases the size of the index, and the ranking function has to be
run on more rows for each search.  See the <a class="reference internal" href="example-fts.html#example-fts-tokens"><span class="std std-ref">example</span></a> for determining how many rows tokens occur in,
and <a class="reference internal" href="#apsw.fts5.StopWordsTokenizer" title="apsw.fts5.StopWordsTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">StopWordsTokenizer()</span></code></a> for removing them.</p>
</div></blockquote>
<p>Locale</p>
<blockquote>
<div><p>SQlite 3.47 added support for <a class="reference external" href="https://www.sqlite.org/fts5.html#the_locale_option">locale</a> - an
arbitrary string that can be used to mark text.  It is typically
used to denote a language and region - for example Portuguese in
Portugal has some differences than Portuguese in Brazil, and
American English has differences from British English.  You can use
the locale for other purposes - for example if your text includes
code then the locale could be used to mark what programming language
it is.</p>
</div></blockquote>
</section>
<section id="tokenizer-order-and-parameters">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Tokenizer order and parameters</a><a class="headerlink" href="#tokenizer-order-and-parameters" title="Link to this heading"></a></h2>
<p>The <a class="reference external" href="https://www.sqlite.org/fts5.html#tokenizers">tokenize</a> option
specifies how tokenization happens.  The string specifies a list of
items.  You can use <a class="reference internal" href="#apsw.fts5.Table.create" title="apsw.fts5.Table.create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apsw.fts5.Table.create()</span></code></a> to provide the list
and have all quoting done correctly, and use
<a class="reference internal" href="#apsw.fts5.Table.structure" title="apsw.fts5.Table.structure"><code class="xref py py-attr docutils literal notranslate"><span class="pre">apsw.fts5.Table.structure</span></code></a> to see what an existing table
specifies.</p>
<p>Tokenizers often take parameters, which are provided as a separate
name and value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tokenizer_name</span> <span class="n">param1</span> <span class="n">value1</span> <span class="n">param2</span> <span class="n">value2</span> <span class="n">param3</span> <span class="n">value3</span>
</pre></div>
</div>
<p>Some tokenizers work in conjunction with others.  For example the
<a class="reference internal" href="#apsw.fts5.HTMLTokenizer" title="apsw.fts5.HTMLTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">HTMLTokenizer()</span></code></a> passes on the text, excluding HTML
tags, and the <a class="reference internal" href="#apsw.fts5.StopWordsTokenizer" title="apsw.fts5.StopWordsTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">StopWordsTokenizer()</span></code></a> removes tokens
coming back from another tokenizer.  When they see a parameter name
they do not understand, they treat that as the name of the next
tokenizer, and following items as parameters to that tokenizer.</p>
<p>The overall flow is that the text to be tokenized flows from left to
right amongst the named tokenizers.  The resulting token stream then
flows from right to left.</p>
<p>This means it matters what order the tokenizers are given, and you
should ensure the order is what is expected.</p>
</section>
<section id="recommendations">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Recommendations</a><a class="headerlink" href="#recommendations" title="Link to this heading"></a></h2>
<section id="unicode-normalization">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Unicode normalization</a><a class="headerlink" href="#unicode-normalization" title="Link to this heading"></a></h3>
<p>For backwards compatibility Unicode allows multiple different ways of
specifying what will be drawn as the same character.  For example Ç can be</p>
<ul class="simple">
<li><p>One codepoint U+00C7 LATIN CAPITAL LETTER C WITH CEDILLA</p></li>
<li><p>Two codepoints U+0043 LATIN CAPITAL LETTER C, and U+0327 COMBINING
CEDILLA</p></li>
</ul>
<p>There are more complex examples and description at <a class="reference external" href="https://unicode.org/reports/tr15/#Canon_Compat_Equivalence">Unicode TR15</a>, which
describes the solution of normalization.</p>
<p>If you have text from multiple sources it is possible that it is in
multiple normalization forms.  You should use
<a class="reference external" href="https://docs.python.org/3/library/unicodedata.html#unicodedata.normalize" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">unicodedata.normalize()</span></code></a> to ensure your text is all in the same
form for indexing, and also ensure query text is in that same form.  If
you do not do this, then searches will be confusing and not match when
it visually looks like they should.</p>
<p>Form <code class="docutils literal notranslate"><span class="pre">NFC</span></code> is recommended.  If you use
<a class="reference internal" href="#apsw.fts5.SimplifyTokenizer" title="apsw.fts5.SimplifyTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">SimplifyTokenizer()</span></code></a> with <code class="docutils literal notranslate"><span class="pre">strip</span></code> enabled then it
won’t matter as that removes combing marks and uses compatibility
codepoints.</p>
</section>
<section id="tokenizer-order">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Tokenizer order</a><a class="headerlink" href="#tokenizer-order" title="Link to this heading"></a></h3>
<p>For general text, use the following:</p>
<blockquote>
<div><p>simplify casefold true strip true unicodewords</p>
</div></blockquote>
<p><a class="reference internal" href="#apsw.fts5.SimplifyTokenizer" title="apsw.fts5.SimplifyTokenizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">simplify</span></code></a>:</p>
<blockquote>
<div><ul class="simple">
<li><p>Uses compatibility codepoints</p></li>
<li><p>Removes marks and diacritics</p></li>
<li><p>Neutralizes case distinctions</p></li>
</ul>
</div></blockquote>
<p><a class="reference internal" href="#apsw.fts5.UnicodeWordsTokenizer" title="apsw.fts5.UnicodeWordsTokenizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">unicodewords</span></code></a>:</p>
<blockquote>
<div><ul class="simple">
<li><p>Finds words using the Unicode algorithm</p></li>
<li><p>Makes emoji be individually searchable</p></li>
<li><p>Makes regional indicators be individually searchable</p></li>
</ul>
</div></blockquote>
</section>
<section id="external-content-tables">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">External content tables</a><a class="headerlink" href="#external-content-tables" title="Link to this heading"></a></h3>
<p>Using <a class="reference external" href="https://www.sqlite.org/fts5.html#external_content_tables">external content tables</a> is well
handled by <a class="reference internal" href="#apsw.fts5.Table" title="apsw.fts5.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">apsw.fts5.Table</span></code></a>.  The
<a class="reference internal" href="#apsw.fts5.Table.create" title="apsw.fts5.Table.create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create()</span></code></a> method has a parameter to generate
triggers that keep the FTS5 table up to date with the content table.</p>
<p>The major advantage of using external content tables is that you can
have multiple FTS5 tables sharing the same content table.  For example
for the same content table you could have FTS5 tables for different
purposes:</p>
<ul class="simple">
<li><p>ngram for doing autocomplete</p></li>
<li><p>case folded, accent stripped, stop words, and synonyms for broad
searching</p></li>
<li><p>full fidelity index preserving case, accents, stop words, and no
synonyms for doing exact match searches.</p></li>
</ul>
<p>If you do not use an external content table then FTS5 by default makes
one of its own.  The content is used for auxiliary functions such as
highlighting or snippets from matches.</p>
<p>Your external content table can have more columns, triggers, and other
SQLite functionality that the FTS5 internal content table does not
support.  It is also possible to have <a class="reference external" href="https://www.sqlite.org/fts5.html#contentless_tables">no content table</a>.</p>
</section>
<section id="ranking-functions">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Ranking functions</a><a class="headerlink" href="#ranking-functions" title="Link to this heading"></a></h3>
<p>You can fine tune how matches are scored by applying column weights to
existing ranking functions, or by writing your own ranking functions.
See <a class="reference internal" href="#module-apsw.fts5aux" title="apsw.fts5aux: Auxiliary functions for ranking and match extraction"><code class="xref py py-mod docutils literal notranslate"><span class="pre">apsw.fts5aux</span></code></a> for some examples.</p>
</section>
<section id="facets">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Facets</a><a class="headerlink" href="#facets" title="Link to this heading"></a></h3>
<p>It is often desirable to group results together.  For example if
searching media then grouping by books, music, and movies.  Searching
a book could group by chapter.  Dated content could be grouped by
items from the last month, the last year, and older than that.  This
is known as <a class="reference external" href="https://en.wikipedia.org/wiki/Faceted_search">faceting</a>.</p>
<p>This is easy to do in SQLite, and an example of when you would use
<a class="reference external" href="https://www.sqlite.org/fts5.html#the_unindexed_column_option">unindexed columns</a>.
You can use <code class="docutils literal notranslate"><span class="pre">GROUP</span> <span class="pre">BY</span></code> to group by a facet and <code class="docutils literal notranslate"><span class="pre">LIMIT</span></code> to limit
how many results are available in each.  In our media example where an
unindexed column named <code class="docutils literal notranslate"><span class="pre">media</span></code> containing values like <code class="docutils literal notranslate"><span class="pre">book</span></code>,
<code class="docutils literal notranslate"><span class="pre">music</span></code>, and <code class="docutils literal notranslate"><span class="pre">movie</span></code> exists you could do:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">title</span><span class="p">,</span><span class="w"> </span><span class="n">release_date</span><span class="p">,</span><span class="w"> </span><span class="n">media</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">facet</span>
<span class="w">   </span><span class="k">FROM</span><span class="w"> </span><span class="k">search</span><span class="p">(</span><span class="o">?</span><span class="p">)</span>
<span class="w">   </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">facet</span>
<span class="w">   </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">rank</span>
<span class="w">   </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
</pre></div>
</div>
<p>If you were using date facets, then you can write an auxiliary
function that returns the facet (eg <code class="docutils literal notranslate"><span class="pre">0</span></code> for last month, <code class="docutils literal notranslate"><span class="pre">1</span></code> for
last year, and <code class="docutils literal notranslate"><span class="pre">2</span></code> for older than that).</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">title</span><span class="p">,</span><span class="w"> </span><span class="n">date_facet</span><span class="p">(</span><span class="k">search</span><span class="p">,</span><span class="w"> </span><span class="n">release_date</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">facet</span>
<span class="w">   </span><span class="k">FROM</span><span class="w"> </span><span class="k">search</span><span class="p">(</span><span class="o">?</span><span class="p">)</span>
<span class="w">   </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">facet</span>
<span class="w">   </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">rank</span>
<span class="w">   </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
</pre></div>
</div>
<p>Multiple GROUP BY work, so you could facet by media type and date.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">title</span><span class="p">,</span><span class="w"> </span><span class="n">media</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">media_facet</span><span class="p">,</span>
<span class="w">              </span><span class="n">date_facet</span><span class="p">(</span><span class="k">search</span><span class="p">,</span><span class="w"> </span><span class="n">release_date</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">date_facet</span>
<span class="w">   </span><span class="k">FROM</span><span class="w"> </span><span class="k">search</span><span class="p">(</span><span class="o">?</span><span class="p">)</span>
<span class="w">   </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">media_facet</span><span class="p">,</span><span class="w"> </span><span class="n">date_facet</span>
<span class="w">   </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">rank</span>
<span class="w">   </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
</pre></div>
</div>
<p>You do not need to store the facet information in the FTS5 table - it
can be in an external content or any other table, using JOIN on the
rowid of the FTS5 table.</p>
</section>
<section id="performance">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">Performance</a><a class="headerlink" href="#performance" title="Link to this heading"></a></h3>
<p>Search queries are processed in two logical steps:</p>
<blockquote>
<div><ul class="simple">
<li><p>Find all the rows matching the relevant query tokens</p></li>
<li><p>Run the ranking function on each row to sort the best matches
first</p></li>
</ul>
</div></blockquote>
<p>FTS5 performs very well.  If you need to improve performance then
closely analyse the find all rows step.  The fewer rows query tokens
match the fewer ranking function calls happen, and less overall work
has to be done.</p>
<p>A typical cause of too many matching rows is having too few different
tokens.  If tokens are case folded, accent stripped, and stemmed then
there may not be that many different tokens.</p>
<p>Initial indexing of your content will take a while as it involves a
lot of text processing.  Profiling will show bottlenecks.</p>
</section>
<section id="outgrowing-fts5">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">Outgrowing FTS5</a><a class="headerlink" href="#outgrowing-fts5" title="Link to this heading"></a></h3>
<p>FTS5 depends on exact matches between query tokens and content indexed
tokens.  This constrains search queries to exact matching after
optional steps like stemming and similar processing.</p>
<p>If you have a large amount of text and want to do similarity searching
then you will need to use a solution outside of FTS5.</p>
<p>The approach used is to convert words and sentences into a fixed
length list of floating point values - a vector.   To find matches,
the closest vectors have to be found to the query which approximately
means comparing the query vector to <strong>all</strong> of the content vectors
finding the <a class="reference external" href="https://en.wikipedia.org/wiki/Euclidean_distance#Two_dimensions">smallest overall difference</a>.
This is highly parallel with implementations using hardware/GPU
functionality.</p>
<p>Producing the vectors requires access to a multi-gigabyte model,
either locally or via a networked service.  In general the bigger the
model, the better vectors it can provide.  For example a model will
have been trained so that the vectors for <code class="docutils literal notranslate"><span class="pre">runner</span></code> and <code class="docutils literal notranslate"><span class="pre">jogger</span></code>
are close to each other, while <code class="docutils literal notranslate"><span class="pre">orange</span></code> is further away.</p>
<p>This is all well outside the scope of SQLite and FTS5.</p>
<p>The process of producing vectors is known as <a class="reference external" href="https://en.wikipedia.org/wiki/Word_embedding">word embedding</a> and <a class="reference external" href="https://en.wikipedia.org/wiki/Sentence_embedding">sentence
embedding</a>.
<a class="reference external" href="https://pypi.org/project/gensim/">Gensim</a> is a good package to
start with, with its <a class="reference external" href="https://radimrehurek.com/gensim/auto_examples/core/run_core_concepts.html">tutorial</a>
giving a good overview of what you have to do.</p>
</section>
</section>
<section id="available-tokenizers">
<span id="all-tokenizers"></span><h2><a class="toc-backref" href="#id12" role="doc-backlink">Available tokenizers</a><a class="headerlink" href="#available-tokenizers" title="Link to this heading"></a></h2>
<p>SQLite includes 4 builtin tokenizers while APSW provides several more.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Purpose</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">unicode61</span></code></p></td>
<td><p><a class="reference external" href="https://www.sqlite.org/fts5.html#unicode61_tokenizer">SQLite builtin</a> using
Unicode categories to generate tokens</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ascii</span></code></p></td>
<td><p><a class="reference external" href="https://www.sqlite.org/fts5.html#ascii_tokenizer">SQLite builtin</a> using
ASCII to generate tokens</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">porter</span></code></p></td>
<td><p><a class="reference external" href="https://www.sqlite.org/fts5.html#porter_tokenizer">SQLite builtin</a> wrapper
applying the <a class="reference external" href="https://tartarus.org/martin/PorterStemmer/">porter stemming algorithm</a>
to supplied tokens</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">trigram</span></code></p></td>
<td><p><a class="reference external" href="https://www.sqlite.org/fts5.html#the_trigram_tokenizer">SQLite builtin</a> that
turns the entire text into trigrams.  Note it does not turn
tokens into trigrams, but the entire text including all spaces
and punctuation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#apsw.fts5.UnicodeWordsTokenizer" title="apsw.fts5.UnicodeWordsTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">UnicodeWordsTokenizer()</span></code></a></p></td>
<td><p>Use Unicode algorithm for determining word segments.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#apsw.fts5.SimplifyTokenizer" title="apsw.fts5.SimplifyTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">SimplifyTokenizer()</span></code></a></p></td>
<td><p>Wrapper that transforms the token stream by neutralizing case,
and removing diacritics and similar marks</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#apsw.fts5.RegexTokenizer" title="apsw.fts5.RegexTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">RegexTokenizer()</span></code></a></p></td>
<td><p>Use <a class="reference external" href="https://docs.python.org/3/library/re.html#module-re" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">regular</span> <span class="pre">expressions</span></code></a> to generate tokens</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#apsw.fts5.RegexPreTokenizer" title="apsw.fts5.RegexPreTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">RegexPreTokenizer()</span></code></a></p></td>
<td><p>Use <a class="reference external" href="https://docs.python.org/3/library/re.html#module-re" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">regular</span> <span class="pre">expressions</span></code></a> to find tokens (eg
identifiers) and use a different tokenizer for the text between
the regular expressions</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#apsw.fts5.NGramTokenizer" title="apsw.fts5.NGramTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">NGramTokenizer()</span></code></a></p></td>
<td><p>Generates ngrams from the text, where you can specify the sizes
and unicode categories.  Useful for doing autocomplete as you
type, and substring searches.  Unlike <code class="docutils literal notranslate"><span class="pre">trigram</span></code> this works on
units of Unicode grapheme clusters  not individual codepoints.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#apsw.fts5.HTMLTokenizer" title="apsw.fts5.HTMLTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">HTMLTokenizer()</span></code></a></p></td>
<td><p>Wrapper that converts HTML to plan text for a further tokenizer
to generate tokens</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#apsw.fts5.JSONTokenizer" title="apsw.fts5.JSONTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">JSONTokenizer()</span></code></a></p></td>
<td><p>Wrapper that converts JSON to plain text for a further tokenizer
to generate tokens</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#apsw.fts5.SynonymTokenizer" title="apsw.fts5.SynonymTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">SynonymTokenizer()</span></code></a></p></td>
<td><p>Wrapper that provides additional tokens for existing ones such
as <code class="docutils literal notranslate"><span class="pre">first</span></code> for <code class="docutils literal notranslate"><span class="pre">1st</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#apsw.fts5.StopWordsTokenizer" title="apsw.fts5.StopWordsTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">StopWordsTokenizer()</span></code></a></p></td>
<td><p>Wrapper that removes tokens from the token stream that occur too
often to be useful, such as <code class="docutils literal notranslate"><span class="pre">the</span></code> in English text</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#apsw.fts5.TransformTokenizer" title="apsw.fts5.TransformTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">TransformTokenizer()</span></code></a></p></td>
<td><p>Wrapper to transform tokens, such as when stemming.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#apsw.fts5.QueryTokensTokenizer" title="apsw.fts5.QueryTokensTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">QueryTokensTokenizer()</span></code></a></p></td>
<td><p>Wrapper that recognises <a class="reference internal" href="#apsw.fts5query.QueryTokens" title="apsw.fts5query.QueryTokens"><code class="xref py py-class docutils literal notranslate"><span class="pre">apsw.fts5query.QueryTokens</span></code></a>
allowing queries using tokens directly.  This is useful if you
want to add tokens directly to a query without having to find
the text to produce the token.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#apsw.fts5.StringTokenizer" title="apsw.fts5.StringTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">StringTokenizer()</span></code></a></p></td>
<td><p>A decorator for your own tokenizers so that they operate on
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, with the decorator performing the mapping to UTF8
byte offsets for you.</p>
<p>If you have a string and want to call another tokenizer, use
<a class="reference internal" href="#apsw.fts5.string_tokenize" title="apsw.fts5.string_tokenize"><code class="xref py py-func docutils literal notranslate"><span class="pre">string_tokenize()</span></code></a>.</p>
</td>
</tr>
</tbody>
</table>
</section>
<section id="third-party-libraries">
<span id="fts-third-party"></span><h2><a class="toc-backref" href="#id13" role="doc-backlink">Third party libraries</a><a class="headerlink" href="#third-party-libraries" title="Link to this heading"></a></h2>
<p>There are several libraries available on PyPI that can be <code class="docutils literal notranslate"><span class="pre">pip</span></code>
installed (pip name in parentheses).  You can use them with the
tokenizers APSW provides.</p>
<section id="nltk-nltk">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">NLTK (nltk)</a><a class="headerlink" href="#nltk-nltk" title="Link to this heading"></a></h3>
<p><a class="reference external" href="https://www.nltk.org/">Natural Language Toolkit</a> has several
useful methods to help with search.  You can use it do stemming in
many different languages, and <a class="reference external" href="https://www.nltk.org/api/nltk.stem.html">different algorithms</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">stemmer</span> <span class="o">=</span> <span class="n">apsw</span><span class="o">.</span><span class="n">fts5</span><span class="o">.</span><span class="n">TransformTokenizer</span><span class="p">(</span>
  <span class="n">nltk</span><span class="o">.</span><span class="n">stem</span><span class="o">.</span><span class="n">snowball</span><span class="o">.</span><span class="n">EnglishStemmer</span><span class="p">()</span><span class="o">.</span><span class="n">stem</span>
<span class="p">)</span>
<span class="n">connection</span><span class="o">.</span><span class="n">register_fts5_tokenizer</span><span class="p">(</span><span class="s2">&quot;english_stemmer&quot;</span><span class="p">,</span> <span class="n">english_stemmer</span><span class="p">)</span>
</pre></div>
</div>
<p>You can use <a class="reference external" href="https://www.nltk.org/howto/wordnet.html">wordnet</a> to get
synonyms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">nltk.corpus</span><span class="w"> </span><span class="kn">import</span> <span class="n">wordnet</span>

<span class="k">def</span><span class="w"> </span><span class="nf">synonyms</span><span class="p">(</span><span class="n">word</span><span class="p">):</span>
  <span class="k">return</span> <span class="p">[</span><span class="n">syn</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="k">for</span> <span class="n">syn</span> <span class="ow">in</span> <span class="n">wordnet</span><span class="o">.</span><span class="n">synsets</span><span class="p">(</span><span class="n">word</span><span class="p">)]</span>

<span class="n">wrapper</span> <span class="o">=</span> <span class="n">apsw</span><span class="o">.</span><span class="n">fts5</span><span class="o">.</span><span class="n">SynonymTokenizer</span><span class="p">(</span><span class="n">synonyms</span><span class="p">)</span>
<span class="n">connection</span><span class="o">.</span><span class="n">register_fts5_tokenizer</span><span class="p">(</span><span class="s2">&quot;english_synonyms&quot;</span><span class="p">,</span> <span class="n">wrapper</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="snowball-stemmer-snowballstemmer">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">Snowball Stemmer (snowballstemmer)</a><a class="headerlink" href="#snowball-stemmer-snowballstemmer" title="Link to this heading"></a></h3>
<p><a class="reference external" href="https://snowballstem.org/">Snowball</a> is a successor to the Porter
stemming algorithm (<a class="reference external" href="https://www.sqlite.org/fts5.html#porter_tokenizer">included in FTS5</a>), and
supports many more languages.  It is also included as part of nltk:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">stemmer</span> <span class="o">=</span> <span class="n">apsw</span><span class="o">.</span><span class="n">fts5</span><span class="o">.</span><span class="n">TransformTokenizer</span><span class="p">(</span>
  <span class="n">snowballstemmer</span><span class="o">.</span><span class="n">stemmer</span><span class="p">(</span><span class="s2">&quot;english&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">stemWord</span>
<span class="p">)</span>
<span class="n">connection</span><span class="o">.</span><span class="n">register_fts5_tokenizer</span><span class="p">(</span><span class="s2">&quot;english_stemmer&quot;</span><span class="p">,</span> <span class="n">english_stemmer</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="unidecode-unidecode">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">Unidecode (unidecode)</a><a class="headerlink" href="#unidecode-unidecode" title="Link to this heading"></a></h3>
<p>The <a class="reference external" href="https://interglacial.com/tpj/22/">algorithm</a> turns Unicode
text into ascii text that sounds approximately similar:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">transform</span> <span class="o">=</span> <span class="n">apsw</span><span class="o">.</span><span class="n">fts5</span><span class="o">.</span><span class="n">TransformTokenizer</span><span class="p">(</span>
  <span class="n">unidecode</span><span class="o">.</span><span class="n">unidecode</span>
<span class="p">)</span>

<span class="n">connection</span><span class="o">.</span><span class="n">register_fts5_tokenizer</span><span class="p">(</span><span class="s2">&quot;unidecode&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="available-auxiliary-functions">
<h2><a class="toc-backref" href="#id17" role="doc-backlink">Available auxiliary functions</a><a class="headerlink" href="#available-auxiliary-functions" title="Link to this heading"></a></h2>
<p>SQLite includes X builtin auxiliary functions, with APSW providing
some more.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Purpose</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bm25</span></code></p></td>
<td><p><a class="reference external" href="https://www.sqlite.org/fts5.html#the_bm25_function">SQLite builtin</a>
standard algorithm for ranking matches.  It balances how rare
the search tokens are with how densely they occur.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">highlight</span></code></p></td>
<td><p><a class="reference external" href="https://www.sqlite.org/fts5.html#the_highlight_function">SQLite builtin</a>
that returns the whole text value with the search terms
highlighted</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">snippet</span></code></p></td>
<td><p><a class="reference external" href="https://www.sqlite.org/fts5.html#the_snippet_function">SQLite builtin</a>
that returns a small portion of the text containing the
highlighted search terms</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#apsw.fts5aux.bm25" title="apsw.fts5aux.bm25"><code class="xref py py-func docutils literal notranslate"><span class="pre">bm25()</span></code></a></p></td>
<td><p>A Python implementation of bm25.  This is useful as an example
of how to write your own ranking function</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#apsw.fts5aux.position_rank" title="apsw.fts5aux.position_rank"><code class="xref py py-func docutils literal notranslate"><span class="pre">position_rank()</span></code></a></p></td>
<td><p>Uses bm25 as a base, increasing rank the earlier in the content
the search terms occur</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#apsw.fts5aux.subsequence" title="apsw.fts5aux.subsequence"><code class="xref py py-func docutils literal notranslate"><span class="pre">subsequence()</span></code></a></p></td>
<td><p>Uses bm25 as a base, increasing rank when the search phrases
occur in the same order and closer to each other.  A regular
bm25 rank for the query <code class="docutils literal notranslate"><span class="pre">hello</span> <span class="pre">world</span></code> gives the same rank for
the content having those words in that order, in the opposite
order, and with any number of other words in between.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="command-line-tools">
<h2><a class="toc-backref" href="#id18" role="doc-backlink">Command line tools</a><a class="headerlink" href="#command-line-tools" title="Link to this heading"></a></h2>
<section id="fts5-tokenization-viewer">
<h3><a class="toc-backref" href="#id19" role="doc-backlink">FTS5 Tokenization viewer</a><a class="headerlink" href="#fts5-tokenization-viewer" title="Link to this heading"></a></h3>
<p>Use <code class="code docutils literal notranslate"><span class="pre">python3</span> <span class="pre">-m</span> <span class="pre">apsw.fts5</span> <span class="pre">--help</span></code> to see detailed help
information.  This tool produces a HTML file showing how a tokenizer
performs on text you supply, or builtin test text.  This is useful if
you are developing your own tokenizer, or want to work out the best
tokenizer and parameters for you.  (Note the tips in the bottom right
of the HTML.)</p>
<p>The builtin test text includes lots of complicated text from across
all of Unicode including all forms of spaces, numbers, multiple
codepoint sequences, homoglyphs, various popular languages, and hard
to tokenize text.</p>
<p>It is useful to compare the default <code class="docutils literal notranslate"><span class="pre">unicode61</span></code> tokenizer against
the recommended <code class="docutils literal notranslate"><span class="pre">simplify</span> <span class="pre">casefold</span> <span class="pre">1</span> <span class="pre">strip</span> <span class="pre">1</span> <span class="pre">unicodewords</span></code>.</p>
</section>
<section id="unicode">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">Unicode</a><a class="headerlink" href="#unicode" title="Link to this heading"></a></h3>
<p>Use <code class="code docutils literal notranslate"><span class="pre">python3</span> <span class="pre">-m</span> <span class="pre">apsw.unicode</span> <span class="pre">--help</span></code> to see detailed help
information.  Of interest are the <code class="docutils literal notranslate"><span class="pre">codepoint</span></code> subcommand to see
exactly which codepoints make up some text and <code class="docutils literal notranslate"><span class="pre">textwrap</span></code> to line
wrap text for terminal width.</p>
</section>
</section>
<section id="module-apsw.fts5">
<span id="fts5-module"></span><h2><a class="toc-backref" href="#id21" role="doc-backlink">FTS5 module</a><a class="headerlink" href="#module-apsw.fts5" title="Link to this heading"></a></h2>
<p><a class="reference internal" href="#module-apsw.fts5" title="apsw.fts5: Helpers for working with full text search"><code class="xref py py-mod docutils literal notranslate"><span class="pre">apsw.fts5</span></code></a> Various classes and functions to work with full text search.</p>
<p>This includes <a class="reference internal" href="#apsw.fts5.Table" title="apsw.fts5.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> for creating and working with FTS5 tables
in a Pythonic way, numerous <a class="reference internal" href="#all-tokenizers"><span class="std std-ref">tokenizers</span></a>, and
related functionality.</p>
<dl class="py class">
<dt class="sig sig-object py" id="apsw.fts5.FTS5TableStructure">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">FTS5TableStructure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unindexed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.13)"><span class="pre">set</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.13)"><span class="pre">set</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">content</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">content_rowid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">contentless_delete</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">contentless_unindexed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">columnsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokendata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">locale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">detail</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'full'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'column'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'none'</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apsw/fts5.html#FTS5TableStructure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.FTS5TableStructure" title="Link to this definition"></a></dt>
<dd><p>Table structure from SQL declaration available as <a class="reference internal" href="#apsw.fts5.Table.structure" title="apsw.fts5.Table.structure"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Table.structure</span></code></a></p>
<p>See <a class="reference internal" href="example-fts.html#example-fts-structure"><span class="std std-ref">the example</span></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5.FTS5TableStructure.columns">
<span class="sig-name descname"><span class="pre">columns</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#apsw.fts5.FTS5TableStructure.columns" title="Link to this definition"></a></dt>
<dd><p>All column names</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5.FTS5TableStructure.columnsize">
<span class="sig-name descname"><span class="pre">columnsize</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><a class="headerlink" href="#apsw.fts5.FTS5TableStructure.columnsize" title="Link to this definition"></a></dt>
<dd><p><a class="reference external" href="https://www.sqlite.org/fts5.html#the_columnsize_option">Columnsize option</a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5.FTS5TableStructure.content">
<span class="sig-name descname"><span class="pre">content</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><a class="headerlink" href="#apsw.fts5.FTS5TableStructure.content" title="Link to this definition"></a></dt>
<dd><p><a class="reference external" href="https://www.sqlite.org/fts5.html#external_content_and_contentless_tables">External content/content less</a> or <code class="docutils literal notranslate"><span class="pre">None</span></code> for regular</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5.FTS5TableStructure.content_rowid">
<span class="sig-name descname"><span class="pre">content_rowid</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><a class="headerlink" href="#apsw.fts5.FTS5TableStructure.content_rowid" title="Link to this definition"></a></dt>
<dd><p><a class="reference external" href="https://www.sqlite.org/fts5.html#external_content_tables">Rowid</a> if external content table else <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5.FTS5TableStructure.contentless_delete">
<span class="sig-name descname"><span class="pre">contentless_delete</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><a class="headerlink" href="#apsw.fts5.FTS5TableStructure.contentless_delete" title="Link to this definition"></a></dt>
<dd><p><a class="reference external" href="https://www.sqlite.org/fts5.html#contentless_delete_tables">Contentless delete option</a> if contentless table else <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5.FTS5TableStructure.contentless_unindexed">
<span class="sig-name descname"><span class="pre">contentless_unindexed</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><a class="headerlink" href="#apsw.fts5.FTS5TableStructure.contentless_unindexed" title="Link to this definition"></a></dt>
<dd><p><a class="reference external" href="https://www.sqlite.org/fts5.html#the_contentless_unindexed_option">Contentless unindexed option</a> if contentless table else <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5.FTS5TableStructure.detail">
<span class="sig-name descname"><span class="pre">detail</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'full'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'column'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'none'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#apsw.fts5.FTS5TableStructure.detail" title="Link to this definition"></a></dt>
<dd><p><a class="reference external" href="https://www.sqlite.org/fts5.html#the_detail_option">Detail option</a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5.FTS5TableStructure.locale">
<span class="sig-name descname"><span class="pre">locale</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><a class="headerlink" href="#apsw.fts5.FTS5TableStructure.locale" title="Link to this definition"></a></dt>
<dd><p><a class="reference external" href="https://www.sqlite.org/fts5.html#the_locale_option">Locale option</a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5.FTS5TableStructure.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#apsw.fts5.FTS5TableStructure.name" title="Link to this definition"></a></dt>
<dd><p>Table nane</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5.FTS5TableStructure.prefix">
<span class="sig-name descname"><span class="pre">prefix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.13)"><span class="pre">set</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#apsw.fts5.FTS5TableStructure.prefix" title="Link to this definition"></a></dt>
<dd><p><a class="reference external" href="https://www.sqlite.org/fts5.html#prefix_indexes">Prefix</a> values</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5.FTS5TableStructure.tokendata">
<span class="sig-name descname"><span class="pre">tokendata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><a class="headerlink" href="#apsw.fts5.FTS5TableStructure.tokendata" title="Link to this definition"></a></dt>
<dd><p><a class="reference external" href="https://www.sqlite.org/fts5.html#the_tokendata_option">Tokendata option</a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5.FTS5TableStructure.tokenize">
<span class="sig-name descname"><span class="pre">tokenize</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#apsw.fts5.FTS5TableStructure.tokenize" title="Link to this definition"></a></dt>
<dd><p><a class="reference external" href="https://www.sqlite.org/fts5.html#tokenizers">Tokenize</a> split into arguments</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5.FTS5TableStructure.unindexed">
<span class="sig-name descname"><span class="pre">unindexed</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.13)"><span class="pre">set</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#apsw.fts5.FTS5TableStructure.unindexed" title="Link to this definition"></a></dt>
<dd><p>Which columns are <a class="reference external" href="https://www.sqlite.org/fts5.html#the_unindexed_column_option">unindexed</a></p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5.HTMLTokenizer">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">HTMLTokenizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">con</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connection.html#apsw.Connection" title="apsw.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="apsw.html#apsw.Tokenizer" title="apsw.Tokenizer"><span class="pre">Tokenizer</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#HTMLTokenizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.HTMLTokenizer" title="Link to this definition"></a></dt>
<dd><p>Extracts text from HTML suitable for passing on to other tokenizers</p>
<p>This should be before the actual tokenizer in the tokenizer list.
Behind the scenes it extracts text from the HTML, and manages the
offset mapping between the HTML and the text passed on to other
tokenizers.  It also expands entities and charrefs.  Content
inside <a class="reference external" href="https://en.wikipedia.org/wiki/SVG">SVG tags</a> is
ignored.</p>
<p>If the html doesn’t start with optional whitespace then <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> or
<code class="docutils literal notranslate"><span class="pre">&amp;</span></code>, it is not considered HTML and will be passed on
unprocessed.  This would typically be the case for queries.</p>
<p><a class="reference external" href="https://docs.python.org/3/library/html.parser.html#module-html.parser" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">html.parser</span></code></a> is used for the HTML processing.</p>
<p>See <a class="reference internal" href="example-fts.html#example-fts-html"><span class="std std-ref">the example</span></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5.JSONTokenizer">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">JSONTokenizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">con</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connection.html#apsw.Connection" title="apsw.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="apsw.html#apsw.Tokenizer" title="apsw.Tokenizer"><span class="pre">Tokenizer</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#JSONTokenizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.JSONTokenizer" title="Link to this definition"></a></dt>
<dd><p>Extracts text from JSON suitable for passing to a tokenizer</p>
<p>The following tokenizer arguments are accepted:</p>
<dl class="simple">
<dt>include_keys</dt><dd><p><code class="docutils literal notranslate"><span class="pre">0</span></code> (default) or <code class="docutils literal notranslate"><span class="pre">1</span></code> if keys are extracted in addition to
values</p>
</dd>
</dl>
<p>If the JSON doesn’t start with optional whitespace then <code class="docutils literal notranslate"><span class="pre">{</span></code> or
<code class="docutils literal notranslate"><span class="pre">[</span></code>, it is not considered JSON and will be passed on
unprocessed.  This would typically be the case for queries.</p>
<p>See <a class="reference internal" href="example-fts.html#example-fts-json"><span class="std std-ref">the example</span></a>.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="apsw.fts5.MatchInfo">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">MatchInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#apsw.fts5.QueryInfo" title="apsw.fts5.QueryInfo"><span class="pre">QueryInfo</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rowid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">column_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phrase_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apsw/fts5.html#MatchInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.MatchInfo" title="Link to this definition"></a></dt>
<dd><p>Information about a matched row, returned by <a class="reference internal" href="#apsw.fts5.Table.search" title="apsw.fts5.Table.search"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.search()</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5.MatchInfo.column_size">
<span class="sig-name descname"><span class="pre">column_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#apsw.fts5.MatchInfo.column_size" title="Link to this definition"></a></dt>
<dd><p>Size of each column in tokens</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5.MatchInfo.phrase_columns">
<span class="sig-name descname"><span class="pre">phrase_columns</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#apsw.fts5.MatchInfo.phrase_columns" title="Link to this definition"></a></dt>
<dd><p>For each phrase a tuple of which columns it occurs in</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5.MatchInfo.query_info">
<span class="sig-name descname"><span class="pre">query_info</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5.QueryInfo" title="apsw.fts5.QueryInfo"><span class="pre">QueryInfo</span></a></em><a class="headerlink" href="#apsw.fts5.MatchInfo.query_info" title="Link to this definition"></a></dt>
<dd><p>Overall query information</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5.MatchInfo.rowid">
<span class="sig-name descname"><span class="pre">rowid</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#apsw.fts5.MatchInfo.rowid" title="Link to this definition"></a></dt>
<dd><p>Rowid</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5.NGramTokenizer">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">NGramTokenizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">con</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connection.html#apsw.Connection" title="apsw.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="apsw.html#apsw.Tokenizer" title="apsw.Tokenizer"><span class="pre">Tokenizer</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#NGramTokenizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.NGramTokenizer" title="Link to this definition"></a></dt>
<dd><p>Generates ngrams from the text</p>
<p>For example if doing 3 (trigram) then <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">big</span> <span class="pre">dog</span></code> would result in
<code class="docutils literal notranslate"><span class="pre">'a</span> <span class="pre">b',</span> <span class="pre">'</span> <span class="pre">bi',</span> <span class="pre">'big',</span> <span class="pre">'ig</span> <span class="pre">',</span> <span class="pre">'g</span> <span class="pre">d',</span> <span class="pre">'</span> <span class="pre">do`,</span> <span class="pre">'dog'</span></code></p>
<p>This is useful for queries where less than an entire word has been
provided such as doing completions, substring, or suffix matches.  For
example a query of <code class="docutils literal notranslate"><span class="pre">ing</span></code> would find all occurrences even at the end
of words with ngrams, but not with the <a class="reference internal" href="#apsw.fts5.UnicodeWordsTokenizer" title="apsw.fts5.UnicodeWordsTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">UnicodeWordsTokenizer()</span></code></a>
which requires the query to provide complete words.</p>
<p>This tokenizer works on units of user perceived characters
(grapheme clusters) where more than one codepoint can make up one
user perceived character.</p>
<p>The following tokenizer arguments are accepted</p>
<dl class="simple">
<dt>ngrams</dt><dd><p>Numeric ranges to generate.  Smaller values allow showing
results with less input but a larger index, while larger
values will result in quicker searches as the input grows.
Default is 3.  You can specify <a class="reference internal" href="#apsw.fts5.convert_number_ranges" title="apsw.fts5.convert_number_ranges"><code class="xref py py-func docutils literal notranslate"><span class="pre">multiple</span> <span class="pre">values</span></code></a>.</p>
</dd>
<dt>categories</dt><dd><p>Which Unicode categories to include, by default all.  You could
include everything except punctuation and separators with
<code class="docutils literal notranslate"><span class="pre">*</span> <span class="pre">!P*</span> <span class="pre">!Z*</span></code>.</p>
</dd>
<dt>emoji</dt><dd><p><code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> (default) if emoji are included, even if <cite>categories</cite>
would exclude them.</p>
</dd>
<dt>regional_indicator</dt><dd><p><code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> (default) if regional indicators  are included, even if <cite>categories</cite>
would exclude them.</p>
</dd>
</dl>
<p>See <a class="reference internal" href="example-fts.html#example-fts-autocomplete"><span class="std std-ref">the example</span></a>.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="apsw.fts5.QueryInfo">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">QueryInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phrases</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apsw/fts5.html#QueryInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.QueryInfo" title="Link to this definition"></a></dt>
<dd><p>Information relevant to the query as a whole, returned by <a class="reference internal" href="#apsw.fts5.Table.search" title="apsw.fts5.Table.search"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.search()</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5.QueryInfo.phrases">
<span class="sig-name descname"><span class="pre">phrases</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#apsw.fts5.QueryInfo.phrases" title="Link to this definition"></a></dt>
<dd><p><a class="reference internal" href="#apsw.FTS5ExtensionApi.phrases" title="apsw.FTS5ExtensionApi.phrases"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Phrases</span> <span class="pre">from</span> <span class="pre">the</span> <span class="pre">query</span></code></a></p>
<p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">OR</span> <span class="pre">b</span> <span class="pre">NOT</span> <span class="pre">c</span> <span class="pre">AND</span> <span class="pre">d</span></code> would result in <code class="docutils literal notranslate"><span class="pre">a,</span> <span class="pre">b,</span> <span class="pre">c,</span> <span class="pre">d</span></code> as
4 separate phrases.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5.QueryTokensTokenizer">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">QueryTokensTokenizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">con</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connection.html#apsw.Connection" title="apsw.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="apsw.html#apsw.Tokenizer" title="apsw.Tokenizer"><span class="pre">Tokenizer</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#QueryTokensTokenizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.QueryTokensTokenizer" title="Link to this definition"></a></dt>
<dd><p>Recognises a special tokens marker and returns those tokens for a query.
This is useful for making queries directly using tokens, instead
of pre-tokenized text.</p>
<p>It must be the first tokenizer in the list.  Any text not using
the special marker is passed to the following tokenizer.</p>
<p>See <a class="reference internal" href="#apsw.fts5query.QueryTokens" title="apsw.fts5query.QueryTokens"><code class="xref py py-class docutils literal notranslate"><span class="pre">apsw.fts5query.QueryTokens</span></code></a> for more details on the
marker format.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5.RegexPreTokenizer">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">RegexPreTokenizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">con</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connection.html#apsw.Connection" title="apsw.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/re.html#re.Pattern" title="(in Python v3.13)"><span class="pre">Pattern</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="apsw.html#apsw.Tokenizer" title="apsw.Tokenizer"><span class="pre">Tokenizer</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#RegexPreTokenizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.RegexPreTokenizer" title="Link to this definition"></a></dt>
<dd><p>Combines regular expressions and another tokenizer</p>
<p><a class="reference internal" href="#apsw.fts5.RegexTokenizer" title="apsw.fts5.RegexTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">RegexTokenizer()</span></code></a> only finds tokens matching a regular
expression, and ignores all other text.  This tokenizer calls
another tokenizer to handle the gaps between the patterns it
finds.  This is useful to extract identifiers and other known
patterns, while still doing word search on the rest of the text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pattern</strong> – The <a class="reference external" href="https://docs.python.org/3/library/re.html#regular-expression-syntax">regular expression</a>.
For example <code class="code docutils literal notranslate"><span class="pre">w+</span></code> is all alphanumeric and underscore
characters.</p></li>
<li><p><strong>flags</strong> – <a class="reference external" href="https://docs.python.org/3/library/re.html#flags">Regular expression flags</a>.  Ignored
if <cite>pattern</cite> is an already compiled pattern</p></li>
</ul>
</dd>
</dl>
<p>You must specify an additional tokenizer name and arguments.</p>
<p>See the <a class="reference internal" href="example-fts.html#example-fts-apsw-regexpre"><span class="std std-ref">example</span></a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5.RegexTokenizer">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">RegexTokenizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">con</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connection.html#apsw.Connection" title="apsw.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/re.html#re.Pattern" title="(in Python v3.13)"><span class="pre">Pattern</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="apsw.html#apsw.Tokenizer" title="apsw.Tokenizer"><span class="pre">Tokenizer</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#RegexTokenizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.RegexTokenizer" title="Link to this definition"></a></dt>
<dd><p>Finds tokens using a regular expression</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pattern</strong> – The <a class="reference external" href="https://docs.python.org/3/library/re.html#regular-expression-syntax">regular expression</a>.
For example <code class="code docutils literal notranslate"><span class="pre">w+</span></code> is all alphanumeric and underscore
characters.</p></li>
<li><p><strong>flags</strong> – <a class="reference external" href="https://docs.python.org/3/library/re.html#flags">Regular expression flags</a>.  Ignored
if <cite>pattern</cite> is an already compiled pattern</p></li>
</ul>
</dd>
</dl>
<p>See the <a class="reference internal" href="example-fts.html#example-fts-apsw-regex"><span class="std std-ref">example</span></a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5.SimplifyTokenizer">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">SimplifyTokenizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">con</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connection.html#apsw.Connection" title="apsw.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="apsw.html#apsw.Tokenizer" title="apsw.Tokenizer"><span class="pre">Tokenizer</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#SimplifyTokenizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.SimplifyTokenizer" title="Link to this definition"></a></dt>
<dd><p>Tokenizer wrapper that simplifies tokens by neutralizing case, canonicalization, and diacritic/mark removal</p>
<p>Put this before another tokenizer to simplify its output.  For example:</p>
<blockquote>
<div><p>simplify casefold true unicodewords</p>
</div></blockquote>
<p>The following tokenizer arguments are accepted, and are applied to each
token in this order.  If you do not specify an argument then it is off.</p>
<dl class="simple">
<dt>strip</dt><dd><p>Codepoints become their compatibility representation - for example
the Roman numeral Ⅲ becomes III.  Diacritics, marks, and similar
are removed.  See <a class="reference internal" href="#apsw.unicode.strip" title="apsw.unicode.strip"><code class="xref py py-func docutils literal notranslate"><span class="pre">apsw.unicode.strip()</span></code></a>.</p>
</dd>
<dt>casefold</dt><dd><p>Neutralizes case distinction.  See <a class="reference internal" href="#apsw.unicode.casefold" title="apsw.unicode.casefold"><code class="xref py py-func docutils literal notranslate"><span class="pre">apsw.unicode.casefold()</span></code></a>.</p>
</dd>
</dl>
<p>See the <a class="reference internal" href="example-fts.html#example-fts-apsw-simplify"><span class="std std-ref">example</span></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5.StopWordsTokenizer">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">StopWordsTokenizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="apsw.html#apsw.FTS5TokenizerFactory" title="apsw.FTS5TokenizerFactory"><span class="pre">FTS5TokenizerFactory</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#StopWordsTokenizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.StopWordsTokenizer" title="Link to this definition"></a></dt>
<dd><p>Removes tokens that are too frequent to be useful</p>
<p>To use you need a callable that takes a str, and returns a boolean.  If
<code class="docutils literal notranslate"><span class="pre">True</span></code> then the token is ignored.</p>
<p>The following tokenizer arguments are accepted, or use as a decorator.</p>
<dl class="simple">
<dt>test</dt><dd><p>Specify a <a class="reference internal" href="#apsw.fts5.convert_string_to_python" title="apsw.fts5.convert_string_to_python"><code class="xref py py-func docutils literal notranslate"><span class="pre">test</span></code></a></p>
</dd>
</dl>
<p>See <a class="reference internal" href="example-fts.html#example-fts-stopwords"><span class="std std-ref">the example</span></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5.StringTokenizer">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">StringTokenizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="apsw.html#apsw.FTS5TokenizerFactory" title="apsw.FTS5TokenizerFactory"><span class="pre">FTS5TokenizerFactory</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="apsw.html#apsw.Tokenizer" title="apsw.Tokenizer"><span class="pre">Tokenizer</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#StringTokenizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.StringTokenizer" title="Link to this definition"></a></dt>
<dd><p>Decorator for tokenizers that operate on strings</p>
<p>FTS5 tokenizers operate on UTF8 bytes for the text and offsets.
This decorator provides your tokenizer with text and expects text
offsets back, performing the conversions back to UTF8 byte
offsets.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5.SynonymTokenizer">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">SynonymTokenizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">get</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="apsw.html#apsw.FTS5TokenizerFactory" title="apsw.FTS5TokenizerFactory"><span class="pre">FTS5TokenizerFactory</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#SynonymTokenizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.SynonymTokenizer" title="Link to this definition"></a></dt>
<dd><p>Adds <a class="reference external" href="https://www.sqlite.org/fts5.html#synonym_support">colocated tokens</a> such as <code class="docutils literal notranslate"><span class="pre">1st</span></code> for <code class="docutils literal notranslate"><span class="pre">first</span></code>.</p>
<p>To use you need a callable that takes a str, and returns a str, a sequence of str, or None.
For example <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict.get" title="(in Python v3.13)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dict.get()</span></code></a> does that.</p>
<p>The following tokenizer arguments are accepted:</p>
<dl class="simple">
<dt>reasons</dt><dd><p>Which tokenize <a class="reference internal" href="#apsw.fts5.tokenize_reasons" title="apsw.fts5.tokenize_reasons"><code class="xref py py-data docutils literal notranslate"><span class="pre">tokenize_reasons</span></code></a> you want the lookups to happen in
as a space separated list.  Default is <code class="docutils literal notranslate"><span class="pre">QUERY</span></code>.</p>
</dd>
<dt>get</dt><dd><p>Specify a <a class="reference internal" href="#apsw.fts5.convert_string_to_python" title="apsw.fts5.convert_string_to_python"><code class="xref py py-func docutils literal notranslate"><span class="pre">get</span></code></a>, or use as a decorator.</p>
</dd>
</dl>
<p>See <a class="reference internal" href="example-fts.html#example-fts-synonym"><span class="std std-ref">the example</span></a>.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="apsw.fts5.Table">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">Table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connection.html#apsw.Connection" title="apsw.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'main'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apsw/fts5.html#Table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table" title="Link to this definition"></a></dt>
<dd><p>A helpful wrapper around a FTS5 table</p>
<p>The table must already exist.  You can use the class method
<a class="reference internal" href="#apsw.fts5.Table.create" title="apsw.fts5.Table.create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create()</span></code></a> to create a new FTS5 table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db</strong> – Connection to use</p></li>
<li><p><strong>name</strong> – Table name</p></li>
<li><p><strong>schema</strong> – Which attached database to use</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="apsw.fts5.Table.change_cookie">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">change_cookie</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#apsw.fts5.Table.change_cookie" title="Link to this definition"></a></dt>
<dd><p>An int that changes if the content of the table has changed.</p>
<p>This is useful to validate cached information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.closest_tokens">
<span class="sig-name descname"><span class="pre">closest_tokens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_docs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_tokens</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.13)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.closest_tokens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.closest_tokens" title="Link to this definition"></a></dt>
<dd><p>Returns closest known tokens to <code class="docutils literal notranslate"><span class="pre">token</span></code> with score for each</p>
<p>This uses <a class="reference external" href="https://docs.python.org/3/library/difflib.html#difflib.get_close_matches" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">difflib.get_close_matches()</span></code></a> algorithm to find
close matches.  Note that it is a statistical operation, and
has no understanding of the tokens and their meaning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>token</strong> – Token to use</p></li>
<li><p><strong>n</strong> – Maximum number of tokens to return</p></li>
<li><p><strong>cutoff</strong> – Passed to <a class="reference external" href="https://docs.python.org/3/library/difflib.html#difflib.get_close_matches" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">difflib.get_close_matches()</span></code></a>.
Larger values require closer matches and decrease
computation time.</p></li>
<li><p><strong>min_docs</strong> – Only test against other tokens that appear in
at least this many rows.  Experience is that about a
third of tokens appear only in one row.  Larger values
significantly decrease computation time, but reduce the
candidates.</p></li>
<li><p><strong>all_tokens</strong> – A sequence of tuples of candidate token
and number of rows it occurs in.  If not provided then
<a class="reference internal" href="#apsw.fts5.Table.tokens" title="apsw.fts5.Table.tokens"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tokens</span></code></a> is used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.column_named">
<span class="sig-name descname"><span class="pre">column_named</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.column_named"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.column_named" title="Link to this definition"></a></dt>
<dd><p>Returns the column matching <cite>name</cite> or <cite>None</cite> if it doesn’t exist</p>
<p>SQLite is ascii case-insensitive, so this tells you the declared name,
or None if it doesn’t exist.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apsw.fts5.Table.columns">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">columns</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="reference internal" href="_modules/apsw/fts5.html#Table.columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.columns" title="Link to this definition"></a></dt>
<dd><p>All columns of this table, including unindexed ones.  Unindexed columns are ignored in queries.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apsw.fts5.Table.columns_indexed">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">columns_indexed</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="reference internal" href="_modules/apsw/fts5.html#Table.columns_indexed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.columns_indexed" title="Link to this definition"></a></dt>
<dd><p>All columns of this table, excluding unindexed ones</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.command_delete">
<span class="sig-name descname"><span class="pre">command_delete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rowid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">column_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apsw/fts5.html#Table.command_delete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.command_delete" title="Link to this definition"></a></dt>
<dd><p>Does <a class="reference external" href="https://www.sqlite.org/fts5.html#the_delete_command">delete</a></p>
<p>See <a class="reference internal" href="#apsw.fts5.Table.delete" title="apsw.fts5.Table.delete"><code class="xref py py-meth docutils literal notranslate"><span class="pre">delete()</span></code></a> for regular row deletion.</p>
<p>If you are using an external content table, it is better to use triggers on
that table.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.command_delete_all">
<span class="sig-name descname"><span class="pre">command_delete_all</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.command_delete_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.command_delete_all" title="Link to this definition"></a></dt>
<dd><p>Does <a class="reference external" href="https://www.sqlite.org/fts5.html#the_delete_all_command">delete all</a></p>
<p>If you are using an external content table, it is better to use triggers on
that table.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.command_integrity_check">
<span class="sig-name descname"><span class="pre">command_integrity_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">external_content</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.command_integrity_check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.command_integrity_check" title="Link to this definition"></a></dt>
<dd><p>Does <a class="reference external" href="https://www.sqlite.org/fts5.html#the_integrity_check_command">integrity check</a></p>
<p>If <cite>external_content</cite> is True, then the FTS index is compared to the external content.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.command_merge">
<span class="sig-name descname"><span class="pre">command_merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.command_merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.command_merge" title="Link to this definition"></a></dt>
<dd><p>Does <a class="reference external" href="https://www.sqlite.org/fts5.html#the_merge_command">merge</a></p>
<p>See the documentation for what positive and negative values of <cite>n</cite> mean.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The difference between <a class="reference external" href="https://sqlite.org/c3ref/total_changes.html">sqlite3_total_changes()</a>
before and after running the command.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.command_optimize">
<span class="sig-name descname"><span class="pre">command_optimize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.command_optimize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.command_optimize" title="Link to this definition"></a></dt>
<dd><p>Does <a class="reference external" href="https://www.sqlite.org/fts5.html#the_optimize_command">optimize</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.command_rebuild">
<span class="sig-name descname"><span class="pre">command_rebuild</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/apsw/fts5.html#Table.command_rebuild"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.command_rebuild" title="Link to this definition"></a></dt>
<dd><p>Does <a class="reference external" href="https://www.sqlite.org/fts5.html#the_rebuild_command">rebuild</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.config">
<span class="sig-name descname"><span class="pre">config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="apsw.html#apsw.SQLiteValue" title="apsw.SQLiteValue"><span class="pre">SQLiteValue</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'x-apsw-'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="apsw.html#apsw.SQLiteValue" title="apsw.SQLiteValue"><span class="pre">SQLiteValue</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.config" title="Link to this definition"></a></dt>
<dd><p>Optionally sets, and gets a <a class="reference external" href="https://www.sqlite.org/fts5.html#configuration_options_config_table_">config value</a></p>
<p>If the value is not None, then it is changed.  It is not
recommended to change SQLite’s own values.</p>
<p>The <cite>prefix</cite> is to ensure your own config names don’t clash
with those used by SQLite.  For example you could remember the
Unicode version used by your tokenizer, and rebuild if the
version is updated.</p>
<p>The advantage of using this is that the names/values will
survive the FTS5 table being renamed, backed up, restored etc.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.config_automerge">
<span class="sig-name descname"><span class="pre">config_automerge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.config_automerge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.config_automerge" title="Link to this definition"></a></dt>
<dd><p>Optionally sets, and returns <a class="reference external" href="https://www.sqlite.org/fts5.html#the_automerge_configuration_option">automerge</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.config_crisismerge">
<span class="sig-name descname"><span class="pre">config_crisismerge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.config_crisismerge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.config_crisismerge" title="Link to this definition"></a></dt>
<dd><p>Optionally sets, and returns <a class="reference external" href="https://www.sqlite.org/fts5.html#the_crisismerge_configuration_option">crisismerge</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.config_deletemerge">
<span class="sig-name descname"><span class="pre">config_deletemerge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.config_deletemerge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.config_deletemerge" title="Link to this definition"></a></dt>
<dd><p>Optionally sets, and returns <a class="reference external" href="https://www.sqlite.org/fts5.html#the_deletemerge_configuration_option">deletemerge</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.config_insttoken">
<span class="sig-name descname"><span class="pre">config_insttoken</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.config_insttoken"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.config_insttoken" title="Link to this definition"></a></dt>
<dd><p>Optionally sets, and returns <a class="reference external" href="https://sqlite.org/fts5.html#the_insttoken_configuration_option">insttoken</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.config_pgsz">
<span class="sig-name descname"><span class="pre">config_pgsz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.config_pgsz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.config_pgsz" title="Link to this definition"></a></dt>
<dd><p>Optionally sets, and returns <a class="reference external" href="https://www.sqlite.org/fts5.html#the_pgsz_configuration_option">page size</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.config_rank">
<span class="sig-name descname"><span class="pre">config_rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.config_rank"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.config_rank" title="Link to this definition"></a></dt>
<dd><p>Optionally sets, and returns <a class="reference external" href="https://www.sqlite.org/fts5.html#the_rank_configuration_option">rank</a></p>
<p>When setting rank it must consist of a function name, open
parentheses, zero or more SQLite value literals that will be
arguments to the function, and a close parenthesis,  For example
<code class="docutils literal notranslate"><span class="pre">my_func(3,</span> <span class="pre">x'aabb',</span> <span class="pre">'hello')</span></code></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.config_secure_delete">
<span class="sig-name descname"><span class="pre">config_secure_delete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.config_secure_delete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.config_secure_delete" title="Link to this definition"></a></dt>
<dd><p>Optionally sets, and returns <a class="reference external" href="https://www.sqlite.org/fts5.html#the_secure_delete_configuration_option">secure-delete</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.config_usermerge">
<span class="sig-name descname"><span class="pre">config_usermerge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.config_usermerge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.config_usermerge" title="Link to this definition"></a></dt>
<dd><p>Optionally sets, and returns <a class="reference external" href="https://www.sqlite.org/fts5.html#the_usermerge_configuration_option">usermerge</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.create">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connection.html#apsw.Connection" title="apsw.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.13)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'main'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unindexed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.13)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.13)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">support_query_tokens</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.13)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">content</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">content_rowid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contentless_delete</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contentless_unindexed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columnsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detail</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'full'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'column'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'none'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'full'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokendata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generate_triggers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_if_exists</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Self" title="(in Python v3.13)"><span class="pre">Self</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.create"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.create" title="Link to this definition"></a></dt>
<dd><p>Creates the table, returning a <a class="reference internal" href="#apsw.fts5.Table" title="apsw.fts5.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> on success</p>
<p>You can use <a class="reference internal" href="connection.html#apsw.Connection.table_exists" title="apsw.Connection.table_exists"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apsw.Connection.table_exists()</span></code></a> to check if a
table already exists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db</strong> – connection to create the table on</p></li>
<li><p><strong>name</strong> – name of table</p></li>
<li><p><strong>columns</strong> – A sequence of column names.  If you are using
an external content table (recommended) you can supply
<code class="docutils literal notranslate"><span class="pre">None</span></code> and the column names will be from the table named by
the <code class="docutils literal notranslate"><span class="pre">content</span></code> parameter</p></li>
<li><p><strong>schema</strong> – Which attached database the table is being
created in</p></li>
<li><p><strong>unindexed</strong> – Columns that will be <a class="reference external" href="https://www.sqlite.org/fts5.html#the_unindexed_column_option">unindexed</a></p></li>
<li><p><strong>tokenize</strong> – The <a class="reference external" href="https://sqlite.org/fts5.html#tokenizers">tokenize option</a>.  Supply as a
sequence of strings which will be correctly quoted
together.</p></li>
<li><p><strong>support_query_tokens</strong> – Configure the <cite>tokenize</cite> option
to allow <a class="reference internal" href="#apsw.fts5query.QueryTokens" title="apsw.fts5query.QueryTokens"><code class="xref py py-class docutils literal notranslate"><span class="pre">queries</span> <span class="pre">using</span> <span class="pre">tokens</span></code></a>.</p></li>
<li><p><strong>rank</strong> – The <a class="reference external" href="https://www.sqlite.org/fts5.html#the_rank_configuration_option">rank option</a>
if not using the default.  See <a class="reference internal" href="#apsw.fts5.Table.config_rank" title="apsw.fts5.Table.config_rank"><code class="xref py py-meth docutils literal notranslate"><span class="pre">config_rank()</span></code></a> for required
syntax.</p></li>
<li><p><strong>prefix</strong> – The <a class="reference external" href="https://sqlite.org/fts5.html#prefix_indexes">prefix option</a>.  Supply
an int, or a sequence of int.</p></li>
<li><p><strong>content</strong> – Name of the external content table.  The
external content table must be in the same database as the
FTS5 table.</p></li>
<li><p><strong>content_rowid</strong> – Name of the <a class="reference external" href="https://sqlite.org/fts5.html#external_content_tables">content rowid column</a>
if not using the default when using an external content
table</p></li>
<li><p><strong>contentless_delete</strong> – Set the <a class="reference external" href="https://sqlite.org/fts5.html#contentless_delete_tables">contentless delete option</a>
for contentless tables.</p></li>
<li><p><strong>contentless_unindexed</strong> – Set the <a class="reference external" href="https://www.sqlite.org/fts5.html#the_contentless_unindexed_option">contentless unindexed
option</a>
for contentless tables</p></li>
<li><p><strong>columnsize</strong> – Indicate if the <a class="reference external" href="https://sqlite.org/fts5.html#the_columnsize_option">column size tracking</a>
should be disabled to save space</p></li>
<li><p><strong>detail</strong> – Indicate if <a class="reference external" href="https://sqlite.org/fts5.html#the_detail_option">detail</a> should
be reduced to save space</p></li>
<li><p><strong>tokendata</strong> – Indicate if <a class="reference external" href="https://sqlite.org/fts5.html#the_tokendata_option">tokens have separate data after
a null char</a></p></li>
<li><p><strong>locale</strong> – Indicate if a <a class="reference external" href="https://www.sqlite.org/fts5.html#the_locale_option">locale</a> is
available to tokenizers and stored in the table</p></li>
<li><p><strong>generate_triggers</strong> – If using an external content table
and this is <code class="docutils literal notranslate"><span class="pre">True</span></code>, then <a class="reference external" href="https://sqlite.org/fts5.html#external_content_tables">triggers are created</a>
to keep this table updated with changes to the external
content table.  These require a table not a view.</p></li>
<li><p><strong>drop_if_exists</strong> – The FTS5 table will be dropped if it
already exists, and then created.</p></li>
</ul>
</dd>
</dl>
<p>If you create with an external content table, then
<a class="reference internal" href="#apsw.fts5.Table.command_rebuild" title="apsw.fts5.Table.command_rebuild"><code class="xref py py-meth docutils literal notranslate"><span class="pre">command_rebuild()</span></code></a> and <a class="reference internal" href="#apsw.fts5.Table.command_optimize" title="apsw.fts5.Table.command_optimize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">command_optimize()</span></code></a> will be
run to populate the contents.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.delete">
<span class="sig-name descname"><span class="pre">delete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rowid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.delete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.delete" title="Link to this definition"></a></dt>
<dd><p>Deletes the identified row</p>
<p>If you are using an external content table then the delete is directed
to that table.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if a row was deleted</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.fts5vocab_name">
<span class="sig-name descname"><span class="pre">fts5vocab_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'row'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'col'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'instance'</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.fts5vocab_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.fts5vocab_name" title="Link to this definition"></a></dt>
<dd><p>Creates a <a class="reference external" href="https://www.sqlite.org/fts5.html#the_fts5vocab_virtual_table_module">fts5vocab table</a>
in temp and returns fully quoted name</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.is_token">
<span class="sig-name descname"><span class="pre">is_token</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.is_token"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.is_token" title="Link to this definition"></a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if it is a known token</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.key_tokens">
<span class="sig-name descname"><span class="pre">key_tokens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rowid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.key_tokens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.key_tokens" title="Link to this definition"></a></dt>
<dd><p>Finds tokens that are dense in this row, but rare in other rows</p>
<p>This is purely statistical and has no understanding of the
tokens.  Tokens that occur only in this row are ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rowid</strong> – Which row to examine</p></li>
<li><p><strong>limit</strong> – Maximum number to return</p></li>
<li><p><strong>columns</strong> – If provided then only look at specified
column(s), else all indexed columns.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A sequence of tuples where each is a tuple of token
and float score with bigger meaning more unique, sorted
highest score first.</p>
</dd>
</dl>
<p>See the <a class="reference internal" href="example-fts.html#example-fts-more"><span class="std std-ref">example</span></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#apsw.fts5.Table.text_for_token" title="apsw.fts5.Table.text_for_token"><code class="xref py py-meth docutils literal notranslate"><span class="pre">text_for_token()</span></code></a> to get original document text
corresponding to a token</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.more_like">
<span class="sig-name descname"><span class="pre">more_like</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">token_limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#apsw.fts5.MatchInfo" title="apsw.fts5.MatchInfo"><span class="pre">MatchInfo</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.more_like"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.more_like" title="Link to this definition"></a></dt>
<dd><p>Like <a class="reference internal" href="#apsw.fts5.Table.search" title="apsw.fts5.Table.search"><code class="xref py py-meth docutils literal notranslate"><span class="pre">search()</span></code></a> providing results similar to the provided ids.</p>
<p>This is useful for providing infinite scrolling.  Do a search
remembering the rowids.  When you get to the end, call this
method with those rowids.</p>
<p><a class="reference internal" href="#apsw.fts5.Table.key_tokens" title="apsw.fts5.Table.key_tokens"><code class="xref py py-meth docutils literal notranslate"><span class="pre">key_tokens()</span></code></a> is used to get key tokens from rows which is
purely statistical and has no understanding of the text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ids</strong> – rowids to consider</p></li>
<li><p><strong>columns</strong> – If provided then only look at specified
column(s), else all indexed columns.</p></li>
<li><p><strong>token_limit</strong> – How many tokens are extracted from each row.
Bigger values result in a broader search, while smaller
values narrow it.</p></li>
</ul>
</dd>
</dl>
<p>See the <a class="reference internal" href="example-fts.html#example-fts-more"><span class="std std-ref">example</span></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.query_suggest">
<span class="sig-name descname"><span class="pre">query_suggest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">tft_docs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.query_suggest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.query_suggest" title="Link to this definition"></a></dt>
<dd><p>Suggests alternate query</p>
<p>This is useful if a query returns no or few matches.  It is
purely a statistical operation based on the tokens in the
query and index. There is no guarantee that there will be more
(or any) matches.  The query structure (AND, OR, column filters etc)
is maintained.</p>
<p>Transformations include:</p>
<ul class="simple">
<li><p>Ensuring column names in column filters are of the closest
indexed column name</p></li>
<li><p>Combining such as <code class="docutils literal notranslate"><span class="pre">some</span> <span class="pre">thing</span></code> to <code class="docutils literal notranslate"><span class="pre">something</span></code></p></li>
<li><p>Splitting such as <code class="docutils literal notranslate"><span class="pre">noone</span></code> to <code class="docutils literal notranslate"><span class="pre">no</span> <span class="pre">one</span></code></p></li>
<li><p>Replacing unknown/rare words with more popular ones</p></li>
</ul>
<p>The query is parsed, tokenized, replacement tokens
established, and original text via <a class="reference internal" href="#apsw.fts5.Table.text_for_token" title="apsw.fts5.Table.text_for_token"><code class="xref py py-meth docutils literal notranslate"><span class="pre">text_for_token()</span></code></a> used
to reconstitute the query.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> – A valid query string</p></li>
<li><p><strong>threshold</strong> – Fraction of rows between <code class="docutils literal notranslate"><span class="pre">0.0</span></code> and
<code class="docutils literal notranslate"><span class="pre">1.00</span></code> to be rare - eg <code class="docutils literal notranslate"><span class="pre">0.01</span></code> means a token occurring in
less than 1% of rows is considered for replacement.  Larger
fractions increase the likelihood of replacements, while
smaller reduces it.  A value of <code class="docutils literal notranslate"><span class="pre">0</span></code> will only replace
tokens that are not in the index at all - essentially
spelling correction only</p></li>
<li><p><strong>tft_docs</strong> – Passed to <a class="reference internal" href="#apsw.fts5.Table.text_for_token" title="apsw.fts5.Table.text_for_token"><code class="xref py py-meth docutils literal notranslate"><span class="pre">text_for_token()</span></code></a> as the
<code class="docutils literal notranslate"><span class="pre">doc_limit</span></code> parameter.  Larger values produce more
representative text, but also increase processing time.</p></li>
<li><p><strong>locale</strong> – Locale used to tokenize the query.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code> if no suitable changes were found, or a replacement
query string.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apsw.fts5.Table.quoted_table_name">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">quoted_table_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="reference internal" href="_modules/apsw/fts5.html#Table.quoted_table_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.quoted_table_name" title="Link to this definition"></a></dt>
<dd><p>Provides the full table name for composing your own queries</p>
<p>It includes the attached database name and quotes special
characters like spaces.</p>
<p>You can’t use bindings for table names in queries, so use this
when constructing a query string:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_table</span> <span class="o">=</span> <span class="n">apsw</span><span class="o">.</span><span class="n">fts5</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span><span class="n">con</span><span class="p">,</span> <span class="s1">&#39;my_table&#39;</span><span class="p">)</span>

<span class="n">sql</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;SELECT ... FROM </span><span class="si">{</span><span class="w"> </span><span class="n">my_table</span><span class="o">.</span><span class="n">quoted_table_name</span><span class="w"> </span><span class="si">}</span>
<span class="s2">             WHERE ....&quot;&quot;&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.row_by_id">
<span class="sig-name descname"><span class="pre">row_by_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="apsw.html#apsw.SQLiteValue" title="apsw.SQLiteValue"><span class="pre">SQLiteValue</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="apsw.html#apsw.SQLiteValue" title="apsw.SQLiteValue"><span class="pre">SQLiteValue</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.row_by_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.row_by_id" title="Link to this definition"></a></dt>
<dd><p>Returns the contents of the row <cite>id</cite></p>
<p>You can request one column,, or several columns.  If one
column is requested then just that value is returned, and a
tuple of values for more than column.</p>
<p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.13)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">KeyError</span></code></a> is raised if the row does not exist.</p>
<p>See <a class="reference internal" href="example-fts.html#example-fts-update"><span class="std std-ref">the example</span></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apsw.fts5.Table.row_count">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">row_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#apsw.fts5.Table.row_count" title="Link to this definition"></a></dt>
<dd><p>Number of rows in the table</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.search">
<span class="sig-name descname"><span class="pre">search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">locale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#apsw.fts5.MatchInfo" title="apsw.fts5.MatchInfo"><span class="pre">MatchInfo</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.search"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.search" title="Link to this definition"></a></dt>
<dd><p>Iterates query matches, best matches first</p>
<p>This avoids the need to write SQL.  See <a class="reference internal" href="example-fts.html#example-fts-search"><span class="std std-ref">the example</span></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apsw.fts5.Table.structure">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">structure</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5.FTS5TableStructure" title="apsw.fts5.FTS5TableStructure"><span class="pre">FTS5TableStructure</span></a></em><a class="reference internal" href="_modules/apsw/fts5.html#Table.structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.structure" title="Link to this definition"></a></dt>
<dd><p>Structure of the table from the declared SQL</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apsw.fts5.Table.supports_query_tokens">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_query_tokens</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><a class="reference internal" href="_modules/apsw/fts5.html#Table.supports_query_tokens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.supports_query_tokens" title="Link to this definition"></a></dt>
<dd><p><cite>True</cite> if you can use <a class="reference internal" href="#apsw.fts5query.QueryTokens" title="apsw.fts5query.QueryTokens"><code class="xref py py-class docutils literal notranslate"><span class="pre">apsw.fts5query.QueryTokens</span></code></a> with this table</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.text_for_token">
<span class="sig-name descname"><span class="pre">text_for_token</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">doc_limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.text_for_token"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.text_for_token" title="Link to this definition"></a></dt>
<dd><p>Provides the original text used to produce <code class="docutils literal notranslate"><span class="pre">token</span></code></p>
<p>Different text produces the same token because case can be
ignored, accents and punctuation removed, synonyms and other
processing.</p>
<p>This method finds the text that produced a token, by
re-tokenizing the documents containing the token.  Highest
rowids are examined first so this biases towards the newest
content.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>token</strong> – The token to find</p></li>
<li><p><strong>doc_limit</strong> – Maximum number of documents to examine.  The
higher the limit the longer it takes, but the more
representative the text is.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The most popular text used to produce the token in
the examined documents</p>
</dd>
</dl>
<p>See <a class="reference internal" href="example-fts.html#example-fts-tokens"><span class="std std-ref">the example</span></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apsw.fts5.Table.token_count">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">token_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#apsw.fts5.Table.token_count" title="Link to this definition"></a></dt>
<dd><p>Total number of tokens across all indexed columns in all rows</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.token_doc_frequency">
<span class="sig-name descname"><span class="pre">token_doc_frequency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.token_doc_frequency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.token_doc_frequency" title="Link to this definition"></a></dt>
<dd><p>Most frequent occurring tokens, useful for building a stop words list</p>
<p>This counts the total number of documents containing the
token, so appearing 1,000 times in 1 document counts as 1,
while once each in 1,000 documents counts as 1,000.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="#apsw.fts5.Table.token_frequency" title="apsw.fts5.Table.token_frequency"><code class="xref py py-meth docutils literal notranslate"><span class="pre">token_frequency()</span></code></a></p></li>
<li><p><a class="reference internal" href="example-fts.html#example-fts-tokens"><span class="std std-ref">Example</span></a></p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.token_frequency">
<span class="sig-name descname"><span class="pre">token_frequency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.token_frequency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.token_frequency" title="Link to this definition"></a></dt>
<dd><p>Most frequent tokens, useful for building a stop words list</p>
<p>This counts the total occurrences of the token, so appearing
1,000 times in 1 document counts the same as once each in
1,000 documents.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="#apsw.fts5.Table.token_doc_frequency" title="apsw.fts5.Table.token_doc_frequency"><code class="xref py py-meth docutils literal notranslate"><span class="pre">token_doc_frequency()</span></code></a></p></li>
<li><p><a class="reference internal" href="example-fts.html#example-fts-tokens"><span class="std std-ref">Example</span></a></p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.tokenize">
<span class="sig-name descname"><span class="pre">tokenize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">utf8</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.13)"><span class="pre">bytes</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">reason</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">apsw.FTS5_TOKENIZE_DOCUMENT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_colocated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apsw/fts5.html#Table.tokenize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.tokenize" title="Link to this definition"></a></dt>
<dd><p>Tokenize the supplied utf8</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apsw.fts5.Table.tokenizer">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tokenizer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#apsw.FTS5Tokenizer" title="apsw.FTS5Tokenizer"><span class="pre">FTS5Tokenizer</span></a></em><a class="reference internal" href="_modules/apsw/fts5.html#Table.tokenizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.tokenizer" title="Link to this definition"></a></dt>
<dd><p>Tokenizer instance as used by this table</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apsw.fts5.Table.tokens">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tokens</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#apsw.fts5.Table.tokens" title="Link to this definition"></a></dt>
<dd><p>All the tokens as a dict with token as key, and the value being how many rows they are in</p>
<p>This can take some time on a large corpus - eg 2 seconds on a
gigabyte dataset with half a million documents and 650,000
tokens.  It is cached until the next content change.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apsw.fts5.Table.tokens_per_column">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tokens_per_column</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#apsw.fts5.Table.tokens_per_column" title="Link to this definition"></a></dt>
<dd><p>Count of tokens in each column, across all rows.  Unindexed columns have a value of zero</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5.Table.upsert">
<span class="sig-name descname"><span class="pre">upsert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="apsw.html#apsw.SQLiteValue" title="apsw.SQLiteValue"><span class="pre">SQLiteValue</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="apsw.html#apsw.SQLiteValue" title="apsw.SQLiteValue"><span class="pre">SQLiteValue</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#Table.upsert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.Table.upsert" title="Link to this definition"></a></dt>
<dd><p>Insert or update with columns by positional and keyword arguments</p>
<p>You can mix and match positional and keyword arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">.</span><span class="n">upsert</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">upsert</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s2">&quot;world&quot;</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">upsert</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="s2">&quot;world&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If you specify a <code class="docutils literal notranslate"><span class="pre">rowid</span></code> keyword argument that is used as
the rowid for the insert.  If the corresponding row already
exists then the row is modified with the provided values.
rowids are always integers.</p>
<p>The rowid of the inserted/modified row is returned.</p>
<p>If you are using an [external
content](<a class="reference external" href="https://www.sqlite.org/fts5.html#external_content_tables">https://www.sqlite.org/fts5.html#external_content_tables</a>)
table:</p>
<ul class="simple">
<li><p>The insert will be directed to the external content table</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rowid</span></code> will map to the <code class="docutils literal notranslate"><span class="pre">content_rowid</span></code> option if used</p></li>
<li><p>The column names and positions of the FTS5 table, not the external content table is used</p></li>
<li><p>The FTS5 table is not updated - you should use triggers on
the external content table to do that.  See the
<code class="docutils literal notranslate"><span class="pre">generate_triggers</span></code> option on <a class="reference internal" href="#apsw.fts5.Table.create" title="apsw.fts5.Table.create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create()</span></code></a>.</p></li>
</ul>
<p>See <a class="reference internal" href="example-fts.html#example-fts-update"><span class="std std-ref">the example</span></a></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="apsw.fts5.TokenizerArgument">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">TokenizerArgument</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">choices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convertor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convert_default</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apsw/fts5.html#TokenizerArgument"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.TokenizerArgument" title="Link to this definition"></a></dt>
<dd><p>Used as spec values to <a class="reference internal" href="#apsw.fts5.parse_tokenizer_args" title="apsw.fts5.parse_tokenizer_args"><code class="xref py py-func docutils literal notranslate"><span class="pre">parse_tokenizer_args()</span></code></a> - <a class="reference internal" href="example-fts.html#example-fts-own-2"><span class="std std-ref">example</span></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5.TokenizerArgument.choices">
<span class="sig-name descname"><span class="pre">choices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#apsw.fts5.TokenizerArgument.choices" title="Link to this definition"></a></dt>
<dd><p>Value must be one of these, after conversion</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5.TokenizerArgument.convert_default">
<span class="sig-name descname"><span class="pre">convert_default</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#apsw.fts5.TokenizerArgument.convert_default" title="Link to this definition"></a></dt>
<dd><p>True if the default value should be run through the convertor</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5.TokenizerArgument.convertor">
<span class="sig-name descname"><span class="pre">convertor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#apsw.fts5.TokenizerArgument.convertor" title="Link to this definition"></a></dt>
<dd><p>Function to convert string value to desired value</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5.TokenizerArgument.default">
<span class="sig-name descname"><span class="pre">default</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#apsw.fts5.TokenizerArgument.default" title="Link to this definition"></a></dt>
<dd><p>Value - set to default before parsing</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5.TransformTokenizer">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">TransformTokenizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="apsw.html#apsw.FTS5TokenizerFactory" title="apsw.FTS5TokenizerFactory"><span class="pre">FTS5TokenizerFactory</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#TransformTokenizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.TransformTokenizer" title="Link to this definition"></a></dt>
<dd><p>Transforms tokens to a different token, such as stemming</p>
<p>To use you need a callable that takes a str, and returns a list of
str, or just a str to use as replacements.  You can return an
empty list to remove the token.</p>
<p>The following tokenizer arguments are accepted.</p>
<dl class="simple">
<dt>transform</dt><dd><p>Specify a <a class="reference internal" href="#apsw.fts5.convert_string_to_python" title="apsw.fts5.convert_string_to_python"><code class="xref py py-func docutils literal notranslate"><span class="pre">transform</span></code></a>, or use
as a decorator</p>
</dd>
</dl>
<p>See <a class="reference internal" href="example-fts.html#example-fts-transform"><span class="std std-ref">the example</span></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5.UnicodeWordsTokenizer">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">UnicodeWordsTokenizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">con</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connection.html#apsw.Connection" title="apsw.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="apsw.html#apsw.Tokenizer" title="apsw.Tokenizer"><span class="pre">Tokenizer</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#UnicodeWordsTokenizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.UnicodeWordsTokenizer" title="Link to this definition"></a></dt>
<dd><p>Uses <a class="reference external" href="https://www.unicode.org/reports/tr29/">Unicode segmentation</a> to extract words</p>
<p>The following tokenizer parameters are accepted.  A segment is considered a word
if a codepoint matching any of the categories, emoji, or regional indicator is
present.</p>
<dl class="simple">
<dt>categories</dt><dd><p>Default <code class="docutils literal notranslate"><span class="pre">L*</span> <span class="pre">N*</span></code> to include letters, and numbers.  You should consider <code class="docutils literal notranslate"><span class="pre">Pd</span></code>
for punctuation dash if you want words separated with dashes to be considered one word.
<code class="docutils literal notranslate"><span class="pre">Sm</span></code> for maths symbols and <code class="docutils literal notranslate"><span class="pre">Sc</span></code> for currency symbols may also be relevant,</p>
</dd>
<dt>emoji</dt><dd><p><code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> (default) if emoji are included.  They will be a word
by themselves.</p>
</dd>
<dt>regional_indicator</dt><dd><p><code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> (default) if <a class="reference external" href="https://en.wikipedia.org/wiki/Regional_indicator_symbol">regional indicators</a> like 🇬🇧 🇵🇭
are included.  They will be a word  by themselves.</p>
</dd>
</dl>
<p>This does a lot better than the <cite>unicode61</cite> tokenizer builtin to FTS5.  It
understands user perceived characters (made of many codepoints), and punctuation
within words (eg <code class="docutils literal notranslate"><span class="pre">don't</span></code> is considered two words <code class="docutils literal notranslate"><span class="pre">don</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code> by <cite>unicode61</cite>),
as well as how various languages work.</p>
<p>For languages where there is no spacing or similar between words, only a dictionary
can determine actual word boundaries.  Examples include Japanese, Chinese, and Khmer.
In this case the algorithm returns the user perceived characters individually making
it similar to <a class="reference internal" href="#apsw.fts5.NGramTokenizer" title="apsw.fts5.NGramTokenizer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">NGramTokenizer()</span></code></a> which will provide good search experience at
the cost of a slightly larger index.</p>
<p>Use the <a class="reference internal" href="#apsw.fts5.SimplifyTokenizer" title="apsw.fts5.SimplifyTokenizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">SimplifyTokenizer()</span></code></a> to make case insensitive, remove diacritics,
combining marks, and use compatibility code points.</p>
<p>See the <a class="reference internal" href="example-fts.html#example-fts-apsw-unicodewords"><span class="std std-ref">example</span></a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5.convert_boolean">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">convert_boolean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#convert_boolean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.convert_boolean" title="Link to this definition"></a></dt>
<dd><p>Converts to boolean</p>
<p>Accepts <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">false</span></code>, and <code class="docutils literal notranslate"><span class="pre">true</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5.convert_number_ranges">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">convert_number_ranges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">numbers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.13)"><span class="pre">set</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/fts5.html#convert_number_ranges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.convert_number_ranges" title="Link to this definition"></a></dt>
<dd><p>Converts comma separated number ranges</p>
<p>Takes input like <code class="docutils literal notranslate"><span class="pre">2,3-5,17</span></code> and converts to
<code class="docutils literal notranslate"><span class="pre">{2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5,</span> <span class="pre">17}</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5.convert_string_to_python">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">convert_string_to_python</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5.html#convert_string_to_python"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.convert_string_to_python" title="Link to this definition"></a></dt>
<dd><p>Converts a string to a Python object</p>
<p>This is useful to process command line arguments and arguments to
tokenizers.  It automatically imports the necessary modules.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The string is ultimately <a class="reference external" href="https://docs.python.org/3/library/functions.html#eval" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">evaluated</span></code></a> allowing
arbitrary code execution and side effects.</p>
</div>
<p>Some examples of what is accepted are:</p>
<ul class="simple">
<li><p>3 + 4</p></li>
<li><p>apsw.fts5.RegexTokenizer</p></li>
<li><p>snowballstemmer.stemmer(“english”).stemWord</p></li>
<li><p>nltk.stem.snowball.EnglishStemmer().stem</p></li>
<li><p>shutil.rmtree(“a/directory/location”)  <strong>COULD DELETE ALL FILES</strong></p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5.convert_tokenize_reason">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">convert_tokenize_reason</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.13)"><span class="pre">set</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/fts5.html#convert_tokenize_reason"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.convert_tokenize_reason" title="Link to this definition"></a></dt>
<dd><p>Converts a space separated list of <a class="reference internal" href="#apsw.fts5.tokenize_reasons" title="apsw.fts5.tokenize_reasons"><code class="xref py py-data docutils literal notranslate"><span class="pre">tokenize_reasons</span></code></a> into a set of corresponding values</p>
<p>Use with <a class="reference internal" href="#apsw.fts5.parse_tokenizer_args" title="apsw.fts5.parse_tokenizer_args"><code class="xref py py-func docutils literal notranslate"><span class="pre">parse_tokenizer_args()</span></code></a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5.convert_unicode_categories">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">convert_unicode_categories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patterns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.13)"><span class="pre">set</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/fts5.html#convert_unicode_categories"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.convert_unicode_categories" title="Link to this definition"></a></dt>
<dd><p>Returns Unicode categories matching space separated values</p>
<p><a class="reference external" href="https://docs.python.org/3/library/fnmatch.html#fnmatch.fnmatchcase" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">fnmatch.fnmatchcase()</span></code></a> is used to check matches.  An example
pattern is <code class="docutils literal notranslate"><span class="pre">L*</span> <span class="pre">Pc</span></code> would return <code class="docutils literal notranslate"><span class="pre">{'Pc',</span> <span class="pre">'Lm',</span> <span class="pre">'Lo',</span> <span class="pre">'Lu',</span> <span class="pre">'Lt',</span>
<span class="pre">'Ll'}</span></code></p>
<p>You can also put ! in front to exclude categories, so <code class="docutils literal notranslate"><span class="pre">*</span> <span class="pre">!*m</span></code>
would be all categories except those ending in <code class="docutils literal notranslate"><span class="pre">m</span></code>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="apsw.fts5.map_functions">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">map_functions</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'position_rank':</span> <span class="pre">'apsw.fts5aux.position_rank',</span> <span class="pre">'subsequence':</span> <span class="pre">'apsw.fts5aux.subsequence'}</span></em><a class="headerlink" href="#apsw.fts5.map_functions" title="Link to this definition"></a></dt>
<dd><p>APSW provided auxiliary functions for use with <a class="reference internal" href="#apsw.fts5.register_functions" title="apsw.fts5.register_functions"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_functions()</span></code></a></p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="apsw.fts5.map_tokenizers">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">map_tokenizers</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'html':</span> <span class="pre">&lt;function</span> <span class="pre">HTMLTokenizer&gt;,</span> <span class="pre">'json':</span> <span class="pre">&lt;function</span> <span class="pre">JSONTokenizer&gt;,</span> <span class="pre">'ngram':</span> <span class="pre">&lt;function</span> <span class="pre">NGramTokenizer&gt;,</span> <span class="pre">'querytokens':</span> <span class="pre">&lt;function</span> <span class="pre">QueryTokensTokenizer&gt;,</span> <span class="pre">'simplify':</span> <span class="pre">&lt;function</span> <span class="pre">SimplifyTokenizer&gt;,</span> <span class="pre">'unicodewords':</span> <span class="pre">&lt;function</span> <span class="pre">UnicodeWordsTokenizer&gt;}</span></em><a class="headerlink" href="#apsw.fts5.map_tokenizers" title="Link to this definition"></a></dt>
<dd><p>APSW provided tokenizers for use with <a class="reference internal" href="#apsw.fts5.register_tokenizers" title="apsw.fts5.register_tokenizers"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_tokenizers()</span></code></a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5.parse_tokenizer_args">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">parse_tokenizer_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5.TokenizerArgument" title="apsw.fts5.TokenizerArgument"><span class="pre">TokenizerArgument</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">con</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connection.html#apsw.Connection" title="apsw.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/fts5.html#parse_tokenizer_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.parse_tokenizer_args" title="Link to this definition"></a></dt>
<dd><p>Parses the arguments to a tokenizer based on spec returning corresponding values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> – A dictionary where the key is a string, and the value is either
the corresponding default, or <a class="reference internal" href="#apsw.fts5.TokenizerArgument" title="apsw.fts5.TokenizerArgument"><code class="xref py py-class docutils literal notranslate"><span class="pre">TokenizerArgument</span></code></a>.</p></li>
<li><p><strong>con</strong> – Used to lookup other tokenizers</p></li>
<li><p><strong>args</strong> – A list of strings as received by <a class="reference internal" href="apsw.html#apsw.FTS5TokenizerFactory" title="apsw.FTS5TokenizerFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">apsw.FTS5TokenizerFactory</span></code></a></p></li>
</ul>
</dd>
</dl>
<p>For example to parse  <code class="docutils literal notranslate"><span class="pre">[&quot;arg1&quot;,</span> <span class="pre">&quot;3&quot;,</span> <span class="pre">&quot;big&quot;,</span> <span class="pre">&quot;ship&quot;,</span> <span class="pre">&quot;unicode61&quot;,</span> <span class="pre">&quot;yes&quot;,</span> <span class="pre">&quot;two&quot;]</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># spec on input</span>
<span class="p">{</span>
    <span class="c1"># Converts to integer</span>
    <span class="s2">&quot;arg1&quot;</span><span class="p">:</span> <span class="n">TokenizerArgument</span><span class="p">(</span><span class="n">convertor</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">7</span><span class="p">),</span>
    <span class="c1"># Limit allowed values</span>
    <span class="s2">&quot;big&quot;</span><span class="p">:</span> <span class="n">TokenizerArgument</span><span class="p">(</span><span class="n">choices</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;ship&quot;</span><span class="p">,</span> <span class="s2">&quot;plane&quot;</span><span class="p">)),</span>
    <span class="c1"># Accepts any string, with a default</span>
    <span class="s2">&quot;small&quot;</span><span class="p">:</span> <span class="s2">&quot;hello&quot;</span><span class="p">,</span>
    <span class="c1"># gathers up remaining arguments, if you intend</span>
    <span class="c1"># to process the results of another tokenizer</span>
    <span class="s2">&quot;+&quot;</span><span class="p">:</span> <span class="kc">None</span>
<span class="p">}</span>

<span class="c1"># options on output</span>
<span class="p">{</span>
    <span class="s2">&quot;arg1&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;big&quot;</span><span class="p">:</span> <span class="s2">&quot;ship&quot;</span><span class="p">,</span>
    <span class="s2">&quot;small&quot;</span><span class="p">:</span> <span class="s2">&quot;hello&quot;</span><span class="p">,</span>
    <span class="s2">&quot;+&quot;</span><span class="p">:</span> <span class="n">db</span><span class="o">.</span><span class="n">Tokenizer</span><span class="p">(</span><span class="s2">&quot;unicode61&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">])</span>
<span class="p">}</span>

<span class="c1"># Using &quot;+&quot; in your ``tokenize`` functions</span>
<span class="k">def</span><span class="w"> </span><span class="nf">tokenize</span><span class="p">(</span><span class="n">utf8</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">locale</span><span class="p">):</span>
    <span class="n">tok</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;+&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="o">*</span><span class="n">tokens</span> <span class="ow">in</span> <span class="n">tok</span><span class="p">(</span><span class="n">utf8</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">locale</span><span class="p">):</span>
        <span class="c1"># do something</span>
        <span class="k">yield</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="o">*</span><span class="n">tokens</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Some useful convertors</p>
<ul class="simple">
<li><p><a class="reference internal" href="#apsw.fts5.convert_unicode_categories" title="apsw.fts5.convert_unicode_categories"><code class="xref py py-func docutils literal notranslate"><span class="pre">convert_unicode_categories()</span></code></a></p></li>
<li><p><a class="reference internal" href="#apsw.fts5.convert_tokenize_reason" title="apsw.fts5.convert_tokenize_reason"><code class="xref py py-func docutils literal notranslate"><span class="pre">convert_tokenize_reason()</span></code></a></p></li>
<li><p><a class="reference internal" href="#apsw.fts5.convert_string_to_python" title="apsw.fts5.convert_string_to_python"><code class="xref py py-func docutils literal notranslate"><span class="pre">convert_string_to_python()</span></code></a></p></li>
<li><p><a class="reference internal" href="#apsw.fts5.convert_number_ranges" title="apsw.fts5.convert_number_ranges"><code class="xref py py-func docutils literal notranslate"><span class="pre">convert_number_ranges()</span></code></a></p></li>
</ul>
</div>
<p>See <a class="reference internal" href="example-fts.html#example-fts-own-2"><span class="std std-ref">the example</span></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5.register_functions">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">register_functions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connection.html#apsw.Connection" title="apsw.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><span class="pre">Callable</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apsw/fts5.html#register_functions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.register_functions" title="Link to this definition"></a></dt>
<dd><p>Registers auxiliary functions named in map with the connection, if not already registered</p>
<p>The map contains the function name, and either the callable or a
string which will be automatically <a class="reference internal" href="#apsw.fts5.convert_string_to_python" title="apsw.fts5.convert_string_to_python"><code class="xref py py-func docutils literal notranslate"><span class="pre">imported</span></code></a>.</p>
<p>See <a class="reference internal" href="#apsw.fts5.map_functions" title="apsw.fts5.map_functions"><code class="xref py py-data docutils literal notranslate"><span class="pre">map_functions</span></code></a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5.register_tokenizers">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">register_tokenizers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connection.html#apsw.Connection" title="apsw.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><span class="pre">Callable</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apsw/fts5.html#register_tokenizers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.register_tokenizers" title="Link to this definition"></a></dt>
<dd><p>Registers tokenizers named in map with the connection, if not already registered</p>
<p>The map contains the tokenizer name, and either the callable or a
string which will be automatically <a class="reference internal" href="#apsw.fts5.convert_string_to_python" title="apsw.fts5.convert_string_to_python"><code class="xref py py-func docutils literal notranslate"><span class="pre">imported</span></code></a>.</p>
<p>See <a class="reference internal" href="#apsw.fts5.map_tokenizers" title="apsw.fts5.map_tokenizers"><code class="xref py py-data docutils literal notranslate"><span class="pre">map_tokenizers</span></code></a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5.string_tokenize">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">string_tokenize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#apsw.FTS5Tokenizer" title="apsw.FTS5Tokenizer"><span class="pre">FTS5Tokenizer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">locale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apsw/fts5.html#string_tokenize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.string_tokenize" title="Link to this definition"></a></dt>
<dd><p>Tokenizer caller to get string offsets back</p>
<p>Calls the tokenizer doing the conversion of <cite>text</cite> to UTF8, and converting the received
UTF8 offsets back to <cite>text</cite> offsets.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="apsw.fts5.tokenize_reasons">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">tokenize_reasons</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'AUX':</span> <span class="pre">8,</span> <span class="pre">'DOCUMENT':</span> <span class="pre">4,</span> <span class="pre">'QUERY':</span> <span class="pre">1,</span> <span class="pre">'QUERY_PREFIX':</span> <span class="pre">3}</span></em><a class="headerlink" href="#apsw.fts5.tokenize_reasons" title="Link to this definition"></a></dt>
<dd><p>Mapping between friendly strings and constants for <a class="reference external" href="https://www.sqlite.org/fts5.html#custom_tokenizers">xTokenize flags</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5.tokenizer_test_strings">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">tokenizer_test_strings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><span class="pre">Path</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.13)"><span class="pre">bytes</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/fts5.html#tokenizer_test_strings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5.tokenizer_test_strings" title="Link to this definition"></a></dt>
<dd><p>Provides utf-8 bytes sequences for interesting test strings</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> – File to load.  If None then the builtin one is used</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple where each item is a tuple of utf8 bytes and comment str</p>
</dd>
</dl>
<p>The test file should be UTF-8 encoded text.</p>
<p>If it starts with a # then it is considered to be multiple text sections
where a # line contains a description of the section.  Any lines beginning
## are ignored.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="apsw.fts5.unicode_categories">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5.</span></span><span class="sig-name descname"><span class="pre">unicode_categories</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'Cc':</span> <span class="pre">'Other</span> <span class="pre">control',</span> <span class="pre">'Cf':</span> <span class="pre">'Other</span> <span class="pre">format',</span> <span class="pre">'Cn':</span> <span class="pre">'Other</span> <span class="pre">not</span> <span class="pre">assigned',</span> <span class="pre">'Co':</span> <span class="pre">'Other</span> <span class="pre">private</span> <span class="pre">use',</span> <span class="pre">'Cs':</span> <span class="pre">'Other</span> <span class="pre">surrogate',</span> <span class="pre">'Ll':</span> <span class="pre">'Letter</span> <span class="pre">Lowercase',</span> <span class="pre">'Lm':</span> <span class="pre">'Letter</span> <span class="pre">modifier',</span> <span class="pre">'Lo':</span> <span class="pre">'Letter</span> <span class="pre">other',</span> <span class="pre">'Lt':</span> <span class="pre">'Letter</span> <span class="pre">titlecase',</span> <span class="pre">'Lu':</span> <span class="pre">'Letter</span> <span class="pre">Uppercase',</span> <span class="pre">'Mc':</span> <span class="pre">'Mark</span> <span class="pre">spacing</span> <span class="pre">combining',</span> <span class="pre">'Me':</span> <span class="pre">'Mark</span> <span class="pre">enclosing',</span> <span class="pre">'Mn':</span> <span class="pre">'Mark</span> <span class="pre">nonspacing',</span> <span class="pre">'Nd':</span> <span class="pre">'Number</span> <span class="pre">decimal</span> <span class="pre">digit',</span> <span class="pre">'Nl':</span> <span class="pre">'Number</span> <span class="pre">letter',</span> <span class="pre">'No':</span> <span class="pre">'Number</span> <span class="pre">other',</span> <span class="pre">'Pc':</span> <span class="pre">'Punctuation</span> <span class="pre">connector',</span> <span class="pre">'Pd':</span> <span class="pre">'Punctuation</span> <span class="pre">dash',</span> <span class="pre">'Pe':</span> <span class="pre">'Punctuation</span> <span class="pre">close',</span> <span class="pre">'Pf':</span> <span class="pre">'Punctuation</span> <span class="pre">final</span> <span class="pre">quote',</span> <span class="pre">'Pi':</span> <span class="pre">'Punctuation</span> <span class="pre">initial</span> <span class="pre">quote',</span> <span class="pre">'Po':</span> <span class="pre">'Punctuation</span> <span class="pre">other',</span> <span class="pre">'Ps':</span> <span class="pre">'Punctuation</span> <span class="pre">open',</span> <span class="pre">'Sc':</span> <span class="pre">'Symbol</span> <span class="pre">currency',</span> <span class="pre">'Sk':</span> <span class="pre">'Symbol</span> <span class="pre">modifier',</span> <span class="pre">'Sm':</span> <span class="pre">'Symbol</span> <span class="pre">math',</span> <span class="pre">'So':</span> <span class="pre">'Symbol</span> <span class="pre">other',</span> <span class="pre">'Zl':</span> <span class="pre">'Separator</span> <span class="pre">line',</span> <span class="pre">'Zp':</span> <span class="pre">'Separator</span> <span class="pre">paragraph',</span> <span class="pre">'Zs':</span> <span class="pre">'Separator</span> <span class="pre">space'}</span></em><a class="headerlink" href="#apsw.fts5.unicode_categories" title="Link to this definition"></a></dt>
<dd><p>Unicode categories and descriptions for reference</p>
</dd></dl>

</section>
<section id="module-apsw.fts5query">
<span id="fts5-query-module"></span><h2><a class="toc-backref" href="#id22" role="doc-backlink">FTS5 Query module</a><a class="headerlink" href="#module-apsw.fts5query" title="Link to this heading"></a></h2>
<p><a class="reference internal" href="#module-apsw.fts5query" title="apsw.fts5query: Helpers for working with `FTS5 queries &lt;https://www.sqlite.org/fts5.html#full_text_query_syntax&gt;`__"><code class="xref py py-mod docutils literal notranslate"><span class="pre">apsw.fts5query</span></code></a> Create, parse, and modify queries</p>
<p>There are 3 representations of a query available:</p>
<p>query string</p>
<blockquote>
<div><p>This the string syntax <a class="reference external" href="https://www.sqlite.org/fts5.html#full_text_query_syntax">accepted by FTS5</a> where
you represent AND, OR, NEAR, column filtering etc inline in the
string.  An example is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">love</span> <span class="n">AND</span> <span class="p">(</span><span class="n">title</span><span class="p">:</span><span class="o">^</span><span class="s2">&quot;big world&quot;</span> <span class="n">NOT</span> <span class="n">summary</span><span class="p">:</span><span class="s2">&quot;sunset cruise&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>parsed</p>
<blockquote>
<div><p>This is a hierarchical representation using <a class="reference external" href="https://docs.python.org/3/library/dataclasses.html#module-dataclasses" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dataclasses</span></code></a>
with all fields present.  Represented as <a class="reference internal" href="#apsw.fts5query.QUERY" title="apsw.fts5query.QUERY"><code class="xref py py-class docutils literal notranslate"><span class="pre">QUERY</span></code></a>, it uses
<a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><code class="xref py py-class docutils literal notranslate"><span class="pre">PHRASE</span></code></a>,  <a class="reference internal" href="#apsw.fts5query.NEAR" title="apsw.fts5query.NEAR"><code class="xref py py-class docutils literal notranslate"><span class="pre">NEAR</span></code></a>, <a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><code class="xref py py-class docutils literal notranslate"><span class="pre">COLUMNFILTER</span></code></a>,
<a class="reference internal" href="#apsw.fts5query.AND" title="apsw.fts5query.AND"><code class="xref py py-class docutils literal notranslate"><span class="pre">AND</span></code></a>, <a class="reference internal" href="#apsw.fts5query.NOT" title="apsw.fts5query.NOT"><code class="xref py py-class docutils literal notranslate"><span class="pre">NOT</span></code></a>, and <a class="reference internal" href="#apsw.fts5query.OR" title="apsw.fts5query.OR"><code class="xref py py-class docutils literal notranslate"><span class="pre">OR</span></code></a>.  The string example
above is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AND</span><span class="p">(</span><span class="n">queries</span><span class="o">=</span><span class="p">[</span><span class="n">PHRASE</span><span class="p">(</span><span class="n">phrase</span><span class="o">=</span><span class="s1">&#39;love&#39;</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plus</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
            <span class="n">NOT</span><span class="p">(</span><span class="n">match</span><span class="o">=</span><span class="n">COLUMNFILTER</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">],</span>
                                    <span class="nb">filter</span><span class="o">=</span><span class="s1">&#39;include&#39;</span><span class="p">,</span>
                                    <span class="n">query</span><span class="o">=</span><span class="n">PHRASE</span><span class="p">(</span><span class="n">phrase</span><span class="o">=</span><span class="s1">&#39;big world&#39;</span><span class="p">,</span>
                                                <span class="n">initial</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                <span class="n">prefix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                <span class="n">plus</span><span class="o">=</span><span class="kc">None</span><span class="p">)),</span>
                <span class="n">no_match</span><span class="o">=</span><span class="n">COLUMNFILTER</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">],</span>
                                    <span class="nb">filter</span><span class="o">=</span><span class="s1">&#39;include&#39;</span><span class="p">,</span>
                                    <span class="n">query</span><span class="o">=</span><span class="n">PHRASE</span><span class="p">(</span><span class="n">phrase</span><span class="o">=</span><span class="s1">&#39;sunset cruise&#39;</span><span class="p">,</span>
                                                    <span class="n">initial</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                    <span class="n">prefix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                    <span class="n">plus</span><span class="o">=</span><span class="kc">None</span><span class="p">)))])</span>
</pre></div>
</div>
</div></blockquote>
<p>dict</p>
<blockquote>
<div><p>This is a hierarchical representation using Python
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dictionaries</span></code></a> which is easy for logging, storing as
JSON, and manipulating.  Fields containing default values are
omitted.  When provided to methods in this module, you do not need
to provide intermediate PHRASE - just Python lists and strings
directly.  This is the easiest form to programmatically compose
and modify queries in. The string example above is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;@&#39;</span><span class="p">:</span> <span class="s1">&#39;AND&#39;</span><span class="p">,</span>
<span class="s1">&#39;queries&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;@&#39;</span><span class="p">:</span> <span class="s1">&#39;PHRASE&#39;</span><span class="p">,</span> <span class="s1">&#39;phrase&#39;</span><span class="p">:</span> <span class="s1">&#39;love&#39;</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;@&#39;</span><span class="p">:</span> <span class="s1">&#39;NOT&#39;</span><span class="p">,</span>
            <span class="s1">&#39;match&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;@&#39;</span><span class="p">:</span> <span class="s1">&#39;COLUMNFILTER&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;filter&#39;</span><span class="p">:</span> <span class="s1">&#39;include&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;query&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;@&#39;</span><span class="p">:</span> <span class="s1">&#39;PHRASE&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;initial&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                <span class="s1">&#39;phrase&#39;</span><span class="p">:</span> <span class="s1">&#39;big world&#39;</span><span class="p">}},</span>
            <span class="s1">&#39;no_match&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;@&#39;</span><span class="p">:</span> <span class="s1">&#39;COLUMNFILTER&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;filter&#39;</span><span class="p">:</span> <span class="s1">&#39;include&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;query&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;@&#39;</span><span class="p">:</span> <span class="s1">&#39;PHRASE&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;phrase&#39;</span><span class="p">:</span> <span class="s1">&#39;sunset cruise&#39;</span><span class="p">}}}]}</span>
</pre></div>
</div>
</div></blockquote>
<p>See <a class="reference internal" href="example-fts.html#example-fts-query"><span class="std std-ref">the example</span></a>.</p>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Conversion functions</span><a class="headerlink" href="#id1" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>From type</p></th>
<th class="head"><p>To type</p></th>
<th class="head"><p>Conversion method</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>query string</p></td>
<td><p>parsed</p></td>
<td><p><a class="reference internal" href="#apsw.fts5query.parse_query_string" title="apsw.fts5query.parse_query_string"><code class="xref py py-func docutils literal notranslate"><span class="pre">parse_query_string()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>parsed</p></td>
<td><p>dict</p></td>
<td><p><a class="reference internal" href="#apsw.fts5query.to_dict" title="apsw.fts5query.to_dict"><code class="xref py py-func docutils literal notranslate"><span class="pre">to_dict()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>dict</p></td>
<td><p>parsed</p></td>
<td><p><a class="reference internal" href="#apsw.fts5query.from_dict" title="apsw.fts5query.from_dict"><code class="xref py py-func docutils literal notranslate"><span class="pre">from_dict()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>parsed</p></td>
<td><p>query string</p></td>
<td><p><a class="reference internal" href="#apsw.fts5query.to_query_string" title="apsw.fts5query.to_query_string"><code class="xref py py-func docutils literal notranslate"><span class="pre">to_query_string()</span></code></a></p></td>
</tr>
</tbody>
</table>
<p>Other helpful functionality includes:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#apsw.fts5query.quote" title="apsw.fts5query.quote"><code class="xref py py-func docutils literal notranslate"><span class="pre">quote()</span></code></a> to appropriately double quote strings</p></li>
<li><p><a class="reference internal" href="#apsw.fts5query.extract_with_column_filters" title="apsw.fts5query.extract_with_column_filters"><code class="xref py py-func docutils literal notranslate"><span class="pre">extract_with_column_filters()</span></code></a> to get a <a class="reference internal" href="#apsw.fts5query.QUERY" title="apsw.fts5query.QUERY"><code class="xref py py-class docutils literal notranslate"><span class="pre">QUERY</span></code></a> for a node within
an existing <a class="reference internal" href="#apsw.fts5query.QUERY" title="apsw.fts5query.QUERY"><code class="xref py py-class docutils literal notranslate"><span class="pre">QUERY</span></code></a> but applying the intermediate column filters.</p></li>
<li><p><a class="reference internal" href="#apsw.fts5query.applicable_columns" title="apsw.fts5query.applicable_columns"><code class="xref py py-func docutils literal notranslate"><span class="pre">applicable_columns()</span></code></a> to work out which columns apply to part of a
<a class="reference internal" href="#apsw.fts5query.QUERY" title="apsw.fts5query.QUERY"><code class="xref py py-class docutils literal notranslate"><span class="pre">QUERY</span></code></a></p></li>
<li><p><a class="reference internal" href="#apsw.fts5query.walk" title="apsw.fts5query.walk"><code class="xref py py-func docutils literal notranslate"><span class="pre">walk()</span></code></a> to traverse a parsed query</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="apsw.fts5query.AND">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">apsw.fts5query.</span></span><span class="sig-name descname"><span class="pre">AND</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">queries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><span class="pre">COLUMNFILTER</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NEAR" title="apsw.fts5query.NEAR"><span class="pre">NEAR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.AND" title="apsw.fts5query.AND"><span class="pre">AND</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.OR" title="apsw.fts5query.OR"><span class="pre">OR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NOT" title="apsw.fts5query.NOT"><span class="pre">NOT</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apsw/fts5query.html#AND"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5query.AND" title="Link to this definition"></a></dt>
<dd><p>All queries <a class="reference external" href="https://www.sqlite.org/fts5.html#fts5_boolean_operators">must match</a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5query.AND.queries">
<span class="sig-name descname"><span class="pre">queries</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><span class="pre">COLUMNFILTER</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NEAR" title="apsw.fts5query.NEAR"><span class="pre">NEAR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.AND" title="apsw.fts5query.AND"><span class="pre">AND</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.OR" title="apsw.fts5query.OR"><span class="pre">OR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NOT" title="apsw.fts5query.NOT"><span class="pre">NOT</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#apsw.fts5query.AND.queries" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="apsw.fts5query.COLUMNFILTER">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">apsw.fts5query.</span></span><span class="sig-name descname"><span class="pre">COLUMNFILTER</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'include'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'exclude'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><span class="pre">COLUMNFILTER</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NEAR" title="apsw.fts5query.NEAR"><span class="pre">NEAR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.AND" title="apsw.fts5query.AND"><span class="pre">AND</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.OR" title="apsw.fts5query.OR"><span class="pre">OR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NOT" title="apsw.fts5query.NOT"><span class="pre">NOT</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apsw/fts5query.html#COLUMNFILTER"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5query.COLUMNFILTER" title="Link to this definition"></a></dt>
<dd><p>Limit query to <a class="reference external" href="https://www.sqlite.org/fts5.html#fts5_column_filters">certain columns</a></p>
<p>This always reduces the columns that phrase matching will be done
against.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5query.COLUMNFILTER.columns">
<span class="sig-name descname"><span class="pre">columns</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#apsw.fts5query.COLUMNFILTER.columns" title="Link to this definition"></a></dt>
<dd><p>Limit phrase matching by these columns</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5query.COLUMNFILTER.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'include'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'exclude'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#apsw.fts5query.COLUMNFILTER.filter" title="Link to this definition"></a></dt>
<dd><p>Including or excluding the columns</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5query.COLUMNFILTER.query">
<span class="sig-name descname"><span class="pre">query</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><span class="pre">COLUMNFILTER</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NEAR" title="apsw.fts5query.NEAR"><span class="pre">NEAR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.AND" title="apsw.fts5query.AND"><span class="pre">AND</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.OR" title="apsw.fts5query.OR"><span class="pre">OR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NOT" title="apsw.fts5query.NOT"><span class="pre">NOT</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a></em><a class="headerlink" href="#apsw.fts5query.COLUMNFILTER.query" title="Link to this definition"></a></dt>
<dd><p>query the filter applies to, including all nested queries</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="apsw.fts5query.NEAR">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">apsw.fts5query.</span></span><span class="sig-name descname"><span class="pre">NEAR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phrases</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apsw/fts5query.html#NEAR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5query.NEAR" title="Link to this definition"></a></dt>
<dd><p><a class="reference external" href="https://www.sqlite.org/fts5.html#fts5_near_queries">Near query</a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5query.NEAR.distance">
<span class="sig-name descname"><span class="pre">distance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">10</span></em><a class="headerlink" href="#apsw.fts5query.NEAR.distance" title="Link to this definition"></a></dt>
<dd><p>Maximum distance between the phrases</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5query.NEAR.phrases">
<span class="sig-name descname"><span class="pre">phrases</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#apsw.fts5query.NEAR.phrases" title="Link to this definition"></a></dt>
<dd><p>Two or more phrases</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="apsw.fts5query.NOT">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">apsw.fts5query.</span></span><span class="sig-name descname"><span class="pre">NOT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">match</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><span class="pre">COLUMNFILTER</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NEAR" title="apsw.fts5query.NEAR"><span class="pre">NEAR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.AND" title="apsw.fts5query.AND"><span class="pre">AND</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.OR" title="apsw.fts5query.OR"><span class="pre">OR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NOT" title="apsw.fts5query.NOT"><span class="pre">NOT</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_match</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><span class="pre">COLUMNFILTER</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NEAR" title="apsw.fts5query.NEAR"><span class="pre">NEAR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.AND" title="apsw.fts5query.AND"><span class="pre">AND</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.OR" title="apsw.fts5query.OR"><span class="pre">OR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NOT" title="apsw.fts5query.NOT"><span class="pre">NOT</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apsw/fts5query.html#NOT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5query.NOT" title="Link to this definition"></a></dt>
<dd><p>match <a class="reference external" href="https://www.sqlite.org/fts5.html#fts5_boolean_operators">must match</a>, but no_match <a class="reference external" href="https://www.sqlite.org/fts5.html#fts5_boolean_operators">must not</a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5query.NOT.match">
<span class="sig-name descname"><span class="pre">match</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><span class="pre">COLUMNFILTER</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NEAR" title="apsw.fts5query.NEAR"><span class="pre">NEAR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.AND" title="apsw.fts5query.AND"><span class="pre">AND</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.OR" title="apsw.fts5query.OR"><span class="pre">OR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NOT" title="apsw.fts5query.NOT"><span class="pre">NOT</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a></em><a class="headerlink" href="#apsw.fts5query.NOT.match" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5query.NOT.no_match">
<span class="sig-name descname"><span class="pre">no_match</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><span class="pre">COLUMNFILTER</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NEAR" title="apsw.fts5query.NEAR"><span class="pre">NEAR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.AND" title="apsw.fts5query.AND"><span class="pre">AND</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.OR" title="apsw.fts5query.OR"><span class="pre">OR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NOT" title="apsw.fts5query.NOT"><span class="pre">NOT</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a></em><a class="headerlink" href="#apsw.fts5query.NOT.no_match" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="apsw.fts5query.OR">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">apsw.fts5query.</span></span><span class="sig-name descname"><span class="pre">OR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">queries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><span class="pre">COLUMNFILTER</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NEAR" title="apsw.fts5query.NEAR"><span class="pre">NEAR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.AND" title="apsw.fts5query.AND"><span class="pre">AND</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.OR" title="apsw.fts5query.OR"><span class="pre">OR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NOT" title="apsw.fts5query.NOT"><span class="pre">NOT</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apsw/fts5query.html#OR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5query.OR" title="Link to this definition"></a></dt>
<dd><p>Any query <a class="reference external" href="https://www.sqlite.org/fts5.html#fts5_boolean_operators">must match</a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5query.OR.queries">
<span class="sig-name descname"><span class="pre">queries</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><span class="pre">COLUMNFILTER</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NEAR" title="apsw.fts5query.NEAR"><span class="pre">NEAR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.AND" title="apsw.fts5query.AND"><span class="pre">AND</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.OR" title="apsw.fts5query.OR"><span class="pre">OR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NOT" title="apsw.fts5query.NOT"><span class="pre">NOT</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#apsw.fts5query.OR.queries" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="apsw.fts5query.PHRASE">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">apsw.fts5query.</span></span><span class="sig-name descname"><span class="pre">PHRASE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phrase</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.QueryTokens" title="apsw.fts5query.QueryTokens"><span class="pre">QueryTokens</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apsw/fts5query.html#PHRASE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5query.PHRASE" title="Link to this definition"></a></dt>
<dd><p>One <a class="reference external" href="https://www.sqlite.org/fts5.html#fts5_phrases">phrase</a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5query.PHRASE.initial">
<span class="sig-name descname"><span class="pre">initial</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#apsw.fts5query.PHRASE.initial" title="Link to this definition"></a></dt>
<dd><p>If True then the  phrase must match the beginning of a column (<code class="docutils literal notranslate"><span class="pre">^</span></code> was used)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5query.PHRASE.phrase">
<span class="sig-name descname"><span class="pre">phrase</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.QueryTokens" title="apsw.fts5query.QueryTokens"><span class="pre">QueryTokens</span></a></em><a class="headerlink" href="#apsw.fts5query.PHRASE.phrase" title="Link to this definition"></a></dt>
<dd><p>Text of the phrase.  If + was used (eg one+two) then it will be a list of phrases</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5query.PHRASE.plus">
<span class="sig-name descname"><span class="pre">plus</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#apsw.fts5query.PHRASE.plus" title="Link to this definition"></a></dt>
<dd><p>Additional phrase segment, joined by <code class="docutils literal notranslate"><span class="pre">+</span></code> in queries</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5query.PHRASE.prefix">
<span class="sig-name descname"><span class="pre">prefix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#apsw.fts5query.PHRASE.prefix" title="Link to this definition"></a></dt>
<dd><p>If True then if it is a prefix search on the last token in phrase (<code class="docutils literal notranslate"><span class="pre">*</span></code> was used)</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="apsw.fts5query.ParseError">
<em class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">apsw.fts5query.</span></span><span class="sig-name descname"><span class="pre">ParseError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apsw/fts5query.html#ParseError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5query.ParseError" title="Link to this definition"></a></dt>
<dd><p>This exception is raised when an error parsing a query string is encountered</p>
<p>A simple printer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">exc</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="s2">&quot;^&quot;</span><span class="p">,</span> <span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5query.ParseError.message">
<span class="sig-name descname"><span class="pre">message</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#apsw.fts5query.ParseError.message" title="Link to this definition"></a></dt>
<dd><p>Description of error</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5query.ParseError.position">
<span class="sig-name descname"><span class="pre">position</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#apsw.fts5query.ParseError.position" title="Link to this definition"></a></dt>
<dd><p>Offset in query where the error occurred</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5query.ParseError.query">
<span class="sig-name descname"><span class="pre">query</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#apsw.fts5query.ParseError.query" title="Link to this definition"></a></dt>
<dd><p>The query that was being processed</p>
</dd></dl>

</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="apsw.fts5query.QUERY">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5query.</span></span><span class="sig-name descname"><span class="pre">QUERY</span></span><a class="headerlink" href="#apsw.fts5query.QUERY" title="Link to this definition"></a></dt>
<dd><p>Type representing all query types.</p>
<p>alias of <a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><code class="xref py py-class docutils literal notranslate"><span class="pre">COLUMNFILTER</span></code></a> | <a class="reference internal" href="#apsw.fts5query.NEAR" title="apsw.fts5query.NEAR"><code class="xref py py-class docutils literal notranslate"><span class="pre">NEAR</span></code></a> | <a class="reference internal" href="#apsw.fts5query.AND" title="apsw.fts5query.AND"><code class="xref py py-class docutils literal notranslate"><span class="pre">AND</span></code></a> | <a class="reference internal" href="#apsw.fts5query.OR" title="apsw.fts5query.OR"><code class="xref py py-class docutils literal notranslate"><span class="pre">OR</span></code></a> | <a class="reference internal" href="#apsw.fts5query.NOT" title="apsw.fts5query.NOT"><code class="xref py py-class docutils literal notranslate"><span class="pre">NOT</span></code></a> | <a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><code class="xref py py-class docutils literal notranslate"><span class="pre">PHRASE</span></code></a></p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="apsw.fts5query.QUERY_TOKENS_MARKER">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5query.</span></span><span class="sig-name descname"><span class="pre">QUERY_TOKENS_MARKER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'$!Tokens~'</span></em><a class="headerlink" href="#apsw.fts5query.QUERY_TOKENS_MARKER" title="Link to this definition"></a></dt>
<dd><p>Special marker at the start of a string to recognise it as a list of tokens for <a class="reference internal" href="#apsw.fts5query.QueryTokens" title="apsw.fts5query.QueryTokens"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueryTokens</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="apsw.fts5query.QueryTokens">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">apsw.fts5query.</span></span><span class="sig-name descname"><span class="pre">QueryTokens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokens</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apsw/fts5query.html#QueryTokens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5query.QueryTokens" title="Link to this definition"></a></dt>
<dd><p><a class="reference external" href="https://www.sqlite.org/fts5.html#fts5_strings">FTS5 query strings</a> are
passed to <a class="reference external" href="https://www.sqlite.org/fts5.html#tokenizers">tokenizers</a> which extract
tokens, such as by splitting on whitespace, lower casing text, and
removing characters like accents.</p>
<p>If you want to query tokens directly then use this class with the
<a class="reference internal" href="#apsw.fts5query.QueryTokens.tokens" title="apsw.fts5query.QueryTokens.tokens"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tokens</span></code></a> member, using it where <a class="reference internal" href="#apsw.fts5query.PHRASE.phrase" title="apsw.fts5query.PHRASE.phrase"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PHRASE.phrase</span></code></a> goes
and use <a class="reference internal" href="#apsw.fts5query.to_query_string" title="apsw.fts5query.to_query_string"><code class="xref py py-func docutils literal notranslate"><span class="pre">to_query_string()</span></code></a> to compose your query.</p>
<p>Your FTS5 table must use the
<a class="reference internal" href="#apsw.fts5.QueryTokensTokenizer" title="apsw.fts5.QueryTokensTokenizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">apsw.fts5.QueryTokensTokenizer</span></code></a> as the first tokenizer in
the list.  If the reason for tokenizing includes
<cite>FTS5_TOKENIZE_QUERY</cite> and the text to be tokenized starts with the
special marker, then the tokens are returned.
<a class="reference internal" href="#apsw.fts5.Table.supports_query_tokens" title="apsw.fts5.Table.supports_query_tokens"><code class="xref py py-attr docutils literal notranslate"><span class="pre">apsw.fts5.Table.supports_query_tokens</span></code></a> will tell you if
query tokens are handled correctly.
<a class="reference internal" href="#apsw.fts5.Table.create" title="apsw.fts5.Table.create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apsw.fts5.Table.create()</span></code></a> parameter <code class="docutils literal notranslate"><span class="pre">support_query_tokens</span></code>
will ensure the <code class="docutils literal notranslate"><span class="pre">tokenize</span></code> table option is correctly set, You
can get the tokens from <a class="reference internal" href="#apsw.fts5.Table.tokens" title="apsw.fts5.Table.tokens"><code class="xref py py-attr docutils literal notranslate"><span class="pre">apsw.fts5.Table.tokens</span></code></a>.</p>
<p>You can construct QueryTokens like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># One token</span>
<span class="n">QueryTokens</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">])</span>
<span class="c1"># Token sequence</span>
<span class="n">QueryTokens</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="o">.</span> <span class="s2">&quot;world&quot;</span><span class="p">,</span> <span class="s2">&quot;today&quot;</span><span class="p">])</span>
<span class="c1"># Colocated tokens use a nested list</span>
<span class="n">QueryTokens</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;first&quot;</span><span class="p">,</span> <span class="s2">&quot;1st&quot;</span><span class="p">]])</span>
</pre></div>
</div>
<p>To use in a query:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;@&quot;</span><span class="p">:</span> <span class="s2">&quot;NOT&quot;</span><span class="p">,</span> <span class="s2">&quot;match&quot;</span><span class="p">:</span> <span class="n">QueryTokens</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">]),</span>
             <span class="s2">&quot;no_match&quot;</span><span class="p">:</span> <span class="n">QueryTokens</span><span class="p">([[</span><span class="s2">&quot;first&quot;</span><span class="p">,</span> <span class="s2">&quot;1st&quot;</span><span class="p">]])}</span>
</pre></div>
</div>
<p>That would be equivalent to a query of <code class="docutils literal notranslate"><span class="pre">&quot;Hello</span> <span class="pre">World&quot;</span> <span class="pre">NOT</span>
<span class="pre">&quot;First&quot;</span></code> if tokens were lower cased, and a tokenizer added a
colocated <code class="docutils literal notranslate"><span class="pre">1st</span></code> on seeing <code class="docutils literal notranslate"><span class="pre">first</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5query.QueryTokens.decode">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">decode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.13)"><span class="pre">bytes</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#apsw.fts5query.QueryTokens" title="apsw.fts5query.QueryTokens"><span class="pre">QueryTokens</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5query.html#QueryTokens.decode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5query.QueryTokens.decode" title="Link to this definition"></a></dt>
<dd><p>If the marker is present then returns the corresponding <a class="reference internal" href="#apsw.fts5query.QueryTokens" title="apsw.fts5query.QueryTokens"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueryTokens</span></code></a>, otherwise <cite>None</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.fts5query.QueryTokens.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5query.html#QueryTokens.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5query.QueryTokens.encode" title="Link to this definition"></a></dt>
<dd><p>Produces the tokens encoded with the marker and separator</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.fts5query.QueryTokens.tokens">
<span class="sig-name descname"><span class="pre">tokens</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#apsw.fts5query.QueryTokens.tokens" title="Link to this definition"></a></dt>
<dd><p>The tokens</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5query.applicable_columns">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5query.</span></span><span class="sig-name descname"><span class="pre">applicable_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><span class="pre">COLUMNFILTER</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NEAR" title="apsw.fts5query.NEAR"><span class="pre">NEAR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.AND" title="apsw.fts5query.AND"><span class="pre">AND</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.OR" title="apsw.fts5query.OR"><span class="pre">OR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NOT" title="apsw.fts5query.NOT"><span class="pre">NOT</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><span class="pre">COLUMNFILTER</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NEAR" title="apsw.fts5query.NEAR"><span class="pre">NEAR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.AND" title="apsw.fts5query.AND"><span class="pre">AND</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.OR" title="apsw.fts5query.OR"><span class="pre">OR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NOT" title="apsw.fts5query.NOT"><span class="pre">NOT</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.13)"><span class="pre">set</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/fts5query.html#applicable_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5query.applicable_columns" title="Link to this definition"></a></dt>
<dd><p>Return which columns apply to <code class="docutils literal notranslate"><span class="pre">node</span></code></p>
<p>You can use <a class="reference internal" href="#apsw.fts5.Table.columns_indexed" title="apsw.fts5.Table.columns_indexed"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apsw.fts5.Table.columns_indexed()</span></code></a> to get
the column list for a table.  The column names are matched using
SQLite semantics (ASCII case insensitive).</p>
<p>If a query column is not in the provided columns, then
<a class="reference external" href="https://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.13)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">KeyError</span></code></a> is raised.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5query.extract_with_column_filters">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5query.</span></span><span class="sig-name descname"><span class="pre">extract_with_column_filters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><span class="pre">COLUMNFILTER</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NEAR" title="apsw.fts5query.NEAR"><span class="pre">NEAR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.AND" title="apsw.fts5query.AND"><span class="pre">AND</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.OR" title="apsw.fts5query.OR"><span class="pre">OR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NOT" title="apsw.fts5query.NOT"><span class="pre">NOT</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><span class="pre">COLUMNFILTER</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NEAR" title="apsw.fts5query.NEAR"><span class="pre">NEAR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.AND" title="apsw.fts5query.AND"><span class="pre">AND</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.OR" title="apsw.fts5query.OR"><span class="pre">OR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NOT" title="apsw.fts5query.NOT"><span class="pre">NOT</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><span class="pre">COLUMNFILTER</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NEAR" title="apsw.fts5query.NEAR"><span class="pre">NEAR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.AND" title="apsw.fts5query.AND"><span class="pre">AND</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.OR" title="apsw.fts5query.OR"><span class="pre">OR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NOT" title="apsw.fts5query.NOT"><span class="pre">NOT</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5query.html#extract_with_column_filters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5query.extract_with_column_filters" title="Link to this definition"></a></dt>
<dd><p>Return a new <cite>QUERY</cite> for a query rooted at <cite>start</cite> with child <cite>node</cite>,
with intermediate <a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><code class="xref py py-class docutils literal notranslate"><span class="pre">COLUMNFILTER</span></code></a> in between applied.</p>
<p>This is useful if you want to execute a node from a top level
query ensuring the column filters apply.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5query.from_dict">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5query.</span></span><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.QueryTokens" title="apsw.fts5query.QueryTokens"><span class="pre">QueryTokens</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><span class="pre">COLUMNFILTER</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NEAR" title="apsw.fts5query.NEAR"><span class="pre">NEAR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.AND" title="apsw.fts5query.AND"><span class="pre">AND</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.OR" title="apsw.fts5query.OR"><span class="pre">OR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NOT" title="apsw.fts5query.NOT"><span class="pre">NOT</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5query.html#from_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5query.from_dict" title="Link to this definition"></a></dt>
<dd><p>Turns dict back into a <a class="reference internal" href="#apsw.fts5query.QUERY" title="apsw.fts5query.QUERY"><code class="xref py py-class docutils literal notranslate"><span class="pre">QUERY</span></code></a></p>
<p>You can take shortcuts putting <cite>str</cite>  or <a class="reference internal" href="#apsw.fts5query.QueryTokens" title="apsw.fts5query.QueryTokens"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueryTokens</span></code></a> in
places where PHRASE is expected.  For example this is accepted:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;@&quot;</span><span class="p">:</span> <span class="s2">&quot;AND,</span>
    <span class="s2">&quot;queries&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5query.parse_query_string">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5query.</span></span><span class="sig-name descname"><span class="pre">parse_query_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><span class="pre">COLUMNFILTER</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NEAR" title="apsw.fts5query.NEAR"><span class="pre">NEAR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.AND" title="apsw.fts5query.AND"><span class="pre">AND</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.OR" title="apsw.fts5query.OR"><span class="pre">OR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NOT" title="apsw.fts5query.NOT"><span class="pre">NOT</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5query.html#parse_query_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5query.parse_query_string" title="Link to this definition"></a></dt>
<dd><p>Returns the corresponding <a class="reference internal" href="#apsw.fts5query.QUERY" title="apsw.fts5query.QUERY"><code class="xref py py-class docutils literal notranslate"><span class="pre">QUERY</span></code></a> for the query string</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5query.quote">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5query.</span></span><span class="sig-name descname"><span class="pre">quote</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.QueryTokens" title="apsw.fts5query.QueryTokens"><span class="pre">QueryTokens</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5query.html#quote"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5query.quote" title="Link to this definition"></a></dt>
<dd><p>Quotes text if necessary to keep it as one unit using FTS5 quoting rules</p>
<p>Some examples:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>text</p></th>
<th class="head"><p>return</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hello</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hello</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">one</span> <span class="pre">two</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;one</span> <span class="pre">two&quot;</span></code></p></td>
</tr>
<tr class="row-even"><td><p>(empty string)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">one&quot;two</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;one&quot;&quot;two&quot;</span></code></p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5query.to_dict">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5query.</span></span><span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><span class="pre">COLUMNFILTER</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NEAR" title="apsw.fts5query.NEAR"><span class="pre">NEAR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.AND" title="apsw.fts5query.AND"><span class="pre">AND</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.OR" title="apsw.fts5query.OR"><span class="pre">OR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NOT" title="apsw.fts5query.NOT"><span class="pre">NOT</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/fts5query.html#to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5query.to_dict" title="Link to this definition"></a></dt>
<dd><p>Converts structure to a dict</p>
<p>This is useful for pretty printing, logging, saving as JSON,
modifying etc.</p>
<p>The dict has a key <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> with value corresponding to the dataclass
(eg <code class="docutils literal notranslate"><span class="pre">NEAR</span></code>, <code class="docutils literal notranslate"><span class="pre">PHRASE</span></code>, <code class="docutils literal notranslate"><span class="pre">AND</span></code>) and the same field names as the
corresponding dataclasses.  Only fields with non-default values
are emitted.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5query.to_query_string">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5query.</span></span><span class="sig-name descname"><span class="pre">to_query_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><span class="pre">COLUMNFILTER</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NEAR" title="apsw.fts5query.NEAR"><span class="pre">NEAR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.AND" title="apsw.fts5query.AND"><span class="pre">AND</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.OR" title="apsw.fts5query.OR"><span class="pre">OR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NOT" title="apsw.fts5query.NOT"><span class="pre">NOT</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5query.html#to_query_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5query.to_query_string" title="Link to this definition"></a></dt>
<dd><p>Returns the corresponding query in text format</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5query.walk">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5query.</span></span><span class="sig-name descname"><span class="pre">walk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><span class="pre">COLUMNFILTER</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NEAR" title="apsw.fts5query.NEAR"><span class="pre">NEAR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.AND" title="apsw.fts5query.AND"><span class="pre">AND</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.OR" title="apsw.fts5query.OR"><span class="pre">OR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NOT" title="apsw.fts5query.NOT"><span class="pre">NOT</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><span class="pre">COLUMNFILTER</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NEAR" title="apsw.fts5query.NEAR"><span class="pre">NEAR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.AND" title="apsw.fts5query.AND"><span class="pre">AND</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.OR" title="apsw.fts5query.OR"><span class="pre">OR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NOT" title="apsw.fts5query.NOT"><span class="pre">NOT</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.COLUMNFILTER" title="apsw.fts5query.COLUMNFILTER"><span class="pre">COLUMNFILTER</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NEAR" title="apsw.fts5query.NEAR"><span class="pre">NEAR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.AND" title="apsw.fts5query.AND"><span class="pre">AND</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.OR" title="apsw.fts5query.OR"><span class="pre">OR</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.NOT" title="apsw.fts5query.NOT"><span class="pre">NOT</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#apsw.fts5query.PHRASE" title="apsw.fts5query.PHRASE"><span class="pre">PHRASE</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/fts5query.html#walk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5query.walk" title="Link to this definition"></a></dt>
<dd><p>Yields the parents and each node for a query recursively</p>
<p>The query tree is traversed top down.  Use it like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">parents</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">walk</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
   <span class="c1"># parents will be a tuple of parent nodes</span>
   <span class="c1"># node will be current node</span>
   <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">PHRASE</span><span class="p">):</span>
       <span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">phrase</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-apsw.fts5aux">
<span id="fts5-auxiliary-functions-module"></span><h2><a class="toc-backref" href="#id23" role="doc-backlink">FTS5 Auxiliary functions module</a><a class="headerlink" href="#module-apsw.fts5aux" title="Link to this heading"></a></h2>
<p><a class="reference internal" href="#module-apsw.fts5aux" title="apsw.fts5aux: Auxiliary functions for ranking and match extraction"><code class="xref py py-mod docutils literal notranslate"><span class="pre">apsw.fts5aux</span></code></a> Implementation of FTS5 auxiliary functions in Python.</p>
<p>Auxiliary functions are used for ranking results, and for processing search
results.</p>
<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5aux.bm25">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5aux.</span></span><span class="sig-name descname"><span class="pre">bm25</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">api</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#apsw.FTS5ExtensionApi" title="apsw.FTS5ExtensionApi"><span class="pre">FTS5ExtensionApi</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="apsw.html#apsw.SQLiteValue" title="apsw.SQLiteValue"><span class="pre">SQLiteValue</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></span><a class="reference internal" href="_modules/apsw/fts5aux.html#bm25"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5aux.bm25" title="Link to this definition"></a></dt>
<dd><p>Perform the BM25 calculation for a matching row</p>
<p>It accepts weights for each column (default 1) which means how much
a hit in that column counts for.</p>
<p>The builtin function is <a class="reference external" href="https://www.sqlite.org/fts5.html#the_bm25_function">described here</a>.
This is a translation of the SQLite C version into Python
for illustrative purposes.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5aux.inverse_document_frequency">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5aux.</span></span><span class="sig-name descname"><span class="pre">inverse_document_frequency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">api</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#apsw.FTS5ExtensionApi" title="apsw.FTS5ExtensionApi"><span class="pre">FTS5ExtensionApi</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/fts5aux.html#inverse_document_frequency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5aux.inverse_document_frequency" title="Link to this definition"></a></dt>
<dd><p>Measures how rare each search phrase is in the content</p>
<p>This helper method is intended for use in your own ranking
functions.  The result is the idf for each phrase in the query.</p>
<p>A phrase occurring in almost every row will have a value close to
zero, while less frequent phrases have increasingly large positive
numbers.</p>
<p>The values will always be at least 0.000001 so you don’t have to
worry about negative numbers or division by zero, even for phrases
that are not found.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5aux.position_rank">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5aux.</span></span><span class="sig-name descname"><span class="pre">position_rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">api</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#apsw.FTS5ExtensionApi" title="apsw.FTS5ExtensionApi"><span class="pre">FTS5ExtensionApi</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="apsw.html#apsw.SQLiteValue" title="apsw.SQLiteValue"><span class="pre">SQLiteValue</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apsw/fts5aux.html#position_rank"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5aux.position_rank" title="Link to this definition"></a></dt>
<dd><p>Ranking function boosting the earlier in a column phrases are located</p>
<p><a class="reference internal" href="#apsw.fts5aux.bm25" title="apsw.fts5aux.bm25"><code class="xref py py-func docutils literal notranslate"><span class="pre">bm25()</span></code></a> doesn’t take into where phrases occur.  It makes no
difference if a phrase occurs at the beginning, middle, or end.
This boost takes into account how early the phrase match is,
suitable for content with more significant text towards the
beginning.</p>
<p>If the query has phrases and operators (AND, OR, NOT) then those
operators are not visible to this function, and only the location
of each phrase is taken into consideration.  See
<a class="reference internal" href="#apsw.fts5.QueryInfo.phrases" title="apsw.fts5.QueryInfo.phrases"><code class="xref py py-attr docutils literal notranslate"><span class="pre">apsw.fts5.QueryInfo.phrases</span></code></a>.</p>
<p>It accepts parameters giving the weights for each column (default 1).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.fts5aux.subsequence">
<span class="sig-prename descclassname"><span class="pre">apsw.fts5aux.</span></span><span class="sig-name descname"><span class="pre">subsequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">api</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#apsw.FTS5ExtensionApi" title="apsw.FTS5ExtensionApi"><span class="pre">FTS5ExtensionApi</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="apsw.html#apsw.SQLiteValue" title="apsw.SQLiteValue"><span class="pre">SQLiteValue</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apsw/fts5aux.html#subsequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.fts5aux.subsequence" title="Link to this definition"></a></dt>
<dd><p>Ranking function boosting rows where tokens are in order</p>
<p><a class="reference internal" href="#apsw.fts5aux.bm25" title="apsw.fts5aux.bm25"><code class="xref py py-func docutils literal notranslate"><span class="pre">bm25()</span></code></a> doesn’t take into account ordering.  Phrase matches
like <code class="docutils literal notranslate"><span class="pre">&quot;big</span> <span class="pre">truck&quot;</span></code> must occur exactly together in that order.
Matches for <code class="docutils literal notranslate"><span class="pre">big</span> <span class="pre">truck</span></code> scores the same providing both words
exist anywhere.  This function boosts matches where the order does
match so <code class="docutils literal notranslate"><span class="pre">big</span> <span class="pre">red</span> <span class="pre">truck</span></code> gets a boost while <code class="docutils literal notranslate"><span class="pre">truck,</span> <span class="pre">big</span></code> does
not for the same query.</p>
<p>If the query has phrases and operators (AND, OR, NOT) then those
operators are not visible to this function, and it looks for
ordering of each phrase.  For example <code class="docutils literal notranslate"><span class="pre">big</span> <span class="pre">OR</span> <span class="pre">truck</span> <span class="pre">NOT</span> <span class="pre">red</span></code>
will result in this function boosting <code class="docutils literal notranslate"><span class="pre">big</span> <span class="pre">...</span> <span class="pre">truck</span> <span class="pre">...</span> <span class="pre">red</span></code> in
that order.  See <a class="reference internal" href="#apsw.fts5.QueryInfo.phrases" title="apsw.fts5.QueryInfo.phrases"><code class="xref py py-attr docutils literal notranslate"><span class="pre">apsw.fts5.QueryInfo.phrases</span></code></a>.</p>
<p>It accepts parameters giving the weights for each column (default 1).</p>
</dd></dl>

</section>
<section id="fts5tokenizer-class">
<h2><a class="toc-backref" href="#id24" role="doc-backlink">FTS5Tokenizer class</a><a class="headerlink" href="#fts5tokenizer-class" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="apsw.FTS5Tokenizer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">apsw.</span></span><span class="sig-name descname"><span class="pre">FTS5Tokenizer</span></span><a class="headerlink" href="#apsw.FTS5Tokenizer" title="Link to this definition"></a></dt>
<dd><p>Wraps a registered tokenizer.  Returned by <a class="reference internal" href="connection.html#apsw.Connection.fts5_tokenizer" title="apsw.Connection.fts5_tokenizer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.fts5_tokenizer()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.FTS5Tokenizer.__call__">
<span class="sig-prename descclassname"><span class="pre">FTS5Tokenizer.</span></span><span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">utf8</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Buffer" title="(in Python v3.13)"><span class="pre">Buffer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">locale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_offsets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_colocated</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="apsw.html#apsw.TokenizerResult" title="apsw.TokenizerResult"><span class="pre">TokenizerResult</span></a></span></span><a class="headerlink" href="#apsw.FTS5Tokenizer.__call__" title="Link to this definition"></a></dt>
<dd><p>Does a tokenization, returning a list of the results.  If you have no
interest in token offsets or colocated tokens then they can be omitted from
the results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>utf8</strong> – Input buffer</p></li>
<li><p><strong>reason</strong> – <a class="reference internal" href="apsw.html#apsw.mapping_fts5_tokenize_reason" title="apsw.mapping_fts5_tokenize_reason"><code class="xref py py-data docutils literal notranslate"><span class="pre">Reason</span></code></a> flag</p></li>
<li><p><strong>include_offsets</strong> – Returned list includes offsets into utf8 for each token</p></li>
<li><p><strong>include_colocated</strong> – Returned list can include colocated tokens</p></li>
</ul>
</dd>
</dl>
<section id="example-outputs">
<h3>Example outputs<a class="headerlink" href="#example-outputs" title="Link to this heading"></a></h3>
<p>Tokenizing <code class="docutils literal notranslate"><span class="pre">b&quot;first</span> <span class="pre">place&quot;</span></code> where <code class="docutils literal notranslate"><span class="pre">1st</span></code> has been provided as a
colocated token for <code class="docutils literal notranslate"><span class="pre">first</span></code>.</p>
<p>(<strong>Default</strong>) include_offsets <strong>True</strong>, include_colocated <strong>True</strong></p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;first&quot;</span><span class="p">,</span> <span class="s2">&quot;1st&quot;</span><span class="p">),</span>
  <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="s2">&quot;place&quot;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
</div></blockquote>
<p>include_offsets <strong>False</strong>, include_colocated <strong>True</strong></p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
  <span class="p">(</span><span class="s2">&quot;first&quot;</span><span class="p">,</span> <span class="s2">&quot;1st&quot;</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;place&quot;</span><span class="p">,</span> <span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
</div></blockquote>
<p>include_offsets <strong>True</strong>, include_colocated <strong>False</strong></p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;first&quot;</span><span class="p">),</span>
  <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="s2">&quot;place&quot;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
</div></blockquote>
<p>include_offsets <strong>False</strong>, include_colocated <strong>False</strong></p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
  <span class="s2">&quot;first&quot;</span><span class="p">,</span>
  <span class="s2">&quot;place&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div></blockquote>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.FTS5Tokenizer.args">
<span class="sig-prename descclassname"><span class="pre">FTS5Tokenizer.</span></span><span class="sig-name descname"><span class="pre">args</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#apsw.FTS5Tokenizer.args" title="Link to this definition"></a></dt>
<dd><p>The arguments the tokenizer was created with.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.FTS5Tokenizer.connection">
<span class="sig-prename descclassname"><span class="pre">FTS5Tokenizer.</span></span><span class="sig-name descname"><span class="pre">connection</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="connection.html#apsw.Connection" title="apsw.Connection"><span class="pre">Connection</span></a></em><a class="headerlink" href="#apsw.FTS5Tokenizer.connection" title="Link to this definition"></a></dt>
<dd><p>The <a class="reference internal" href="connection.html#apsw.Connection" title="apsw.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> this tokenizer is registered with.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.FTS5Tokenizer.name">
<span class="sig-prename descclassname"><span class="pre">FTS5Tokenizer.</span></span><span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#apsw.FTS5Tokenizer.name" title="Link to this definition"></a></dt>
<dd><p>Tokenizer name</p>
</dd></dl>

</section>
<section id="fts5extensionapi-class">
<h2><a class="toc-backref" href="#id25" role="doc-backlink">FTS5ExtensionApi class</a><a class="headerlink" href="#fts5extensionapi-class" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="apsw.FTS5ExtensionApi">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">apsw.</span></span><span class="sig-name descname"><span class="pre">FTS5ExtensionApi</span></span><a class="headerlink" href="#apsw.FTS5ExtensionApi" title="Link to this definition"></a></dt>
<dd></dd></dl>

<p><a class="reference external" href="https://www.sqlite.org/fts5.html#_auxiliary_functions_">Auxiliary functions</a>  run in
the context of a FTS5 search, and can be used for ranking,
highlighting, and similar operations.  Auxiliary functions are
registered via <a class="reference internal" href="connection.html#apsw.Connection.register_fts5_function" title="apsw.Connection.register_fts5_function"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.register_fts5_function()</span></code></a>.  This wraps
the <a class="reference external" href="https://www.sqlite.org/fts5.html#custom_auxiliary_functions">auxiliary functions API</a>
passed as the first parameter to auxiliary functions.</p>
<p>See <a class="reference internal" href="example-fts.html#example-fts5-auxfunc"><span class="std std-ref">the example</span></a>.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.FTS5ExtensionApi.aux_data">
<span class="sig-prename descclassname"><span class="pre">FTS5ExtensionApi.</span></span><span class="sig-name descname"><span class="pre">aux_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#apsw.FTS5ExtensionApi.aux_data" title="Link to this definition"></a></dt>
<dd><p>You can store an object as <a class="reference external" href="https://www.sqlite.org/fts5.html#xSetAuxdata">auxiliary data</a>
which is available across matching rows.  It starts out as <code class="xref py py-class docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>An example use is to do up front calculations once, rather than on
every matched row, such as
<a class="reference internal" href="#apsw.fts5aux.inverse_document_frequency" title="apsw.fts5aux.inverse_document_frequency"><code class="xref py py-func docutils literal notranslate"><span class="pre">fts5aux.inverse_document_frequency()</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.FTS5ExtensionApi.column_count">
<span class="sig-prename descclassname"><span class="pre">FTS5ExtensionApi.</span></span><span class="sig-name descname"><span class="pre">column_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#apsw.FTS5ExtensionApi.column_count" title="Link to this definition"></a></dt>
<dd><p>Returns the <a class="reference external" href="https://www.sqlite.org/fts5.html#xColumnCount">number of columns in the table</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.FTS5ExtensionApi.column_locale">
<span class="sig-prename descclassname"><span class="pre">FTS5ExtensionApi.</span></span><span class="sig-name descname"><span class="pre">column_locale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#apsw.FTS5ExtensionApi.column_locale" title="Link to this definition"></a></dt>
<dd><p><a class="reference external" href="https://www.sqlite.org/fts5.html#xColumnLocale">Retrieves the locale for a column</a> on
this row.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.FTS5ExtensionApi.column_size">
<span class="sig-prename descclassname"><span class="pre">FTS5ExtensionApi.</span></span><span class="sig-name descname"><span class="pre">column_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span><a class="headerlink" href="#apsw.FTS5ExtensionApi.column_size" title="Link to this definition"></a></dt>
<dd><p>Returns the <a class="reference external" href="https://www.sqlite.org/fts5.html#xColumnSize">total number of tokens in the current row</a> for a specific
column, or if <code class="docutils literal notranslate"><span class="pre">col</span></code> is negative then for all columns.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.FTS5ExtensionApi.column_text">
<span class="sig-prename descclassname"><span class="pre">FTS5ExtensionApi.</span></span><span class="sig-name descname"><span class="pre">column_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.13)"><span class="pre">bytes</span></a></span></span><a class="headerlink" href="#apsw.FTS5ExtensionApi.column_text" title="Link to this definition"></a></dt>
<dd><p>Returns the <a class="reference external" href="https://www.sqlite.org/fts5.html#xColumnText">utf8 bytes for the column of the current row</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.FTS5ExtensionApi.column_total_size">
<span class="sig-prename descclassname"><span class="pre">FTS5ExtensionApi.</span></span><span class="sig-name descname"><span class="pre">column_total_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span><a class="headerlink" href="#apsw.FTS5ExtensionApi.column_total_size" title="Link to this definition"></a></dt>
<dd><p>Returns the <a class="reference external" href="https://www.sqlite.org/fts5.html#xColumnTotalSize">total number of tokens in the table</a> for a specific
column, or if <code class="docutils literal notranslate"><span class="pre">col</span></code> is negative then for all columns.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.FTS5ExtensionApi.inst_count">
<span class="sig-prename descclassname"><span class="pre">FTS5ExtensionApi.</span></span><span class="sig-name descname"><span class="pre">inst_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#apsw.FTS5ExtensionApi.inst_count" title="Link to this definition"></a></dt>
<dd><p>Returns the <a class="reference external" href="https://www.sqlite.org/fts5.html#xInstCount">number of hits in the current row</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.FTS5ExtensionApi.inst_tokens">
<span class="sig-prename descclassname"><span class="pre">FTS5ExtensionApi.</span></span><span class="sig-name descname"><span class="pre">inst_tokens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inst</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#apsw.FTS5ExtensionApi.inst_tokens" title="Link to this definition"></a></dt>
<dd><p><a class="reference external" href="https://www.sqlite.org/fts5.html#xInstToken">Access tokens of hit inst in current row</a>.
None is returned if the call is not supported.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.FTS5ExtensionApi.phrase_column_offsets">
<span class="sig-prename descclassname"><span class="pre">FTS5ExtensionApi.</span></span><span class="sig-name descname"><span class="pre">phrase_column_offsets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phrase</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#apsw.FTS5ExtensionApi.phrase_column_offsets" title="Link to this definition"></a></dt>
<dd><p>Returns <a class="reference external" href="https://www.sqlite.org/fts5.html#xPhraseFirst">token offsets the phrase number occurs in</a>  in the specified
column.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.FTS5ExtensionApi.phrase_columns">
<span class="sig-prename descclassname"><span class="pre">FTS5ExtensionApi.</span></span><span class="sig-name descname"><span class="pre">phrase_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phrase</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#apsw.FTS5ExtensionApi.phrase_columns" title="Link to this definition"></a></dt>
<dd><p>Returns <a class="reference external" href="https://www.sqlite.org/fts5.html#xPhraseFirstColumn">which columns the phrase number occurs in</a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.FTS5ExtensionApi.phrase_count">
<span class="sig-prename descclassname"><span class="pre">FTS5ExtensionApi.</span></span><span class="sig-name descname"><span class="pre">phrase_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#apsw.FTS5ExtensionApi.phrase_count" title="Link to this definition"></a></dt>
<dd><p>Returns the <a class="reference external" href="https://www.sqlite.org/fts5.html#xPhraseCount">number of phrases in the query</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.FTS5ExtensionApi.phrase_locations">
<span class="sig-prename descclassname"><span class="pre">FTS5ExtensionApi.</span></span><span class="sig-name descname"><span class="pre">phrase_locations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phrase</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#apsw.FTS5ExtensionApi.phrase_locations" title="Link to this definition"></a></dt>
<dd><p>Returns <a class="reference external" href="https://www.sqlite.org/fts5.html#xPhraseFirst">which columns and token offsets  the phrase number occurs in</a>.</p>
<p>The returned list is the same length as the number of columns.  Each
member is a list of token offsets in that column, and will be empty
if the phrase is not in that column.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.FTS5ExtensionApi.phrases">
<span class="sig-prename descclassname"><span class="pre">FTS5ExtensionApi.</span></span><span class="sig-name descname"><span class="pre">phrases</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#apsw.FTS5ExtensionApi.phrases" title="Link to this definition"></a></dt>
<dd><p>A tuple where each member is a phrase from the query.  Each phrase is a tuple
of str (or None when not available) per token of the phrase.</p>
<p>This combines the results of <a class="reference external" href="https://www.sqlite.org/fts5.html#xPhraseCount">xPhraseCount</a>,
<a class="reference external" href="https://www.sqlite.org/fts5.html#xPhraseSize">xPhraseSize</a> and
<a class="reference external" href="https://www.sqlite.org/fts5.html#xQueryToken">xQueryToken</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.FTS5ExtensionApi.query_phrase">
<span class="sig-prename descclassname"><span class="pre">FTS5ExtensionApi.</span></span><span class="sig-name descname"><span class="pre">query_phrase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phrase</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="apsw.html#apsw.FTS5QueryPhrase" title="apsw.FTS5QueryPhrase"><span class="pre">FTS5QueryPhrase</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">closure</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#apsw.FTS5ExtensionApi.query_phrase" title="Link to this definition"></a></dt>
<dd><p>Searches the table for the <a class="reference external" href="https://www.sqlite.org/fts5.html#xQueryPhrase">numbered query</a>.
The callback takes two parameters - a different <a class="reference internal" href="#apsw.FTS5ExtensionApi" title="apsw.FTS5ExtensionApi"><code class="xref py py-class docutils literal notranslate"><span class="pre">apsw.FTS5ExtensionApi</span></code></a> and closure.</p>
<p>An example usage for this method is to see how often the phrases occur in the table.  Setup a
tracking counter here, and then in the callback you can update it on each visited row.  This
is shown in <a class="reference internal" href="example-fts.html#example-fts5-auxfunc"><span class="std std-ref">the example</span></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.FTS5ExtensionApi.row_count">
<span class="sig-prename descclassname"><span class="pre">FTS5ExtensionApi.</span></span><span class="sig-name descname"><span class="pre">row_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#apsw.FTS5ExtensionApi.row_count" title="Link to this definition"></a></dt>
<dd><p>Returns the <a class="reference external" href="https://www.sqlite.org/fts5.html#xRowCount">number of rows in the table</a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="apsw.FTS5ExtensionApi.rowid">
<span class="sig-prename descclassname"><span class="pre">FTS5ExtensionApi.</span></span><span class="sig-name descname"><span class="pre">rowid</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#apsw.FTS5ExtensionApi.rowid" title="Link to this definition"></a></dt>
<dd><p>Rowid of the <a class="reference external" href="https://www.sqlite.org/fts5.html#xGetAuxdata">current row</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apsw.FTS5ExtensionApi.tokenize">
<span class="sig-prename descclassname"><span class="pre">FTS5ExtensionApi.</span></span><span class="sig-name descname"><span class="pre">tokenize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">utf8</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Buffer" title="(in Python v3.13)"><span class="pre">Buffer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">locale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_offsets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_colocated</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a></span></span><a class="headerlink" href="#apsw.FTS5ExtensionApi.tokenize" title="Link to this definition"></a></dt>
<dd><p><a class="reference external" href="https://www.sqlite.org/fts5.html#xTokenize_v2">Tokenizes the utf8</a>.  FTS5 sets the reason to <code class="docutils literal notranslate"><span class="pre">FTS5_TOKENIZE_AUX</span></code>.
See <a class="reference internal" href="#apsw.FTS5Tokenizer.__call__" title="apsw.FTS5Tokenizer.__call__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apsw.FTS5Tokenizer.__call__()</span></code></a> for details.</p>
</dd></dl>

</section>
<section id="module-apsw.unicode">
<span id="unicode-text-handling"></span><h2><a class="toc-backref" href="#id26" role="doc-backlink">Unicode Text Handling</a><a class="headerlink" href="#module-apsw.unicode" title="Link to this heading"></a></h2>
<p><a class="reference internal" href="#module-apsw.unicode" title="apsw.unicode"><code class="xref py py-mod docutils literal notranslate"><span class="pre">apsw.unicode</span></code></a> - Up to date Unicode aware methods and lookups</p>
<p>This module helps with <a class="reference internal" href="#"><span class="doc">Full text search</span></a> and general Unicode,
addressing the following:</p>
<ul class="simple">
<li><p>The standard library <a class="reference external" href="https://docs.python.org/3/library/unicodedata.html#module-unicodedata" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unicodedata</span></code></a> has limited information
available (eg no information about emoji), and is only updated to
new <a class="reference external" href="https://www.unicode.org/versions/enumeratedversions.html">Unicode versions</a> on a
new Python version.</p></li>
<li><p>Multiple consecutive codepoints can combine into a single user
perceived character (grapheme cluster), such as combining accents,
vowels and marks in some writing systems, variant selectors, joiners
and linkers, etc.  That means you can’t use indexes into
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> safely without potentially breaking them.</p></li>
<li><p>The standard library provides no help in splitting text into
grapheme clusters, words, and sentences, or into breaking text into
multiple lines.</p></li>
<li><p>Text processing is performance sensitive - FTS5 easily handles
hundreds of megabytes to gigabytes of text, and so should this
module.  It also affects the latency of each query as that is
tokenized, and results can highlight words and sentences.</p></li>
</ul>
<p>This module is independent of the main apsw module, and loading it
does not load any database functionality.  The majority of the
functionality is implemented in C for size and performance reasons.</p>
<p>See <a class="reference internal" href="#apsw.unicode.unicode_version" title="apsw.unicode.unicode_version"><code class="xref py py-data docutils literal notranslate"><span class="pre">unicode_version</span></code></a> for the implemented version.</p>
<p>Grapheme cluster, word, and sentence splitting</p>
<blockquote>
<div><p><a class="reference external" href="https://www.unicode.org/reports/tr29/">Unicode Technical Report #29</a> rules for finding
grapheme clusters, words, and sentences are implemented.  Tr29
specifies break points which can be found via
<a class="reference internal" href="#apsw.unicode.grapheme_next_break" title="apsw.unicode.grapheme_next_break"><code class="xref py py-func docutils literal notranslate"><span class="pre">grapheme_next_break()</span></code></a>, <a class="reference internal" href="#apsw.unicode.word_next_break" title="apsw.unicode.word_next_break"><code class="xref py py-func docutils literal notranslate"><span class="pre">word_next_break()</span></code></a>, and
<a class="reference internal" href="#apsw.unicode.sentence_next_break" title="apsw.unicode.sentence_next_break"><code class="xref py py-func docutils literal notranslate"><span class="pre">sentence_next_break()</span></code></a>.</p>
<p>Building on those are iterators providing optional offsets and the
text.  This is used for tokenization (getting character and word
boundaries correct), and for result highlighting (showing
words/sentences before and after match).</p>
</div></blockquote>
<p>Line break splitting</p>
<blockquote>
<div><p><a class="reference external" href="https://www.unicode.org/reports/tr14/">Unicode Technical Report #14</a> rules for finding where
text cam be broken and resumed on the next line.  Tr14 specifies
break points which can be found via <a class="reference internal" href="#apsw.unicode.line_break_next_break" title="apsw.unicode.line_break_next_break"><code class="xref py py-func docutils literal notranslate"><span class="pre">line_break_next_break()</span></code></a>.</p>
<p>Building on those are iterators providing optional offsets and the
text.  This is used for <a class="reference internal" href="#apsw.unicode.text_wrap" title="apsw.unicode.text_wrap"><code class="xref py py-func docutils literal notranslate"><span class="pre">text_wrap()</span></code></a>.</p>
</div></blockquote>
<p>Unicode lookups</p>
<blockquote>
<div><ul class="simple">
<li><p>Category information <a class="reference internal" href="#apsw.unicode.category" title="apsw.unicode.category"><code class="xref py py-func docutils literal notranslate"><span class="pre">category()</span></code></a></p></li>
<li><p>Is an emoji or similar <a class="reference internal" href="#apsw.unicode.is_extended_pictographic" title="apsw.unicode.is_extended_pictographic"><code class="xref py py-func docutils literal notranslate"><span class="pre">is_extended_pictographic()</span></code></a></p></li>
<li><p>Flag characters <a class="reference internal" href="#apsw.unicode.is_regional_indicator" title="apsw.unicode.is_regional_indicator"><code class="xref py py-func docutils literal notranslate"><span class="pre">is_regional_indicator()</span></code></a></p></li>
<li><p>Codepoint names <a class="reference internal" href="#apsw.unicode.codepoint_name" title="apsw.unicode.codepoint_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">codepoint_name()</span></code></a></p></li>
</ul>
</div></blockquote>
<p>Case folding, accent removal</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#apsw.unicode.casefold" title="apsw.unicode.casefold"><code class="xref py py-func docutils literal notranslate"><span class="pre">casefold()</span></code></a> is used to do case insensitive comparisons.</p></li>
<li><p><a class="reference internal" href="#apsw.unicode.strip" title="apsw.unicode.strip"><code class="xref py py-func docutils literal notranslate"><span class="pre">strip()</span></code></a> is used to remove accents, marks, punctuation,
joiners etc</p></li>
</ul>
</div></blockquote>
<p>Helpers</p>
<p>These are aware of grapheme cluster boundaries which Python’s builtin
string operations are not.  The text width functions take into account
how wide the text is when displayed on most terminals.</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#apsw.unicode.grapheme_length" title="apsw.unicode.grapheme_length"><code class="xref py py-func docutils literal notranslate"><span class="pre">grapheme_length()</span></code></a> to get the number of grapheme clusters
in a string</p></li>
<li><p><a class="reference internal" href="#apsw.unicode.grapheme_substr" title="apsw.unicode.grapheme_substr"><code class="xref py py-func docutils literal notranslate"><span class="pre">grapheme_substr()</span></code></a> to get substrings using grapheme cluster
indexing</p></li>
<li><p><a class="reference internal" href="#apsw.unicode.grapheme_startswith" title="apsw.unicode.grapheme_startswith"><code class="xref py py-func docutils literal notranslate"><span class="pre">grapheme_startswith()</span></code></a> and <a class="reference internal" href="#apsw.unicode.grapheme_endswith" title="apsw.unicode.grapheme_endswith"><code class="xref py py-func docutils literal notranslate"><span class="pre">grapheme_endswith()</span></code></a></p></li>
<li><p><a class="reference internal" href="#apsw.unicode.grapheme_find" title="apsw.unicode.grapheme_find"><code class="xref py py-func docutils literal notranslate"><span class="pre">grapheme_find()</span></code></a> to find a substring</p></li>
<li><p><a class="reference internal" href="#apsw.unicode.split_lines" title="apsw.unicode.split_lines"><code class="xref py py-func docutils literal notranslate"><span class="pre">split_lines()</span></code></a> to split text into lines using all the
Unicode hard line break codepoints</p></li>
<li><p><a class="reference internal" href="#apsw.unicode.text_width" title="apsw.unicode.text_width"><code class="xref py py-func docutils literal notranslate"><span class="pre">text_width()</span></code></a> to count how wide the text is</p></li>
<li><p><a class="reference internal" href="#apsw.unicode.expand_tabs" title="apsw.unicode.expand_tabs"><code class="xref py py-func docutils literal notranslate"><span class="pre">expand_tabs()</span></code></a> to expand tabs using text width</p></li>
<li><p><a class="reference internal" href="#apsw.unicode.text_width_substr" title="apsw.unicode.text_width_substr"><code class="xref py py-func docutils literal notranslate"><span class="pre">text_width_substr()</span></code></a> to extract substrings based on text width</p></li>
<li><p><a class="reference internal" href="#apsw.unicode.text_wrap" title="apsw.unicode.text_wrap"><code class="xref py py-func docutils literal notranslate"><span class="pre">text_wrap()</span></code></a> to wrap paragraphs using Unicode words, line
breaking, and text width</p></li>
<li><p><a class="reference internal" href="#apsw.unicode.guess_paragraphs" title="apsw.unicode.guess_paragraphs"><code class="xref py py-func docutils literal notranslate"><span class="pre">guess_paragraphs()</span></code></a> to establish paragraph boundaries for
text that has line breaks in paragraphs like many plain text
and similar markup formats.</p></li>
</ul>
</div></blockquote>
<p>Size</p>
<blockquote>
<div><p>Using the <a class="reference external" href="https://icu.unicode.org/">ICU</a> <a class="reference external" href="https://pypi.org/project/PyICU/">extension</a> is 5MB of code that then
links to shared libraries containing another 5MB of code, and 30MB
of data.  This module is 0.5MB, 5 to 50% faster, and has no
dependencies.  (ICU includes numerous extra customisations,
formatting, locale helpers etc.)</p>
</div></blockquote>
<p>Performance</p>
<blockquote>
<div><p>There some pure Python alternatives, with less functionality.
They take 5 to 15 times more CPU time to process the same text.
Use <code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">-m</span> <span class="pre">apsw.unicode</span> <span class="pre">benchmark</span> <span class="pre">--help</span></code>.</p>
</div></blockquote>
<dl class="py data">
<dt class="sig sig-object py" id="apsw.unicode.unicode_version">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">unicode_version</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'16.0'</span></em><a class="headerlink" href="#apsw.unicode.unicode_version" title="Link to this definition"></a></dt>
<dd><p>The <a class="reference external" href="https://www.unicode.org/versions/enumeratedversions.html">Unicode version</a>
that the rules and data tables implement</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.category">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">category</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">codepoint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/apsw/unicode.html#category"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.category" title="Link to this definition"></a></dt>
<dd><p>Returns the <a class="reference external" href="https://en.wikipedia.org/wiki/Unicode_character_property#General_Category">general category</a> - eg <code class="docutils literal notranslate"><span class="pre">Lu</span></code> for Letter Uppercase</p>
<p>See <a class="reference internal" href="#apsw.fts5.unicode_categories" title="apsw.fts5.unicode_categories"><code class="xref py py-data docutils literal notranslate"><span class="pre">apsw.fts5.unicode_categories</span></code></a> for descriptions mapping</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.is_extended_pictographic">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">is_extended_pictographic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><a class="reference internal" href="_modules/apsw/unicode.html#is_extended_pictographic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.is_extended_pictographic" title="Link to this definition"></a></dt>
<dd><p>Returns True if any of the text has the extended pictographic property (Emoji and similar)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.is_regional_indicator">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">is_regional_indicator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><a class="reference internal" href="_modules/apsw/unicode.html#is_regional_indicator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.is_regional_indicator" title="Link to this definition"></a></dt>
<dd><p>Returns True if any of the text is one of the 26 <a class="reference external" href="https://en.wikipedia.org/wiki/Regional_indicator_symbol">regional indicators</a> used in pairs to represent country flags</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.casefold">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">casefold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/apsw/unicode.html#casefold"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.casefold" title="Link to this definition"></a></dt>
<dd><p>Returns the text for equality comparison without case distinction</p>
<p>Case folding maps text to a canonical form where case differences
are removed allowing case insensitive comparison.  Unlike upper,
lower, and title case, the result is not intended to be displayed
to people.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.strip">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">strip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/apsw/unicode.html#strip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.strip" title="Link to this definition"></a></dt>
<dd><p>Returns the text for less exact comparison with accents, punctuation, marks etc removed</p>
<p>It will strip diacritics leaving the underlying characters so <code class="docutils literal notranslate"><span class="pre">áççéñțś</span></code> becomes <code class="docutils literal notranslate"><span class="pre">accents</span></code>,
punctuation so <code class="docutils literal notranslate"><span class="pre">e.g.</span></code> becomes <code class="docutils literal notranslate"><span class="pre">eg</span></code> and <code class="docutils literal notranslate"><span class="pre">don't</span></code> becomes <code class="docutils literal notranslate"><span class="pre">dont</span></code>,  marks so <code class="docutils literal notranslate"><span class="pre">देवनागरी</span></code>
becomes <code class="docutils literal notranslate"><span class="pre">दवनगर</span></code>, as well as all spacing, formatting, <a class="reference external" href="https://en.wikipedia.org/wiki/Variation_Selectors_%28Unicode_block%29">variation selectors</a> and similar codepoints.</p>
<p>Codepoints are also converted to their compatibility representation.  For example
the single codepoint Roman numeral <code class="docutils literal notranslate"><span class="pre">Ⅲ</span></code> becomes <code class="docutils literal notranslate"><span class="pre">III</span></code> (three separate regular upper case <cite>I</cite>),
and <code class="docutils literal notranslate"><span class="pre">🄷🄴🄻🄻🄾</span></code> becomes <code class="docutils literal notranslate"><span class="pre">HELLO</span></code>.</p>
<p>The resulting text should not be shown to people, and is intended for doing relaxed equality
comparisons, at the expense of false positives when the accents, marks, punctuation etc were
intended.</p>
<p>You should do <a class="reference internal" href="#apsw.unicode.casefold" title="apsw.unicode.casefold"><code class="xref py py-func docutils literal notranslate"><span class="pre">case</span> <span class="pre">folding</span></code></a> after this.</p>
<p>Emoji are preserved but variation selectors, <a class="reference external" href="https://en.wikipedia.org/wiki/Emoji#Skin_color">fitzpatrick</a>
and <a class="reference external" href="https://en.wikipedia.org/wiki/Zero-width_joiner">joiners</a> are stripped.</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Regional_indicator_symbol">Regional indicators</a> are preserved.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.split_lines">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">split_lines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/unicode.html#split_lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.split_lines" title="Link to this definition"></a></dt>
<dd><p>Each line, using hard line break rules</p>
<p>This is a iterator yielding a line at a time.  The end of line
yielded will not include the hard line break characters.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.expand_tabs">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">expand_tabs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tabsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invalid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'.'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/apsw/unicode.html#expand_tabs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.expand_tabs" title="Link to this definition"></a></dt>
<dd><p>Turns tabs into spaces aligning on tabsize boundaries, similar to <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str.expandtabs" title="(in Python v3.13)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">str.expandtabs()</span></code></a></p>
<p>This is aware of grapheme clusters and text width.  Codepoints
that have an invalid width are also replaced by <code class="docutils literal notranslate"><span class="pre">invalid</span></code>.
Control characters are an example of an invalid character.  Line
breaks are replaced with newline.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.grapheme_length">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">grapheme_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span><a class="reference internal" href="_modules/apsw/unicode.html#grapheme_length"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.grapheme_length" title="Link to this definition"></a></dt>
<dd><p>Returns number of grapheme clusters in the text.  Unicode aware version of len</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.grapheme_substr">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">grapheme_substr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/apsw/unicode.html#grapheme_substr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.grapheme_substr" title="Link to this definition"></a></dt>
<dd><p>Like <code class="docutils literal notranslate"><span class="pre">text[start:end]</span></code> but in grapheme cluster units</p>
<p><code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">end</span></code> can be negative to index from the end, or
outside the bounds of the text but are never an invalid
combination (you get empty string returned).</p>
<p>To get one grapheme cluster, make stop one more than start.
For example to get the 3rd last grapheme cluster:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grapheme_substr</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.grapheme_endswith">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">grapheme_endswith</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">substring</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><a class="reference internal" href="_modules/apsw/unicode.html#grapheme_endswith"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.grapheme_endswith" title="Link to this definition"></a></dt>
<dd><p>Returns True if <cite>text</cite> ends with <cite>substring</cite> being aware of grapheme cluster boundaries</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.grapheme_startswith">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">grapheme_startswith</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">substring</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><a class="reference internal" href="_modules/apsw/unicode.html#grapheme_startswith"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.grapheme_startswith" title="Link to this definition"></a></dt>
<dd><p>Returns True if <cite>text</cite> starts with <cite>substring</cite> being aware of grapheme cluster boundaries</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.grapheme_find">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">grapheme_find</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">substring</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span><a class="reference internal" href="_modules/apsw/unicode.html#grapheme_find"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.grapheme_find" title="Link to this definition"></a></dt>
<dd><p>Returns the offset in text where substring can be found, being aware of grapheme clusters.
The start and end of the substring have to be at a grapheme cluster boundary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> – Where in text to start the search (default beginning)</p></li>
<li><p><strong>end</strong> – Where to stop the search exclusive (default remaining text)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>offset into text, or -1 if not found or substring is zero length</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.text_width">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">text_width</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span><a class="reference internal" href="_modules/apsw/unicode.html#text_width"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.text_width" title="Link to this definition"></a></dt>
<dd><p>Returns how many columns the text would be if displayed in a terminal</p>
<p>You should <a class="reference internal" href="#apsw.unicode.split_lines" title="apsw.unicode.split_lines"><code class="xref py py-func docutils literal notranslate"><span class="pre">split_lines()</span></code></a> first and then operate on each line
separately.</p>
<p>If the <cite>text</cite> contains new lines, control characters, and similar
unrepresentable codepoints then minus 1 is returned.</p>
<p>Terminals aren’t entirely consistent with each other, and Unicode
has many kinds of codepoints, and combinations.  Consequently this
is right the vast majority of the time, but not always.</p>
<p>Note that web browsers do variable widths even in monospaced
sections like <code class="docutils literal notranslate"><span class="pre">&lt;pre&gt;</span></code> so they won’t always agree with the terminal
either.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.text_width_substr">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">text_width_substr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/unicode.html#text_width_substr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.text_width_substr" title="Link to this definition"></a></dt>
<dd><p>Extracts substring width or less wide being aware of grapheme cluster boundaries.
For example you could use this to get a substring that is 80 (or
less) wide.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple of how wide the substring is, and the substring</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.guess_paragraphs">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">guess_paragraphs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tabsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/apsw/unicode.html#guess_paragraphs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.guess_paragraphs" title="Link to this definition"></a></dt>
<dd><dl>
<dt>Given text that contains paragraphs containing newlines, guesses where the paragraphs end.</dt><dd><p>The returned <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> will have ``</p>
</dd>
<dt>`` removed where it was</dt><dd><p>determined to not mark a paragraph end.</p>
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">If you have text like this, where paragraphs have newlines in</span>
<span class="go">them, then each line gets wrapped separately by text_wrap.</span>
<span class="go">This function tries to guess where the paragraphs end.</span>

<span class="go">Blank lines like above are definite.</span>
<span class="go">  Indented lines that continue preserving the indent</span>
<span class="go">  are considered the same paragraph, and a change of indent</span>
<span class="go">  (in or out) is a new paragraph.</span>
<span class="go">    So this will be a new paragraph,</span>
<span class="go">And this will be a new paragraph.</span>

<span class="go"> * Punctuation/numbers at the start of line</span>
<span class="go">   followed by indented text are considered the same</span>
<span class="go">   paragraph</span>
<span class="go">2. So this is a new paragraph, while</span>
<span class="go">   this line is part of the line above</span>

<span class="go">3. Optional numbers followed by punctuation then space</span>
<span class="go">- are considered new paragraphs</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.text_wrap">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">text_wrap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">70</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">tabsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyphen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combine_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invalid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'?'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/unicode.html#text_wrap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.text_wrap" title="Link to this definition"></a></dt>
<dd><p>Similar to <a class="reference external" href="https://docs.python.org/3/library/textwrap.html#textwrap.wrap" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">textwrap.wrap()</span></code></a> but Unicode grapheme cluster and line break aware</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Newlines in the text are treated as end of paragraph.  If your text has paragraphs
with newlines in them, then call <a class="reference internal" href="#apsw.unicode.guess_paragraphs" title="apsw.unicode.guess_paragraphs"><code class="xref py py-func docutils literal notranslate"><span class="pre">guess_paragraphs()</span></code></a> first.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>text</strong> – string to process</p></li>
<li><p><strong>width</strong> – width of yielded lines, if rendered using a monospace font such as to a terminal</p></li>
<li><p><strong>tabsize</strong> – Tab stop spacing as tabs are expanded</p></li>
<li><p><strong>hyphen</strong> – Used to show a segment was broken because it was wider than <code class="docutils literal notranslate"><span class="pre">width</span></code></p></li>
<li><p><strong>combine_space</strong> – Leading space on each (indent) is always preserved.  Other spaces where
multiple occur are combined into one space.</p></li>
<li><p><strong>invalid</strong> – If invalid codepoints are encountered such as control characters and surrogates
then they are replaced with this.</p></li>
</ul>
</dd>
</dl>
<p>This yields one line of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> at a time, which will be
exactly <code class="docutils literal notranslate"><span class="pre">width</span></code> when output to a terminal.  It will be right
padded with spaces if necessary and not have a trailing newline.</p>
<p><a class="reference internal" href="ext.html#apsw.ext.format_query_table" title="apsw.ext.format_query_table"><code class="xref py py-func docutils literal notranslate"><span class="pre">apsw.ext.format_query_table()</span></code></a> uses this method to ensure
each column is the desired width.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.codepoint_name">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">codepoint_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">codepoint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/apsw/unicode.html#codepoint_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.codepoint_name" title="Link to this definition"></a></dt>
<dd><p>Name or <code class="docutils literal notranslate"><span class="pre">None</span></code> if it doesn’t have one</p>
<p>For example codepoint 65 is named <code class="docutils literal notranslate"><span class="pre">LATIN</span> <span class="pre">CAPITAL</span> <span class="pre">LETTER</span> <span class="pre">A</span></code>
while codepoint U+D1234 is not assigned and would return
<code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.version_added">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">version_added</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">codepoint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/apsw/unicode.html#version_added"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.version_added" title="Link to this definition"></a></dt>
<dd><p>Returns the unicode version the codepoint was added</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="apsw.unicode.version_dates">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">version_dates</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'1.0':</span> <span class="pre">(1991,</span> <span class="pre">10,</span> <span class="pre">1),</span> <span class="pre">'1.1':</span> <span class="pre">(1993,</span> <span class="pre">6,</span> <span class="pre">1),</span> <span class="pre">'10.0':</span> <span class="pre">(2017,</span> <span class="pre">6,</span> <span class="pre">20),</span> <span class="pre">'11.0':</span> <span class="pre">(2018,</span> <span class="pre">6,</span> <span class="pre">5),</span> <span class="pre">'12.0':</span> <span class="pre">(2019,</span> <span class="pre">3,</span> <span class="pre">5),</span> <span class="pre">'12.1':</span> <span class="pre">(2019,</span> <span class="pre">5,</span> <span class="pre">7),</span> <span class="pre">'13.0':</span> <span class="pre">(2020,</span> <span class="pre">3,</span> <span class="pre">10),</span> <span class="pre">'14.0':</span> <span class="pre">(2021,</span> <span class="pre">9,</span> <span class="pre">14),</span> <span class="pre">'15.0':</span> <span class="pre">(2022,</span> <span class="pre">9,</span> <span class="pre">13),</span> <span class="pre">'15.1':</span> <span class="pre">(2023,</span> <span class="pre">9,</span> <span class="pre">12),</span> <span class="pre">'16.0':</span> <span class="pre">(2024,</span> <span class="pre">9,</span> <span class="pre">10),</span> <span class="pre">'2.0':</span> <span class="pre">(1996,</span> <span class="pre">7,</span> <span class="pre">1),</span> <span class="pre">'2.1':</span> <span class="pre">(1998,</span> <span class="pre">5,</span> <span class="pre">1),</span> <span class="pre">'3.0':</span> <span class="pre">(1999,</span> <span class="pre">9,</span> <span class="pre">1),</span> <span class="pre">'3.1':</span> <span class="pre">(2001,</span> <span class="pre">3,</span> <span class="pre">1),</span> <span class="pre">'3.2':</span> <span class="pre">(2002,</span> <span class="pre">3,</span> <span class="pre">1),</span> <span class="pre">'4.0':</span> <span class="pre">(2003,</span> <span class="pre">4,</span> <span class="pre">1),</span> <span class="pre">'4.1':</span> <span class="pre">(2005,</span> <span class="pre">3,</span> <span class="pre">31),</span> <span class="pre">'5.0':</span> <span class="pre">(2006,</span> <span class="pre">7,</span> <span class="pre">14),</span> <span class="pre">'5.1':</span> <span class="pre">(2008,</span> <span class="pre">4,</span> <span class="pre">4),</span> <span class="pre">'5.2':</span> <span class="pre">(2009,</span> <span class="pre">10,</span> <span class="pre">1),</span> <span class="pre">'6.0':</span> <span class="pre">(2010,</span> <span class="pre">10,</span> <span class="pre">11),</span> <span class="pre">'6.1':</span> <span class="pre">(2012,</span> <span class="pre">1,</span> <span class="pre">31),</span> <span class="pre">'6.2':</span> <span class="pre">(2012,</span> <span class="pre">9,</span> <span class="pre">26),</span> <span class="pre">'6.3':</span> <span class="pre">(2013,</span> <span class="pre">9,</span> <span class="pre">30),</span> <span class="pre">'7.0':</span> <span class="pre">(2014,</span> <span class="pre">6,</span> <span class="pre">16),</span> <span class="pre">'8.0':</span> <span class="pre">(2015,</span> <span class="pre">6,</span> <span class="pre">17),</span> <span class="pre">'9.0':</span> <span class="pre">(2016,</span> <span class="pre">6,</span> <span class="pre">21)}</span></em><a class="headerlink" href="#apsw.unicode.version_dates" title="Link to this definition"></a></dt>
<dd><p>Release date (year, month, day) for each unicode version
intended for use with <a class="reference internal" href="#apsw.unicode.version_added" title="apsw.unicode.version_added"><code class="xref py py-meth docutils literal notranslate"><span class="pre">version_added()</span></code></a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.grapheme_next_break">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">grapheme_next_break</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span><a class="reference internal" href="_modules/apsw/unicode.html#grapheme_next_break"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.grapheme_next_break" title="Link to this definition"></a></dt>
<dd><p>Returns end of Grapheme cluster /  User Perceived Character</p>
<p>For example regional indicators are in pairs, and a base codepoint
can be combined with zero or more additional codepoints providing
diacritics, marks, and variations.  Break points are defined in
the <a class="reference external" href="https://www.unicode.org/reports/tr29/#Grapheme_Cluster_Boundary_Rules">TR29 spec</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>text</strong> – The text to examine</p></li>
<li><p><strong>offset</strong> – The first codepoint to examine</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Index of first codepoint not part of the grapheme cluster
starting at offset. You should extract <code class="docutils literal notranslate"><span class="pre">text[offset:span]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.grapheme_next">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">grapheme_next</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/unicode.html#grapheme_next"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.grapheme_next" title="Link to this definition"></a></dt>
<dd><p>Returns span of next grapheme cluster</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.grapheme_iter">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">grapheme_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/unicode.html#grapheme_iter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.grapheme_iter" title="Link to this definition"></a></dt>
<dd><p>Iterator providing text of each grapheme cluster</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.grapheme_iter_with_offsets">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">grapheme_iter_with_offsets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/unicode.html#grapheme_iter_with_offsets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.grapheme_iter_with_offsets" title="Link to this definition"></a></dt>
<dd><p>Iterator providing start, end, text of each grapheme cluster</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.grapheme_iter_with_offsets_filtered">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">grapheme_iter_with_offsets_filtered</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">categories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.13)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emoji</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regional_indicator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/unicode.html#grapheme_iter_with_offsets_filtered"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.grapheme_iter_with_offsets_filtered" title="Link to this definition"></a></dt>
<dd><p>Iterator providing start, end, text of each grapheme cluster, providing it includes codepoints from categories, emoji, or regional indicator</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.word_next_break">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">word_next_break</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span><a class="reference internal" href="_modules/apsw/unicode.html#word_next_break"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.word_next_break" title="Link to this definition"></a></dt>
<dd><p>Returns end of next word or non-word</p>
<p>Finds the next break point according to the <a class="reference external" href="https://www.unicode.org/reports/tr29/#Word_Boundary_Rules">TR29 spec</a>.
Note that the segment returned may be a word, or a non-word
(spaces, punctuation etc).  Use <a class="reference internal" href="#apsw.unicode.word_next" title="apsw.unicode.word_next"><code class="xref py py-func docutils literal notranslate"><span class="pre">word_next()</span></code></a> to get words.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>text</strong> – The text to examine</p></li>
<li><p><strong>offset</strong> – The first codepoint to examine</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Next break point</p>
</dd>
</dl>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="apsw.unicode.word_default_categories">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">word_default_categories</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'Ll',</span> <span class="pre">'Lm',</span> <span class="pre">'Lo',</span> <span class="pre">'Lt',</span> <span class="pre">'Lu',</span> <span class="pre">'Nd',</span> <span class="pre">'Nl',</span> <span class="pre">'No'}</span></em><a class="headerlink" href="#apsw.unicode.word_default_categories" title="Link to this definition"></a></dt>
<dd><p>Default categories for selecting word segments - letters and numbers</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.word_next">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">word_next</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">categories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.13)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">word_default_categories</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emoji</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regional_indicator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/unicode.html#word_next"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.word_next" title="Link to this definition"></a></dt>
<dd><p>Returns span of next word</p>
<p>A segment is considered a word if it contains at least one codepoint corresponding
to any of the <cite>categories</cite>, plus:</p>
<ul class="simple">
<li><p>emoji (Extended_Pictographic in Unicode specs)</p></li>
<li><p>regional indicator - two character sequence for flags like 🇧🇷🇨🇦</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.word_iter">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">word_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">categories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.13)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">word_default_categories</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emoji</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regional_indicator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/unicode.html#word_iter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.word_iter" title="Link to this definition"></a></dt>
<dd><p>Iterator providing text of each word</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.word_iter_with_offsets">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">word_iter_with_offsets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">categories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.13)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">word_default_categories</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emoji</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regional_indicator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/unicode.html#word_iter_with_offsets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.word_iter_with_offsets" title="Link to this definition"></a></dt>
<dd><p>Iterator providing start, end, text of each word</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.sentence_next_break">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">sentence_next_break</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span><a class="reference internal" href="_modules/apsw/unicode.html#sentence_next_break"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.sentence_next_break" title="Link to this definition"></a></dt>
<dd><p>Returns end of sentence location.</p>
<p>Finds the next break point according to the <a class="reference external" href="https://www.unicode.org/reports/tr29/#Sentence_Boundary_Rules">TR29 spec</a>.
Note that the segment returned includes leading and trailing white space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>text</strong> – The text to examine</p></li>
<li><p><strong>offset</strong> – The first codepoint to examine</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Next break point</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.sentence_next">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">sentence_next</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/unicode.html#sentence_next"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.sentence_next" title="Link to this definition"></a></dt>
<dd><p>Returns span of next sentence</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.sentence_iter">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">sentence_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/unicode.html#sentence_iter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.sentence_iter" title="Link to this definition"></a></dt>
<dd><p>Iterator providing text of each sentence</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.sentence_iter_with_offsets">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">sentence_iter_with_offsets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/unicode.html#sentence_iter_with_offsets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.sentence_iter_with_offsets" title="Link to this definition"></a></dt>
<dd><p>Iterator providing start, end, text of each sentence</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.line_break_next_break">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">line_break_next_break</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span><a class="reference internal" href="_modules/apsw/unicode.html#line_break_next_break"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.line_break_next_break" title="Link to this definition"></a></dt>
<dd><p>Returns next opportunity to break a line</p>
<p>Finds the next break point according to the <a class="reference external" href="https://www.unicode.org/reports/tr14/#LB1">TR14 spec</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>text</strong> – The text to examine</p></li>
<li><p><strong>offset</strong> – The first codepoint to examine</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Next break point</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.line_break_next">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">line_break_next</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/unicode.html#line_break_next"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.line_break_next" title="Link to this definition"></a></dt>
<dd><p>Returns span of next line</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.line_break_iter">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">line_break_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/unicode.html#line_break_iter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.line_break_iter" title="Link to this definition"></a></dt>
<dd><p>Iterator providing text of each line</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="apsw.unicode.line_break_iter_with_offsets">
<span class="sig-prename descclassname"><span class="pre">apsw.unicode.</span></span><span class="sig-name descname"><span class="pre">line_break_iter_with_offsets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/apsw/unicode.html#line_break_iter_with_offsets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apsw.unicode.line_break_iter_with_offsets" title="Link to this definition"></a></dt>
<dd><p>Iterator providing start, end, text of each line</p>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="example-fts.html" class="btn btn-neutral float-left" title="Full Text Search Example/Tour" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="example-session.html" class="btn btn-neutral float-right" title="Session Example/Tour" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; <a href="copyright.html">Copyright</a> 2004-2025, Roger Binns &lt;rogerb@rogerbinns.com&gt;.
      <span class="lastupdated">Last updated on Jun 06, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-2NR9GDCQLT"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-2NR9GDCQLT', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>